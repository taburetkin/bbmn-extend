{"version":3,"file":"index.js","sources":["mn/object.js","utils/is-known-ctor/ctors.js","utils/is-known-ctor/index.js","utils/better-result/index.js","utils/get-option/index.js","mixins/common/get-option/index.js","components/process-engine/process-context.js","utils/camel-case/index.js","components/process-engine/process-flag-key.js","components/process-engine/concurrency-check.js","mn/trigger-method-on.js","components/process-engine/invoke-on-context.js","components/process-engine/triggers.js","components/process-engine/run-promises.js","components/process-engine/process.js","components/process-engine/index.js","mixins/common/startable/index.js","mixins/common/childrenable/index.js","mixins/model/smart-get/get-nested-result.js","mixins/model/smart-get/get-property-schema.js","mixins/model/smart-get/get-display-config.js","bb/is-model.js","utils/get-by-path/get-property.js","utils/get-by-path/get-by-path-array.js","utils/get-by-path/index.js","mixins/model/smart-get/index.js","mixins/view/css-class-modifiers/index.js","mixins/view/nested-views/build-region.js","mixins/view/nested-views/normalize-region.js","bb/is-view.js","bb/is-view-class.js","mixins/view/nested-views/index.js","mixins/controls/control/trigger-control-event.js","mixins/controls/control/get-trigger-value.js","mixins/controls/control/index.js","mixins/controls/input/get-input-type.js","mixins/controls/input/set-attributes.js","mixins/controls/input/events/_get-option.js","mixins/controls/input/events/_is-char.js","mixins/controls/input/events/keydown.js","mixins/controls/input/events/keyup.js","mixins/controls/input/events/paste.js","mixins/controls/input/events/blur.js","mixins/controls/input/events/focus.js","mixins/controls/input/events/input.js","mixins/controls/input/events/index.js","mixins/controls/input/handle-event.js","mixins/controls/input/set-events.js","utils/convert-string/to-number.js","utils/to-bool/options.js","utils/to-bool/index.js","utils/convert-string/index.js","mixins/controls/input/index.js","utils/mix/options.js","utils/mix/create-mixin-from-object.js","utils/mix/normalize-arguments.js","utils/mix/with.js","utils/extend/index.js","utils/mix/index.js","utils/params-to-object/index.js","components/router/index.js","components/page/router.js","utils/compare-ab/get-model.js","utils/compare-ab/get-view.js","utils/compare-ab/index.js","utils/comparator/index.js","components/page/routes-mixin.js","components/page/index.js","utils/flat/traverse.js","utils/flat/index.js","utils/set-by-path/set-property.js","utils/set-by-path/ensure-arguments.js","utils/set-by-path/set-by-path-array.js","utils/set-by-path/normalize-options.js","utils/set-by-path/trigger-model-change-events.js","utils/set-by-path/index.js","utils/unflat/index.js"],"sourcesContent":["import Mn from 'backbone.marionette';\r\nconst MnObject = Mn.Object || Mn.MnObject;\r\nexport default MnObject;\r\n","import Model from '../../bb/model';\r\nimport Collection from '../../bb/collection';\r\nimport View from '../../bb/view';\r\nimport Router from '../../bb/router';\r\nimport MnObject from '../../mn/object';\r\nexport default [\r\n\tModel,\r\n\tCollection,\r\n\tView,\r\n\tRouter,\r\n\tMnObject\r\n];","import knownCtors from './ctors';\r\n\r\nfunction isKnownCtor(arg) {\r\n\tlet isFn = _.isFunction(arg);\r\n\tlet result = _(knownCtors).some((ctor) => arg === ctor || arg.prototype instanceof ctor);\r\n\treturn isFn && result;\r\n}\r\n\r\nexport default isKnownCtor;\r\n","import isKnownCtor from '../is-known-ctor';\r\nexport default function betterResult(obj, key, opts = {})\r\n{\r\n\tlet { context, args, checkAlso, force } = opts;\r\n\tlet defaultValue = opts.default;\r\n\r\n\tif(!_.isString(key) || key === '') return;\r\n\t\r\n\tlet value = (obj || {})[key];\r\n\r\n\tif (value != null && (!_.isFunction(value) || isKnownCtor(value)))\r\n\t\treturn value;\r\n\t\t\r\n\tlet result = force !== false && _.isFunction(value) ? value.apply(context || obj, args) : value;\r\n\r\n\tif (result == null && _.isObject(checkAlso)) {\r\n\t\tlet alsoOptions = _.omit(opts, 'checkAlso');\r\n\t\tresult = betterResult(checkAlso, key, alsoOptions);\r\n\t}\r\n\r\n\tif (result == null && defaultValue != null )\r\n\t\tresult = defaultValue;\r\n\r\n\treturn result;\r\n}\r\n","import result from '../better-result';\r\n\r\nexport default function getOption(context, key, opts) {\r\n\t// if (_.isFunction(context.getOption)) {\r\n\t// \treturn context.getOption(key, opts);\r\n\t// } else {\r\n\t// \topts.context = context;\r\n\t// \tlet fallback = _.isFunction(context.getProperty)\r\n\t// \t\t? context.getProperty\r\n\t// \t\t: key => context[key];\r\n\t// \treturn getProperty(context.options, key, opts, fallback);\r\n\t// }\r\n\r\n\tlet options = _.extend({}, opts, {\r\n\t\tcontext,\r\n\t});\r\n\tlet { deep } = options;\r\n\r\n\tlet value = result(context.options, key, options);\r\n\tif (value == null && deep !== false) {\r\n\t\tvalue = result(context, key, options);\r\n\t}\r\n\treturn value;\r\n\r\n\r\n}\r\n","import result from '../../../utils/better-result';\r\nimport getOption from '../../../utils/get-option';\r\n\r\nconst Mixin = (Base) => Base.extend({\r\n\r\n\t//property first approach\r\n\tgetProperty(key, opts){\r\n\t\t\r\n\t\tlet defaultGetArguments = result(this, '_getPropertyArguments', { args:[this], default:[this] });\r\n\t\tlet options = _.extend({\r\n\t\t\tdeep: Mixin.defaults.deep,\r\n\t\t\tforce: Mixin.defaults.force,\r\n\t\t\targs: defaultGetArguments\r\n\t\t}, opts, {\r\n\t\t\tcontext: this,\r\n\t\t});\r\n\t\tlet { deep } = options;\r\n\r\n\t\tlet value = result(this, key, options);\r\n\t\tif (value == null && deep !== false) {\r\n\t\t\tvalue = result(this.options, key, options);\r\n\t\t}\r\n\t\treturn value;\r\n\t},\r\n\r\n\t//options first approach\r\n\tgetOption(key, opts){\r\n\t\tlet defaultGetArguments = result(this, '_getOptionArguments', { args:[this], default:[this] });\r\n\t\tlet options = _.extend({\r\n\t\t\tdeep: Mixin.defaults.deep,\r\n\t\t\tforce: Mixin.defaults.force,\r\n\t\t\targs: defaultGetArguments\r\n\t\t}, opts);\r\n\r\n\t\treturn getOption(this, key, options);\r\n\t},\r\n\r\n\tmergeOptions(values = {}, keys = [], opts = {}){\r\n\t\t\r\n\t\tif(_.isString(keys))\r\n\t\t\tkeys = keys.split(/\\s*,\\s*/);\r\n\r\n\t\t_.each(keys, (key) => {\r\n\t\t\tconst option = result(values, key, opts);\r\n\t\t\tif (option !== undefined) {\r\n\t\t\t\tthis[key] = option;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n}, {\r\n\tGetOptionMixin:true\r\n});\r\n\r\nMixin.defaults = {\r\n\tdeep: true,\r\n\tforce: true\r\n};\r\n\r\nexport default Mixin;\r\n","\r\n\r\nexport default function createProcessContext(context, name, args = [], opts = {}){\r\n\r\n\tlet cancelation = {};\r\n\tcancelation.promise = new Promise((resolve, reject) => {\r\n\t\tcancelation.cancel = () => reject('cancel'); \r\n\t});\r\n\r\n\r\n\tlet result = _.extend({\r\n\t\tcid: _.uniqueId('process'),\r\n\t\tname,\r\n\t\tcontext,\r\n\t\targs,\r\n\t\terrors:[],\r\n\t\twaitPromises:[],\r\n\t\tcancelation,\t\t\r\n\t}, opts);\r\n\r\n\treturn result;\r\n}\r\n","// camelCase('asd:qwe:zxc') -> asdQweZxc\r\n// camelCase('asd:qwe:zxc', true) -> AsdQweZxc\r\nexport default function camelCase(text, first) {\r\n\tif (!_.isString(text)) return text;\r\n\tvar splitter = first === true ? /(^|:)(\\w)/gi : /(:)(\\w)/gi;\r\n\treturn text.replace(splitter, (match, prefix, text) => text.toUpperCase());\r\n}","import camelCase from '../../utils/camel-case';\r\n\r\nexport default function executingProcessFlagKey(name){\r\n\treturn camelCase(`_process:${name}:executing`);\r\n}\r\n","import executingProcessFlagKey from './process-flag-key';\r\n\r\nexport default function processConcurrencyCheck(processContext){\r\n\r\n\tlet executingKey = executingProcessFlagKey(processContext.name);\r\n\tlet previous = processContext.context[executingKey];\r\n\tif(!previous) return;\r\n\r\n\tlet concurrent = processContext.concurrent;\t\r\n\t\r\n\tif (concurrent === false) {\r\n\r\n\t\tprocessContext.cancel();\r\n\r\n\t} else if (concurrent == 'first') {\r\n\r\n\t\treturn previous.promise;\r\n\r\n\t} else if (concurrent == 'last') {\r\n\r\n\t\tprevious.cancelation.cancel();\r\n\r\n\t}\t\t\r\n}\r\n","import Mn from 'backbone.marionette';\r\nexport default Mn.triggerMethodOn;","import camelCase from '../../utils/camel-case';\r\nimport result from '../../utils/better-result';\r\nimport triggerMethodOn from '../../mn/trigger-method-on';\r\n\r\nexport function invokeOnContext(processContext, methodName)\r\n{\r\n\tlet method = camelCase(methodName);\r\n\tlet context = processContext.context;\r\n\tlet args = processContext.args;\r\n\treturn result(context, method, { args });\r\n}\r\n\r\nexport function triggerOnContext (processContext, eventName, ...args) {\r\n\t\r\n\tlet context = processContext.context; \r\n\tif(!_.isFunction(context.trigger))\r\n\t\treturn;\r\n\t\r\n\tlet event = processContext.name + (eventName ? ':' + eventName : '');\r\n\t\r\n\t(!args || !args.length) && (args = processContext.args || []);\r\n\r\n\ttriggerMethodOn(context, event, ...args);\r\n\r\n}\r\n","import executingProcessFlagKey from './process-flag-key';\r\nimport { triggerOnContext } from './invoke-on-context';\r\n\r\nexport function triggerBegin(processContext) { \r\n\r\n\r\n\tlet beginError = _.isFunction(processContext.onBegin) && processContext.onBegin.call(processContext.context, ...processContext.args);\r\n\tif (beginError)\r\n\t\treturn beginError;\r\n\r\n\tlet key = executingProcessFlagKey(processContext.name);\r\n\tprocessContext.context[key] = processContext;\r\n\ttriggerOnContext(processContext, 'begin');\r\n\r\n}\r\nexport function triggerBefore(processContext) { \r\n\r\n\ttriggerOnContext(processContext, 'before');\r\n\r\n}\r\nexport function triggerComplete(processContext) { \r\n\r\n\ttriggerOnContext(processContext);\r\n\tif (_.isFunction(processContext.onComplete))\r\n\t\tprocessContext.onComplete.call(processContext.context, ...processContext.args);\r\n\ttriggerOnContext(processContext, 'end');\r\n\r\n}\r\nexport function triggerError(context, errors){ \r\n\r\n\tif(!_.isArray(errors))\r\n\t\terrors = [errors];\r\n\r\n\tcontext.errors.push(...errors);\r\n\r\n\ttriggerOnContext(context, 'error', ...context.errors);\r\n\tif (_.isFunction(context.onError))\r\n\t\tcontext.onError.call(context.context, ...context.errors);\r\n\r\n\ttriggerOnContext(context, 'end');\r\n\t\r\n}\r\n","import { invokeOnContext } from './invoke-on-context';\r\n\r\n\r\nfunction isPromisable(arg){\r\n\treturn arg instanceof Promise || _.isFunction(arg && arg.then);\r\n}\r\n\r\nfunction asArray(arg) {\r\n\tif(_.isArray(arg))\r\n\t\treturn arg;\r\n\telse if(arg == null || arg === '')\r\n\t\treturn [];\r\n\telse\r\n\t\treturn [arg];\r\n}\r\n\r\n\r\n\r\n\r\nexport function getCanNotRunPromise(processContext){\r\n\r\n\tlet contextMethod = 'can:not:' + processContext.name;\r\n\tlet promise = invokeOnContext(processContext, contextMethod);\r\n\r\n\tif(promise == null || promise === '') {\r\n\r\n\t\tpromise = Promise.resolve();\r\n\t}\r\n\telse if(!isPromisable(promise)) {\r\n\r\n\t\tpromise = Promise.reject(promise);\r\n\t}\r\n\r\n\treturn Promise.race([\r\n\t\tprocessContext.cancelation.promise, \r\n\t\tpromise\r\n\t]);\r\n\r\n}\r\n\r\n\r\nexport function getWaitPromise(processContext) {\r\n\r\n\tlet contextMethod = 'get:' + processContext.name + ':promises';\r\n\tlet promises = asArray(invokeOnContext(processContext, contextMethod));\r\n\r\n\treturn Promise.race([\r\n\t\tprocessContext.cancelation.promise, \r\n\t\tPromise.all(promises)\r\n\t]);\r\n\r\n}\r\n","import { triggerBegin, triggerBefore, triggerComplete, triggerError } from './triggers';\r\nimport { getCanNotRunPromise, getWaitPromise } from './run-promises';\r\n\r\n\r\nexport default function process(processContext){\r\n\t\r\n\tlet promise = new Promise((resolve, reject) => {\r\n\t\tlet shouldExit = false;\r\n\t\tlet rejectWithError = (error) => {\t\t\t\r\n\t\t\ttriggerError(processContext, error);\r\n\t\t\treject(processContext);\r\n\t\t\tshouldExit = true;\r\n\t\t};\r\n\r\n\t\tPromise.race([\r\n\t\t\tprocessContext.cancelation.promise, \r\n\t\t\tPromise.resolve()\r\n\t\t]).catch(rejectWithError);\r\n\r\n\t\tif(shouldExit) return;\r\n\r\n\t\tlet beginError = triggerBegin(processContext);\r\n\t\tif (beginError) {\r\n\t\t\trejectWithError(beginError);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet canBeRuned = getCanNotRunPromise(processContext);\r\n\t\tcanBeRuned.then(\r\n\t\t\t() => {\r\n\t\t\t\ttriggerBefore(processContext);\r\n\t\t\t\tlet waitFor = getWaitPromise(processContext);\r\n\t\t\t\treturn waitFor.then(\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\ttriggerComplete(processContext);\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t).catch(rejectWithError);\r\n\r\n\t});\r\n\tprocessContext.promise = promise;\r\n\treturn promise;\r\n}\r\n","//import engine from './engine';\r\nimport createProcessContext from './process-context';\r\nimport concurrencyCheck from './concurrency-check';\r\nimport process from './process';\r\n\r\nexport default function initializeProcess(context, name, opts){\r\n\r\n\tcontext[name] = function(...args){\r\n\t\t\r\n\t\tlet processContext = createProcessContext(context, name, args, opts);\r\n\t\t\t\r\n\t\tlet concurrent = concurrencyCheck(processContext);\r\n\t\tif (concurrent) {\r\n\t\t\treturn concurrent;\r\n\t\t} else {\r\n\t\t\treturn process(processContext);\r\n\t\t}\r\n\r\n\t};\r\n\r\n}\r\n","import initProcess from '../../../components/process-engine';\r\nexport default Base => Base.extend({\r\n\tconstructor(){\r\n\t\tBase.apply(this, arguments);\r\n\t\tinitProcess(this, 'start');\r\n\t\tinitProcess(this, 'stop');\r\n\t}\r\n});\r\n","import isKnownCtor from '../../../utils/is-known-ctor';\r\n\r\nexport default Base => Base.extend({\r\n\r\n\tconstructor(opts){\r\n\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis._initializeChildrenable(opts);\r\n\r\n\t},\r\n\t_initializeChildrenable(opts){\r\n\t\tthis.mergeOptions(opts, ['parent', 'root']);\r\n\t\tif(this.parent == null && this.root == null)\r\n\t\t\tthis.root = this;\r\n\t},\r\n\r\n\t//call this method manualy for initialize children\r\n\tinitializeChildren(){\r\n\t\tif (this._childrenInitialized) return;\r\n\r\n\t\tlet children = this.getOption('children');\r\n\t\tthis._children = [];\r\n\t\t_(children).each(child => this._initializeChild(child));\r\n\r\n\t\tthis._childrenInitialized = true;\r\n\r\n\t},\r\n\t_initializeChild(arg){\r\n\t\tlet Child;\r\n\t\tlet options = {};\r\n\r\n\t\tif (isKnownCtor(arg))\r\n\t\t\tChild = arg;\r\n\t\telse if(_.isFunction(arg)){\r\n\t\t\t\r\n\t\t\tlet invoked = arg.call(this, this);\r\n\t\t\treturn this._initializeChild(invoked);\r\n\r\n\t\t} else if (_.isObject(arg)) {\r\n\t\t\tChild = arg.Child;\r\n\t\t\t_.extend(options, _.omit(arg, 'Child'));\r\n\t\t}\r\n\r\n\t\tif (!isKnownCtor(arg)) return;\r\n\r\n\t\t_.extend(options, this.getOption('childOptions'), { parent: this });\r\n\t\toptions = this.buildChildOptions(options);\r\n\t\t\r\n\t\tlet child = new Child(options);\r\n\t\tthis._children.push(child);\r\n\r\n\t},\r\n\r\n\tbuildChildOptions(options){\r\n\t\treturn options;\r\n\t},\r\n\r\n\tgetChildren(){\r\n\t\treturn this._children || [];\r\n\t},\r\n\tgetParent(){\r\n\t\treturn this.parent;\r\n\t}\r\n\r\n\r\n\r\n});\r\n","export default function getNestedResult(value, context, schema) {\r\n\treturn value != null \r\n\t\t&& _.isFunction(schema.nested) \r\n\t\t&& schema.nested(value, context);\r\n}","export default function getPropertySchema(model, key)\r\n{\r\n\tif (_.isFunction(model.getPropertySchema)) {\r\n\t\treturn model.getPropertySchema(key);\r\n\t} else {\r\n\t\treturn {};\r\n\t}\r\n}","export default function getDisplayConfig(key, model, schema){\r\n\tif (key == null) return {};\r\n\treturn (_.isFunction(model.getPropertyDisplayConfig) && model.getPropertyDisplayConfig(key))\r\n\t\t|| schema.display || {}\r\n}","import Model from './model';\r\nexport default function isModel(arg){\r\n\treturn arg instanceof Model;\r\n}","import isModel from '../../bb/is-model';\r\nfunction getProperty(context, name)\r\n{\r\n\tif(context == null || !_.isObject(context) || name == null || name == '') return;\r\n\tif (isModel(context))\r\n\t\treturn context.get(name, { gettingByPath: true  });\r\n\telse\r\n\t\treturn context[name];\r\n}\r\nexport default getProperty;\t\r\n","\r\nimport getProperty from './get-property';\r\n\r\nfunction getByPathArray(context, propertyName, pathArray) {\r\n\t\r\n\tif (context == null || !_.isObject(context) || propertyName == null || propertyName == '')\r\n\t\treturn;\r\n\r\n\tvar prop = getProperty(context, propertyName);\r\n\r\n\tif (!pathArray.length || (pathArray.length && prop == null))\r\n\t\treturn prop;\r\n\r\n\tvar nextName = pathArray.shift();\r\n\r\n\treturn getByPathArray(prop, nextName, pathArray);\r\n\r\n}\r\n\r\nexport default getByPathArray;\r\n","import getByPathArray from './get-by-path-array';\r\n\r\nexport default function getByPath(obj, path) {\r\n\r\n\tif (obj == null || !_.isObject(obj) || path == null || path == '') return;\r\n\r\n\tvar pathArray = _.isString(path) ? path.split('.')\r\n\t\t: _.isArray(path) ? [].slice.call(path)\r\n\t\t\t: [path];\r\n\r\n\tvar prop = pathArray.shift();\r\n\r\n\treturn getByPathArray(obj, prop, pathArray);\r\n\r\n}\r\n","import Model from '../../../bb/model';\r\nimport getNestedResult from './get-nested-result';\r\nimport getPropertySchema from './get-property-schema';\r\nimport getDisplayConfig from './get-display-config';\r\nimport getByPath from '../../../utils/get-by-path';\r\nexport default Base => {\r\n\tconst originalGet = Model.prototype.get;\r\n\tconst Mixed = Base.extend({\r\n\t\tgetByPath(key){\r\n\t\t\tif(key.indexOf('.') > -1)\r\n\t\t\t\treturn getByPath(this, key);\r\n\t\t\telse\r\n\t\t\t\treturn originalGet.call(this, key);\r\n\t\t},\r\n\t\tget(key, opts = {}){\r\n\t\t\tif(key == null || key == '') return;\t\r\n\t\t\t\r\n\t\t\tlet value = 'value' in opts \r\n\t\t\t\t? opts.value\r\n\t\t\t\t: this.getByPath.call(this, key);\r\n\r\n\t\t\tif (!_.size(opts)) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\r\n\t\t\tlet prop = getPropertySchema(this, key);\r\n\t\t\tlet result = opts.nested && getNestedResult(value, this, prop);\r\n\t\t\tif (result != null) {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\r\n\t\t\tif(_.isFunction(opts.transform) && !opts.raw) {\r\n\t\t\t\tvalue = opts.transform.call(this, value, opts, this);\r\n\t\t\t}\r\n\r\n\t\t\tif(_.isFunction(prop.transform) && !opts.raw){\r\n\t\t\t\tvalue = prop.transform.call(this, value, opts, this);\r\n\t\t\t}\r\n\r\n\t\t\tif(opts.display === true){\r\n\r\n\t\t\t\tlet display = getDisplayConfig(key, this, prop);\r\n\r\n\t\t\t\tif(opts.alternative){\r\n\t\t\t\t\tvalue = _.isFunction(display.alternative) && display.alternative.call(this, value, _.extend({},opts,prop), this);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_.isFunction(display.transform)) {\r\n\t\t\t\t\tvalue = display.transform.call(this, value, opts, this);\r\n\t\t\t\t}\r\n\t\t\t\tif(display.ifEmpty && (value == null || value === ''))\r\n\t\t\t\t\treturn display.ifEmpty;\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tdisplay(key, opts = {}){\r\n\t\t\t_.extend(opts, { display:true });\r\n\t\t\treturn this.get(key, opts);\r\n\t\t},\r\n\t});\r\n\r\n\treturn Mixed;\r\n};\r\n","\r\nconst defaultCssConfig = {\r\n\tbeforeRender: true,\r\n\tmodelChange: true,\r\n\trefresh: true,\r\n};\r\n\r\nexport default (Base) => Base.extend({\r\n\tconstructor(){\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis._setupCssClassModifiers();\t\t\r\n\t},\r\n\r\n\trefreshCssClass(){\r\n\t\tlet className = this._getCssClassString();\r\n\t\tif(className == ''){\r\n\t\t\tthis.$el.removeAttr('class');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.$el.attr({\r\n\t\t\t\tclass: className\r\n\t\t\t});\r\n\t\t}\r\n\t},\t\r\n\r\n\t_getCssClassModifiers(){\r\n\t\tlet optsModifiers = this.getOption('cssClassModifiers',{deep:false, args:[this.model, this]});\r\n\t\tlet propsModifiers = this.getProperty('cssClassModifiers',{deep:false, args:[this.model, this]});\r\n\t\tlet modifiers = [this.getOption('className')].concat(optsModifiers || [], propsModifiers || []);\r\n\t\treturn modifiers;\r\n\t},\r\n\t//override this if you need other logic\r\n\tgetCssClassModifiers(){\r\n\t\treturn this._getCssClassModifiers();\r\n\t},\r\n\t_getCssClassString()\r\n\t{\r\n\t\tlet modifiers = this.getCssClassModifiers();\r\n\t\tlet classes = _(modifiers).map((cls) => {\r\n\t\t\treturn _.isString(cls) \r\n\t\t\t\t? cls \r\n\t\t\t\t: _.isFunction(cls) \r\n\t\t\t\t\t? cls.call(this, this.model, this) \r\n\t\t\t\t\t: null;\r\n\t\t});\r\n\t\tlet ready = _(classes).filter((f) => f != null && f != '');\r\n\t\tlet className = _.uniq(ready).join(' ');\r\n\t\treturn (className || '').trim();\r\n\t},\r\n\r\n\t_setupCssClassModifiers(){\r\n\r\n\t\tif(this._cssClassModifiersInitialized) return;\r\n\r\n\t\tlet cfg = this.getCssClassConfig();\r\n\t\tif(!cfg) return;\r\n\r\n\t\tlet events = this.getCssClassEvents(cfg);\r\n\t\t_(events).each((eventName) => this.on(eventName, this.refreshCssClass));\r\n\r\n\t\tif (cfg.modelChange && this.model) {\r\n\t\t\tthis.listenTo(this.model, 'change', this.refreshCssClass);\r\n\t\t}\r\n\r\n\t\tthis._cssClassModifiersInitialized = true;\r\n\t},\r\n\t\r\n\t_getCssClassConfig(){\r\n\t\tlet cfg = _.extend({}, defaultCssConfig, this.getOption('cssClassConfig'));\r\n\t\tif(!cfg || _.size(cfg) == 0) return;\r\n\t\treturn cfg;\r\n\t},\r\n\t//override this if you need other logic\r\n\tgetCssClassConfig(){\r\n\t\treturn this._getCssClassConfig();\r\n\t},\r\n\r\n\t_getCssClassEvents(cfg){\r\n\t\tlet events = [].concat(cfg.events || []);\r\n\t\tif(cfg.refresh) events.push('refresh');\r\n\t\tif(cfg.beforeRender) events.push('before:render');\r\n\t\tevents = _(events).uniq();\r\n\t\treturn events;\r\n\t},\r\n\t//override this if you need other logic\r\n\tgetCssClassEvents(cfg){\r\n\t\treturn this._getCssClassEvents(cfg);\r\n\t}\r\n});\r\n","\r\nconst defaultSelector = (name, prefix = '') => prefix + 'region-' + name;\r\n\r\nfunction defaultUpdateDom(name, $el)\r\n{\r\n\tlet selector = defaultSelector(name);\r\n\tlet element = $('<div>').addClass(selector);\r\n\t$el.append(element);\r\n\r\n\treturn '.' + selector;\r\n}\r\n\r\nexport default function buildRegionFunc(view, hash, context){\r\n\r\n\tlet { $el } = view;\t\r\n\tlet { autoCreateRegion } = context;\r\n\tlet { updateDom, name, el } = hash;\r\n\tlet regionEl;\r\n\t\r\n\tlet region = view.getRegion(name);\r\n\r\n\r\n\tif (el == null && autoCreateRegion !== false) {\r\n\r\n\t\tlet testEl = region && region.getOption('el',{ deep:false});\r\n\r\n\t\tif (!region || !testEl || !$el.find(testEl).length) {\r\n\r\n\t\t\tregionEl = defaultUpdateDom(name, $el);\r\n\r\n\t\t} \r\n\r\n\t} else if(_.isFunction(updateDom)) {\r\n\t\tupdateDom.call(view, $el, view);\r\n\r\n\t} \r\n\t\r\n\t\r\n\tif (!region) {\r\n\t\tlet definition = _.pick(hash, 'replaceElement', 'regionClass');\r\n\t\tdefinition.el = hash.el || regionEl;\r\n\t\tregion = view.addRegion(name, definition);\r\n\t}\r\n\r\n\r\n\treturn region;\r\n}\r\n","import buildRegion from './build-region';\r\n\r\nexport default function normalizeNestedViewContextRegion(context) {\r\n\r\n\tlet { region } = context;\r\n\tlet regionName = (_.isString(region) && region) || context.regionName || context.name;\r\n\r\n\tif (_.isString(region) || region == null) {\r\n\t\tregion = {};\r\n\t} else if (_.isFunction(region)) {\r\n\t\tregion = region.call(this, context, this);\r\n\t}\r\n\r\n\tif (_.isObject(region)) {\r\n\r\n\t\tif(!region.name)\r\n\t\t\tregion.name = regionName;\r\n\t\tlet replaceElement = this.getOption('replaceNestedElement');\r\n\t\tcontext.region = _.extend({ replaceElement }, region);\r\n\t\tcontext.show = _.partial(buildRegion, this, context.region, context);\r\n\t}\r\n\treturn context;\r\n}\r\n","import View from './view';\r\nexport default function isView(arg){\r\n\treturn arg instanceof View;\r\n}","import View from './view';\r\nimport isView from './is-view';\r\nexport default function isViewClass(arg) {\r\n\treturn _.isFunction(arg) && (arg == View || isView(arg.prototype));\r\n}\r\n","import result from '../../../utils/better-result';\r\nimport normalizeRegion from './normalize-region';\r\nimport isViewClass from '../../../bb/is-view-class';\r\nexport default Base => Base.extend({\r\n\tconstructor(){\r\n\t\tthis._nestedViews = {};\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis.initializeNestedViews();\r\n\t},\r\n\ttemplate: false,\r\n\r\n\tshowAllNestedViewsOnRender: false,\r\n\tshowNestedViewOnAdd: false,\r\n\treplaceNestedElement: true,\r\n\r\n\tinitializeNestedViews(){\r\n\t\tif (this._nestedViewsInitialized) return;\r\n\r\n\t\tif(this.getOption('showAllNestedViewsOnRender')) {\r\n\t\t\tthis.on('render', () => this.showAllNestedViews());\r\n\t\t}\r\n\r\n\t\tlet nesteds = this.getOption('nestedViews', { args:[this.model, this]});\r\n\t\t_(nesteds).each((context, index) => {\r\n\r\n\t\t\tlet name = _.isString(index) ? index : (context.name || _.uniqueId('nested'));\r\n\t\t\tthis.addNestedView(name, context);\r\n\r\n\t\t});\r\n\r\n\t\tthis._nestedViewsInitialized = true;\r\n\t},\r\n\t_normalizeNestedContext(name, context){\r\n\r\n\t\tif (isViewClass(context)) {\r\n\t\t\tlet View = context;\r\n\t\t\tcontext = {\r\n\t\t\t\tname, View\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t//unwrap to plain object\r\n\t\tif (_.isFunction(context)) {\r\n\t\t\tcontext = context.call(this, this.model, this);\r\n\t\t}\r\n\r\n\t\t//fix name if its not provided\r\n\t\tif (context.name == null) {\r\n\t\t\tcontext.name = name || _.uniqueId('nested');\r\n\t\t}\r\n\r\n\t\t//convert region to valid function\r\n\t\tcontext = normalizeRegion.call(this, context);\t\t\r\n\r\n\r\n\t\treturn context;\r\n\t},\r\n\t_createNestedContext(context){\r\n\t\tlet contexts = this.getNestedViewContext();\r\n\t\tcontexts[context.name] = context;\r\n\t},\r\n\r\n\taddNestedView(name, context){\r\n\r\n\t\tif (!_.isString(name) || name === '') {\r\n\t\t\tthrow new Error('addNestedView: first argument should be a string');\r\n\t\t}\r\n\r\n\t\tcontext = this._normalizeNestedContext(name, context);\r\n\t\tthis._createNestedContext(context);\r\n\t\tif(this.getOption('showNestedViewOnAdd') && this.isRendered()){\r\n\t\t\tthis.showNestedView(context);\r\n\t\t}\t\t\r\n\t},\r\n\r\n\tshowNestedView(name){\r\n\t\tlet region = this.getNestedViewRegion(name);\r\n\t\tlet view = region && this.buildNestedView(name);\r\n\t\tif (view) {\r\n\t\t\tregion.show(view);\r\n\t\t}\r\n\t},\r\n\tshowAllNestedViews(){\r\n\t\tlet contexts = this.getNestedViewContext();\r\n\t\t_(contexts).each(context => this.showNestedView(context));\r\n\t},\r\n\tgetNestedViewContext(name){\r\n\t\tlet contexts = this._nestedViews;\r\n\t\tif (arguments.length == 0)\r\n\t\t\treturn contexts;\r\n\t\telse\r\n\t\t\treturn contexts[name];\r\n\t},\r\n\r\n\r\n\tbuildNestedView(name){\r\n\r\n\t\tlet context = _.isObject(name) ? name\r\n\t\t\t: _.isString(name) ? this.getNestedViewContext(name)\r\n\t\t\t\t: null;\r\n\r\n\t\tif(!context) return;\r\n\r\n\t\tif(_.isFunction(context.template))\r\n\t\t\treturn context.template;\r\n\t\telse {\r\n\t\t\tlet View = context.View;\r\n\t\t\tlet options = this.buildNestedViewOptions(result(context, 'options', { context: this, args: [this, this.model], default:{} }));\r\n\t\t\t\r\n\t\t\treturn new View(options);\r\n\t\t}\r\n\t},\r\n\tbuildNestedViewOptions(opts){\r\n\t\treturn opts;\r\n\t},\r\n\tgetNestedViewRegion(name){\r\n\t\tlet context = _.isObject(name) ? name\r\n\t\t\t: _.isString(name) ? this.getNestedViewContext(name)\r\n\t\t\t\t: null;\r\n\t\treturn context && _.result(context, 'show');\r\n\t}\r\n\t\r\n});\r\n","export default function triggerControlEvent(control, event, ...args){\r\n\r\n\t//let control = _control.getParentControl() || _control;\r\n\r\n\tlet name = control.getControlName();\r\n\tlet eventName = name + ':' + event;\r\n\tlet method = _.isFunction(control.triggerMethod) ? control.triggerMethod\r\n\t\t: _.isFunction(control.trigger) ? control.trigger\r\n\t\t\t: function(){};\r\n\tmethod.call(control, eventName, ...args);\r\n\t\r\n\r\n\tcontrol.proxyControlEventToParent(eventName, ...args);\r\n\r\n}\r\n","export default function getTriggerValue(control, args = []){\r\n\r\n\tlet value = args.length ? args[0] : control.getControlValue();\r\n\r\n\tif(_.isFunction(control.convertValue))\r\n\t\tvalue = control.convertValue(value);\r\n\t\t\r\n\treturn value;\r\n}\r\n","import triggerControlEvent from './trigger-control-event';\r\nimport getTriggerValue from './get-trigger-value';\r\nimport getOption from '../../../utils/get-option';\r\nimport camelCase from '../../../utils/camel-case';\r\n\r\nexport default Base => Base.extend({\t\r\n\r\n\tgetControlValue(){\r\n\t\treturn this.value;\r\n\t},\r\n\tsetControlValue(value){\r\n\t\tthis.value = value;\r\n\t},\r\n\r\n\tgetControlName(){\r\n\t\treturn getOption(this, 'controlName', { args:[this]}) || 'control';\r\n\t},\r\n\r\n\tgetParentControl(){\r\n\t\treturn getOption(this, 'proxyTo', { args:[this]});\r\n\t},\r\n\ttriggerChildControlEvent(eventName, ...args){\r\n\t\tlet events = getOption(this, 'childControlEvents', { args:[this]}) || {};\r\n\t\tif (_.isFunction(events[eventName])) {\r\n\t\t\tevents[eventName].apply(this, args);\r\n\t\t}\r\n\t},\r\n\r\n\ttryValidateControl(value){\r\n\t\tlet validate = getOption(this, 'validateControl', { force: false });\r\n\t\tif(_.isFunction(validate))\r\n\t\t\treturn validate.call(this, value, this);\r\n\t},\r\n\r\n\ttriggerControlChange(){\r\n\t\tthis._triggerControlEvent('change', arguments);\r\n\t},\r\n\ttriggerControlDone(){\r\n\t\tthis._triggerControlEvent('done', arguments);\r\n\t},\r\n\t_isValueAsPrevious(value, type){\r\n\t\tlet previousTriggerName = this.getPreviousTriggerValueKey(type);\r\n\t\tif (previousTriggerName in this) {\r\n\t\t\treturn JSON.stringify(this[previousTriggerName]) === JSON.stringify(value);\r\n\t\t}\r\n\t},\r\n\tisValueAsPrevious(value, type)\r\n\t{\r\n\t\treturn this._isValueAsPrevious(value, type);\r\n\t},\r\n\tsetPreviousTriggerValue(value, type){\r\n\t\tlet key = this.getPreviousTriggerValueKey(type);\r\n\t\tthis[key] = value;\r\n\t},\r\n\tgetPreviousTriggerValueKey(type){\r\n\t\treturn camelCase('_previous:' + type);\r\n\t},\r\n\t_triggerControlEvent(eventName, args) {\r\n\r\n\t\tlet triggerValue = getTriggerValue(this, args);\r\n\t\tif (this.isValueAsPrevious(triggerValue, eventName)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet errors = this.tryValidateControl(triggerValue);\r\n\t\tif (!errors) {\r\n\t\t\tthis.setPreviousTriggerValue(triggerValue, eventName);\t\t\t\r\n\t\t\ttriggerControlEvent(this, eventName, triggerValue);\r\n\t\t} else {\r\n\t\t\tthis.triggerControlInvalid(errors);\r\n\t\t}\r\n\t},\r\n\ttriggerControlInvalid(errors){\r\n\t\ttriggerControlEvent(this, 'invalid', errors);\r\n\t},\r\n\tproxyControlEventToParent(eventName, ...args){\r\n\t\tlet parent = this.getParentControl();\r\n\t\tif (parent && _.isFunction(parent.triggerChildControlEvent)) {\r\n\t\t\tparent.triggerChildControlEvent(eventName, ...args);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\r\n}, {\r\n\tControlMixin: true\r\n});\r\n","import getOption from '../../../utils/get-option';\r\nconst _getOption = (context, key, checkAlso) => getOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function getInputType(inputView, opts = {}){\r\n\t\r\n\tlet valueType = _getOption(inputView, 'valueType', opts);\r\n\tif (valueType == null) {\r\n\t\tlet value = inputView.getControlValue();\r\n\t\tif ( value == null) {\r\n\t\t\tvalueType = 'string';\r\n\t\t} else {\r\n\t\t\tif(_.isNumber(value))\r\n\t\t\t\tvalueType = 'number';\r\n\t\t\telse if(_.isDate(value))\r\n\t\t\t\tvalueType = 'datetime';\r\n\t\t\telse\r\n\t\t\t\tvalueType = 'string';\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tif (valueType == 'number') {\r\n\t\tinputView._valueIsNumber = true;\r\n\t}\r\n\r\n\tlet type = _getOption(inputView, 'inputType', opts);\r\n\r\n\tif (!type) {\r\n\t\tif (inputView._valueIsNumber) {\r\n\t\t\ttype = _getOption(inputView, 'inputNumberType', opts) || 'number';\r\n\t\t} else if (valueType == 'string') {\r\n\t\t\ttype = 'text';\r\n\t\t} else if (valueType == 'datetime') {\r\n\t\t\ttype = 'datetime';\r\n\t\t} else {\r\n\t\t\ttype = 'text';\r\n\t\t}\r\n\t}\r\n\tinputView.inputType = type;\r\n\tinputView.valueType = valueType;\r\n\treturn type;\r\n}\r\n","import getInputType from './get-input-type';\r\n\r\nimport getOption from '../../../utils/get-option';\r\n\r\nexport default function setInputAttributes(inputView, opts = {}) {\r\n\r\n\tlet attributes = getOption(inputView, 'attributes', { checkAlso: opts, args:[inputView] });\r\n\r\n\tlet restrictionKeys = {\r\n\t\t'maxLength':'maxlength', \r\n\t\t'minValue':'min', \r\n\t\t'maxValue':'max', \r\n\t\t'valuePattern':'pattern',\r\n\t\t'required':'required',\r\n\t\t'value':'value'\r\n\t};\r\n\tlet restrictions = {};\r\n\t_(restrictionKeys).each((key2, key) => {\r\n\t\tlet value = getOption(inputView, key, { checkAlso: opts, args:[inputView] });\r\n\t\tif (value != null)\r\n\t\t\trestrictions[key2] = value;\r\n\t});\r\n\r\n\tinputView.attributes = _.extend({\r\n\t\tvalue: inputView.value,\r\n\t\ttype: getInputType(inputView, opts),\r\n\t}, restrictions, attributes);\r\n\r\n}\r\n","import getOption from '../../../../utils/get-option';\r\nexport default (context, key, ifNull) => getOption(key, { args:[context], default: ifNull });\r\n\r\n","export default function isChar(event){\r\n\treturn event.key && event.key.length == 1 && !event.ctrlKey;\r\n}","import getOption from './_get-option';\r\nimport isChar from './_is-char';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\tlet prevent = false;\r\n\tlet stop = false;\r\n\r\n\tif (isChar(event)) {\r\n\t\tif (!context.isEnteredCharValid(event.key)) {\r\n\t\t\tprevent = true;\r\n\t\t}\r\n\t}\r\n\tif(event.keyCode == 13 && getOption(context, 'doneOnEnter', true)){\r\n\t\tprevent = true;\r\n\t\tstop = true;\r\n\t}\r\n\r\n\tstop && event.stopPropagation();\r\n\tprevent && event.preventDefault();\r\n}\r\n","import getOption from './_get-option';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\tif(event.keyCode == 13 && getOption(context, 'doneOnEnter', true)){\r\n\t\tcontext.triggerControlDone();\r\n\t\tevent.stopPropagation();\r\n\t\tevent.preventDefault();\r\n\t}\r\n}","export default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\tlet text = event.originalEvent.clipboardData.getData('text/plain');\r\n\tif (!text) return;\r\n\tif (!context.isValueValid(text)) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\t}\r\n}\r\n","import getOption from './_get-option';\r\nexport default function(eventContext) {\r\n\tlet { context } = eventContext;\r\n\tif (getOption(context, 'doneOnBlur', true)) {\r\n\t\tcontext.triggerControlDone();\r\n\t}\r\n}","import getOption from './_get-option';\r\nexport default function(eventContext) {\r\n\tlet { context, input } = eventContext;\r\n\tif (getOption(context, 'selectOnFocus', true)) {\r\n\t\tinput.select();\r\n\t}\r\n}\r\n","export default function(eventContext) {\r\n\r\n\tlet { context, input, event } = eventContext;\r\n\r\n\tlet newvalue = context.setControlValue(event.target.value);\r\n\tif (event.target.value != (newvalue || '').toString()) {\r\n\t\tinput.value = newvalue;\r\n\t}\r\n\t//context.triggerControlChange();\r\n}\r\n","import keydown from './keydown';\r\nimport keyup from './keyup';\r\nimport paste from './paste';\r\nimport blur from './blur';\r\nimport focus from './focus';\r\nimport input from './input';\r\n//import jsChange from './js-change';\r\nexport default {\r\n\tkeydown, \r\n\t//keypress,\r\n\tkeyup,\r\n\tpaste,\r\n\tblur,\r\n\tfocus,\r\n\tinput,\r\n\t//'js:change': jsChange\r\n};","import camelCase from '../../../utils/camel-case';\r\nimport events from './events';\r\nexport default function handleInputEvent(control, eventName, event) {\r\n\tlet options = _.extend({\r\n\t\tcontext: control,\r\n\t\tinput: control.el,\r\n\t\trestrictions: control.restrictions,\r\n\t\teventName,\r\n\t\tevent\r\n\t});\r\n\r\n\r\n\tlet method = camelCase(`on:dom:${eventName}`);\r\n\r\n\tif (_.isFunction(events[eventName])) {\r\n\t\tevents[eventName].call(control, options);\r\n\t} \r\n\t\r\n\tif (_.isFunction(control[method])) {\r\n\t\tcontrol[method](event, options);\r\n\t} \r\n}","import handleEvent from './handle-event';\r\nimport eventHandlers from './events';\r\nimport getOption from '../../../utils/get-option';\r\n\r\nconst _getOption = (context, key, checkAlso) => \r\n\tgetOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function setInputEvents(inputView, opts = {}) {\r\n\r\n\tlet passedEvents = _getOption(inputView, 'events', opts);\t\r\n\r\n\tlet eventsArray = _(eventHandlers).keys();\t\r\n\tlet events = _.reduce(eventsArray, (Memo, eventName) => {\r\n\t\tMemo[eventName] = function(event){ \r\n\t\t\thandleEvent(this, eventName, event); \r\n\t\t};\r\n\t\treturn Memo;\r\n\t}, {});\r\n\tinputView.events = _.extend(events, passedEvents);\r\n}\r\n","export default function toNumber(text){\r\n\tif(_.isNumber(text)) return text;\r\n\tif(!_.isString(text)) return;\r\n\t\r\n\tlet value = parseFloat(text, 10);\r\n\tif(isNaN(value))\r\n\t\tvalue = undefined;\r\n\t\t\r\n\treturn value;\r\n}\r\n","export default {\r\n\tnullable: true, \r\n\tstrict: false,\r\n\treturnNullAs: undefined, \r\n\treturnEmptyAs: undefined, \r\n\treturnNullAndEmptyAs: undefined,\r\n\treturnAnyAs: undefined, \r\n\treturnOtherAs: undefined\r\n};\r\n","import defaultOptions from './options';\r\n\r\nconst trueValues = ['true','1','-1','yes'];\r\nconst falseValues = ['false','0','no'];\r\n\r\nconst alternative = function(...args) {\r\n\tlet returnValue;\r\n\t_(args).some(arg => {\r\n\t\tif(_.isBoolean(arg)) {\r\n\t\t\treturnValue = arg;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t});\r\n\treturn returnValue;\r\n};\r\n\r\nconst valueOrAlternative = function(nullable, nullValue, value, ...alts){\r\n\tlet alt = alternative(...alts);\r\n\tif (alt != null)\r\n\t\treturn alt;\r\n\telse if (nullable)\r\n\t\treturn nullValue;\r\n\telse\r\n\t\treturn value;\r\n};\r\n\r\nconst convertToBoolean = function (arg, opts = {})\r\n{\r\n\r\n\tlet other;\r\n\tlet options = _.extend({}, defaultOptions, opts);\r\n\tlet { \r\n\t\tnullable, strict,\r\n\t\treturnNullAs, returnEmptyAs, returnNullAndEmptyAs,\r\n\t\treturnAnyAs, returnOtherAs\r\n\t} = options;\r\n\r\n\r\n\r\n\tif (arg == null) {\r\n\t\treturn valueOrAlternative(nullable, undefined, false, returnNullAs, returnNullAndEmptyAs);\r\n\t}\r\n\telse if (arg === '') {\r\n\t\treturn valueOrAlternative(nullable, undefined, false, returnEmptyAs, returnNullAndEmptyAs);\r\n\t} else if (_.isBoolean(arg)) {\r\n\t\treturn arg;\r\n\t}\r\n\t//  else if (_.isObject(arg)) {\r\n\t// }\r\n\t\r\n\tother = strict \r\n\t\t? (nullable ? undefined : false) \r\n\t\t: true;\r\n\t\t\r\n\r\n\tlet text = arg.toString().toLowerCase();\r\n\tlet isTrue = convertToBoolean.trueValues.indexOf(text) > -1;\r\n\tlet isFalse = convertToBoolean.falseValues.indexOf(text) > -1;\r\n\r\n\r\n\tif (_.isBoolean(returnAnyAs)) {\r\n\t\treturn returnAnyAs;\r\n\t} else if (_.isBoolean(returnOtherAs)) {\r\n\t\tother = returnOtherAs;\r\n\t}\r\n\t\r\n\treturn isTrue \r\n\t\t? true \r\n\t\t: isFalse \r\n\t\t\t? false \r\n\t\t\t: other;\r\n};\r\n\r\nconvertToBoolean.trueValues = trueValues;\r\nconvertToBoolean.falseValues = falseValues;\r\nexport default convertToBoolean;\r\n","import toNumber from './to-number';\r\nimport toBoolean from '../to-bool';\r\n\r\n\r\n//this is under development yet and can be change in any time\r\nexport default function convertString(text, type, opts) {\r\n\r\n\tswitch(type){\r\n\tcase 'number':\r\n\t\treturn toNumber(text, opts);\r\n\tcase 'boolean':\r\n\t\treturn toBoolean(text, opts);\r\n\tdefault:\r\n\t\treturn text;\r\n\t}\r\n\r\n\r\n}\r\n","import ControlMixin from '../control';\r\nimport setInputAttributes from './set-attributes';\r\nimport setInputEvents from './set-events';\r\nimport getOption from '../../../utils/get-option';\r\nimport convert from '../../../utils/convert-string';\r\n\r\nexport default Base => {\r\n\r\n\tlet Mixin = Base.ControlMixin ? Base : ControlMixin(Base);\r\n\r\n\treturn Mixin.extend({\r\n\t\tconstructor(opts){\r\n\t\t\t\r\n\t\t\tsetInputAttributes(this, opts);\r\n\t\t\tsetInputEvents(this, opts);\r\n\t\t\tMixin.apply(this, arguments);\r\n\r\n\t\t\tif (!_.isFunction(this.getOption)) {\r\n\t\t\t\tthis.getOption = _.partial(getOption, this, _, { args: [this]});\r\n\t\t\t}\r\n\r\n\t\t\tthis.buildRestrictions();\r\n\t\t\tlet value = this.getOption('value') || '';\t\t\t\r\n\t\t\tthis.el.value = value;\r\n\t\t\tthis.setControlValue(value);\r\n\t\t},\r\n\t\ttagName:'input',\r\n\t\ttemplate: false,\r\n\t\tbuildRestrictions(){\r\n\t\t\tlet attrs = _.result(this, 'attributes');\r\n\t\t\tlet pickNumbers = ['maxlength', 'min', 'max'];\r\n\t\t\tlet pickStrings = ['pattern'];\r\n\t\t\tlet pickBools = ['required'];\r\n\t\t\tlet restrictions = {};\r\n\t\t\t_(attrs).each((value, key) => {\r\n\t\t\t\tlet pick = false;\r\n\t\t\t\tkey = key.toLowerCase();\r\n\t\t\t\tif (pickNumbers.indexOf(key) > -1) {\r\n\t\t\t\t\tvalue = convert(value, 'number');\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickStrings.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickBools.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t\tvalue = convert(value, 'boolean', { returnNullAndEmptyAs: true, returnOtherAs: true });\r\n\t\t\t\t}\r\n\t\t\t\tpick && (restrictions[key] = value);\r\n\t\t\t});\r\n\t\t\tthis.restrictions = restrictions;\t\t\r\n\t\t},\r\n\t\tsetControlValue(value, opts = {})\r\n\t\t{\r\n\t\t\tthis.value = this.prepareValueBeforeSet(value);\r\n\t\t\tif(!opts.silent)\r\n\t\t\t\tthis.triggerControlChange();\r\n\t\t\treturn this.value;\r\n\t\t},\r\n\t\tprepareValueBeforeSet(value){\r\n\t\t\tif (value == null || value === '') return value;\r\n\t\t\t\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\tif (len > 0) {\r\n\t\t\t\tvalue = value.toString().substring(0, len);\r\n\t\t\t}\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tlet num = convert(value, 'number');\r\n\t\t\t\tif(isNaN(num))\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlet min = this.restrictions.min;\r\n\t\t\t\tlet max = this.restrictions.max;\r\n\t\t\t\t!isNaN(min) && num < min && (num = min);\r\n\t\t\t\t!isNaN(max) && num > max && (num = max);\r\n\t\t\t\treturn num;\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tgetValueType(){\r\n\t\t\treturn this.valueType;\r\n\t\t},\r\n\t\tconvertValue(value){\r\n\t\t\treturn convert(value, this.getValueType());\r\n\t\t},\t\t\r\n\t\tgetMaxLength()\r\n\t\t{\r\n\t\t\treturn this.restrictions.maxlength;\r\n\r\n\t\t},\r\n\t\tisLengthValid(){\r\n\t\t\tlet value = this.getControlValue();\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\treturn len == null || value.length < len;\r\n\t\t},\r\n\t\tisEnteredCharValid(char) {\r\n\t\t\tlet type = this.getValueType();\r\n\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn ['.','-'].indexOf(char) > -1 || !isNaN(parseInt(char, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tisValueValid(value){\r\n\t\t\tlet type = this.getValueType();\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn !isNaN(parseFloat(value, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tvalidateControlValue(value){\r\n\t\t\tif (value == null || value === '') {\r\n\t\t\t\tif(this.restrictions.required)\r\n\t\t\t\t\treturn 'required';\r\n\t\t\t\telse\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet strValue = value.toString();\r\n\t\t\tif (_.isNumber(this.restrictions.maxlength) && strValue.length > this.restrictions.maxlength)\r\n\t\t\t\treturn 'length:big';\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tif (!_.isNumber(value))\r\n\t\t\t\t\treturn 'not:number';\r\n\t\t\t\tif (_.isNumber(this.restrictions.min) && value < this.restrictions.min)\r\n\t\t\t\t\treturn 'less:than:min';\r\n\t\t\t\tif (_.isNumber(this.restrictions.max) && value > this.restrictions.max)\r\n\t\t\t\t\treturn 'greater:than:max';\r\n\t\t\t}\r\n\t\t\tif (this.restrictions.pattern) {\r\n\t\t\t\tlet pattern = RegExp(this.restrictions.pattern);\r\n\t\t\t\tif (pattern.test(strValue)) {\r\n\t\t\t\t\treturn 'pattern:mismatch';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n};\r\n","export default {\r\n\tmergeObjects: true,\r\n\twrapObjectWithConstructor: true,\r\n};\r\n","export default function createMixinFromObject(arg) {\r\n\tlet obj = _.clone(arg);\r\n\treturn Base => { \r\n\t\tif (_.isFunction(obj.constructor)) {\r\n\t\t\tlet providedCtor = obj.constructor;\r\n\t\t\tobj.constructor = function(){\r\n\t\t\t\tBase.apply(this, arguments);\r\n\t\t\t\tprovidedCtor.apply(this, arguments);\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn Base.extend(obj);\r\n\t};\r\n}\r\n","\r\nimport createMixinFromObject from './create-mixin-from-object';\r\n\r\nexport default function normalizeArguments(args, opts = {}) {\r\n\tlet raw = {};\r\n\tlet wrap = opts.wrapObjectWithConstructor == true;\r\n\tlet merge = opts.mergeObjects == true;\r\n\tlet mixins = [];\r\n\t_(args).each(arg => {\r\n\t\t\r\n\t\t//if argument is function just put it to mixins array\r\n\t\t//and continue;\r\n\t\tif (_.isFunction(arg)) {\r\n\t\t\tmixins.push(arg);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//if argument is not an object just skip it\r\n\t\tif (!_.isObject(arg)) return;\r\n\r\n\t\t//if mergeObjects == false or wrapObjectWithConstructor == true \r\n\t\t//and there is a constructor function\r\n\t\t//converting to a mixin function\r\n\t\t//otherwise extend rawObject\r\n\t\tif (!merge || (wrap && _.isFunction(arg.constructor))) {\r\n\t\t\tmixins.push(createMixinFromObject(arg));\r\n\t\t} \r\n\t\telse {\r\n\t\t\t_.extend(raw, arg);\r\n\t\t}\r\n\t\r\n\t});\r\n\r\n\t//if rawObject is not empty\r\n\t//convert it to a mixin function\r\n\t//and put it to the begin of mixins array\r\n\tif (_.size(raw))\r\n\t\tmixins.unshift(createMixinFromObject(raw));\r\n\r\n\treturn mixins;\r\n}\r\n","\r\n\r\nimport normalizeArguments from './normalize-arguments';\r\n\r\nexport default function withMethod(...args) {\r\n\r\n\tlet mixins = normalizeArguments(args, this.options);\r\n\tlet Mixed = this.class;\r\n\tif (!mixins.length) return Mixed;\r\n\telse\r\n\t\treturn _.reduce(mixins, (Memo, Ctor) => Ctor(Memo), Mixed);\r\n\r\n}\r\n","//import Mn from 'backbone.marionette';\r\nexport default Mn.extend;\r\n","import defaultOptions from './options';\r\nimport withMethod from './with';\r\n\r\nimport extend from '../extend';\r\n\r\n\r\n\r\nexport default function mix(_ctor, options) {\r\n\r\n\tlet opts = _.extend({}, defaultOptions, options);\r\n\r\n\tlet ctor;\r\n\tif (_.isFunction(_ctor)) {\r\n\t\tctor = _ctor;\r\n\t}\r\n\telse if (_.isObject(_ctor)) {\r\n\t\tctor = function () { };\r\n\t\t_.extend(ctor.prototype, _ctor);\r\n\t} else {\r\n\t\tthrow new Error('Mix argument should be a class or a plain object');\r\n\t}\r\n\r\n\tif (!_.isFunction(ctor.extend))\r\n\t\tctor.extend = extend;\r\n\r\n\treturn {\r\n\t\toptions: opts,\r\n\t\twith: withMethod,\r\n\t\tclass: ctor,\r\n\t};\r\n}\r\n","function pstoSetPair(context, pair){\r\n\tif(!_.isString(pair)) return;\r\n\tlet keyvalue = pair.split('=');\r\n\tlet key = keyvalue.shift();\r\n\tlet value = keyvalue.join('=');\r\n\tpstoSetKeyValue(context, key, value);\r\n}\r\n\r\nfunction pstoSetKeyValue(context, key, value){\r\n\t\t\r\n\tif (key == null) return;\r\n\tkey = decodeURIComponent(key);\r\n\tvalue != null && (value = decodeURIComponent(value));\r\n\r\n\tif(!(key in context))\r\n\t\treturn (context[key] = value);\r\n\r\n\t!_.isArray(context[key]) && (context[key] = [context[key]]);\r\n\r\n\tcontext[key].push(value);\r\n\r\n\treturn context[key];\r\n}\r\n\r\nexport default function paramsToObject(raw, opts = {emptyObject: true}){\r\n\tlet result = {};\r\n\tif(!_.isString(raw)) return opts.emptyObject ? result : raw;\r\n\r\n\tlet pairs = raw.split('&');\r\n\t_(pairs).each((pair) => pstoSetPair(result, pair));\r\n\t\r\n\treturn result;\r\n}\r\n","import mix from '../../utils/mix';\r\nimport GetOptionMixin from '../../mixins/common/get-option';\r\nimport paramStringToObject from '../../utils/params-to-object';\r\nimport BbRouter from '../../bb/router';\r\nimport triggerMethodOn from '../../mn/trigger-method-on';\r\n\r\nconst BaseRouter = mix(BbRouter).with(GetOptionMixin);\r\nconst Router = BaseRouter.extend({\r\n\r\n\r\n\t// for migrating from Mn.AppRoute\r\n\t// set to true. it will populate routes from { controller, appRoutes } structure.\r\n\tisMarionetteStyle: false,\r\n\r\n\t// by default Backbone.Router tries to lookup callback in router instance by name `callback = this[name]` if there is no callback provided\r\n\t// its recomend to turn this feature to false\r\n\t// default value is true for Backbone.Router compatability\r\n\tisRouterHoldsActions : true,\r\n\r\n\t// by default Backbone.Router `route` method returns router itself instead of just created routeContext for chaining purposes.\r\n\t// you can change this behavior turning this feature to false\r\n\tisRouteChaining: true,\r\n\r\n\t//in classic mode actions receive argument array\r\n\t//if you need actionContext instead turn this option to false\r\n\tclassicMode: true,\r\n\r\n\tconstructor(options = {}){\r\n\t\t\r\n\t\tthis.options = _.extend({}, _.result(this, 'options'), options);\r\n\r\n\t\tBaseRouter.apply(this, arguments);\r\n\r\n\t\tthis.on('re:route:last', this._onReRouteLast);\r\n\t},\r\n\r\n\r\n\t/*\r\n\r\n\t\tinitialize methods\r\n\t\t\"when a router initialized\"\r\n\r\n\t*/\r\n\r\n\t//by default router expects that routes will result in { route, callback } hash\r\n\t//we are extending this to provide more flexibility\r\n\t_bindRoutes: function() {\r\n\t\t\r\n\t\tlet routes = this.getInitRoutes();\r\n\t\tif(!_.size(routes)) return;\r\n\t\tthis.addRoutes(routes);\r\n\r\n\t},\r\n\r\n\tgetInitRoutes(){\r\n\t\tlet routes;\r\n\t\tif(!this.getOption('isMarionetteStyle'))\r\n\t\t\troutes = this.getOption('routes');\r\n\t\telse {\r\n\t\t\tlet cntrl = this.getOption('controller') || {};\r\n\t\t\tlet approutes = this.getOption('appRoutes') || {};\r\n\t\t\troutes = _(approutes).map((name, route) => _.create({}, { route, name, callback:cntrl[name] }));\r\n\t\t}\r\n\t\treturn routes;\r\n\t},\r\n\r\n\r\n\t/*\r\n\t\r\n\t\tregister new route methods\r\n\t\t\"when a new route added\"\r\n\r\n\t*/\r\n\r\n\t// refactored original route method\r\n\t// chain:true by default is for supporting default behavior\r\n\t// routerHoldsActions: true - backbone router tries to get callback from router itself if there is no callback provided. \r\n\t// this options allow to support this behavior, but its recomended not to hold action inside router instance\r\n\troute(route, name, callback, opts = {}){\r\n\t\t\r\n\t\t//normalizing passed arguments and putting them into a context object\r\n\t\t//refactored from original route\r\n\t\tlet context = this._normalizeRegisterRouteArguments(route, name, callback, opts);\r\n\r\n\t\t//extends context with result of `mergeWithRegisterRouteContext`\r\n\t\tthis._normalizeRegisterRouteContext(context);\r\n\r\n\t\t//wrapping provided callback \r\n\t\tthis._normalizeRegisterRouteCallback(context);\r\n\r\n\t\t\r\n\t\t//refactored for providing possibility to override\r\n\t\t//at this point context should be almost ready\r\n\t\tthis.registerRouteContext(context);\r\n\r\n\t\tthis._storeCreatedContext(context, opts);\r\n\r\n\r\n\r\n\t\tif(opts.isRouteChaining === true)\r\n\t\t\treturn this;\r\n\t\telse\r\n\t\t\treturn context;\r\n\t},\r\n\r\n\t// provide more semantic alias for route\r\n\taddRoute(route, name, callback, opts = {}){\r\n\t\tif(opts.isRouteChaining == null)\r\n\t\t\topts.isRouteChaining = this.getOption('isRouteChaining');\r\n\r\n\t\tlet context = this.route(route, name, callback, opts);\r\n\t\treturn context;\r\n\t},\r\n\r\n\t//process many routes at once\r\n\t//accepts object { name, routeContext | handler }\r\n\t// or array of routeContexts\r\n\taddRoutes(routes, opts = {}){\r\n\r\n\t\tif(opts.isRouteChaining == null)\r\n\t\t\topts.isRouteChaining = this.getOption('isRouteChaining');\r\n\r\n\t\tlet normalized = _(routes).map((value, key) => this._normalizeRoutes(value, key));\r\n\r\n\t\tif(opts.doNotReverse != true)\r\n\t\t\tnormalized.reverse();\r\n\r\n\t\tlet registered = _(normalized).map((route) => route && this.addRoute(route, _.extend({massAdd:true},opts))); \r\n\t\t\r\n\t\tif(opts.doNotReverse != true)\r\n\t\t\tregistered.reverse();\r\n\r\n\t\t_(registered).each((c) => this._storeCreatedContext(c));\r\n\t\t\r\n\t\treturn registered;\r\n\t},\r\n\r\n\t// internal method called by `addRoutes` to normalize provided data\r\n\t_normalizeRoutes(value, key){\r\n\t\t//let route, name, callback;\r\n\t\tlet context;\r\n\t\tif (_.isString(value)) {\r\n\t\t\tcontext = { \r\n\t\t\t\troute: key, \r\n\t\t\t\tname: value, \r\n\t\t\t};\r\n\t\t}\r\n\t\telse if(_.isFunction(value)){\r\n\t\t\tcontext = { route:key, callback:value };\r\n\t\t}else if(_.isObject(value)){\r\n\t\t\tcontext = _.clone(value);\r\n\t\t\tif(!_.has(context, 'route'))\r\n\t\t\t\tcontext.route = key;\r\n\t\t\telse if(_.has(context, 'route') && !_.has(context, 'name'))\r\n\t\t\t\tcontext.name = key;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn context;\r\n\t},\r\n\r\n\r\n\t//refactored out from original route method\r\n\t//just check passed arguments and mix them into an object\r\n\t_normalizeRegisterRouteArguments(route, name, callback, opts = {}){\r\n\t\tlet context = {};\r\n\r\n\t\tif(_.isObject(route)){\r\n\t\t\tcontext = route;\r\n\t\t\t//_.extend(context, route);\r\n\t\t\t//then second argument is probably options;\r\n\t\t\t_.extend(opts, name);\r\n\r\n\t\t} else if (_.isFunction(name)) {\r\n\t\t\t_.extend(context, { route, callback: name, name: _.uniqueId('routerAction')});\r\n\t\t}else {\r\n\t\t\t_.extend(context, { route, name, callback });\r\n\t\t}\r\n\r\n\r\n\t\t!_(opts).has('isRouterHoldsActions') && (opts.isRouterHoldsActions = this.getOption('isRouterHoldsActions'));\r\n\t\t!_(opts).has('isRouteChaining') && (opts.isRouteChaining = this.getOption('isRouteChaining'));\r\n\r\n\r\n\t\t// last chance to get callback from router instance by name\r\n\t\t// this behavior can be disabled through `isRouterHoldsActions` options\r\n\t\tif(!_.isFunction(context.callback) && opts.isRouterHoldsActions)\r\n\t\t\tcontext.callback = this[context.name];\r\n\r\n\r\n\t\t//store original route\r\n\t\tcontext.rawRoute = context.route;\r\n\r\n\t\t!context.name && (context.name = _.uniqueId('routerAction'));\r\n\r\n\t\t//converts route to RegExp pattern\r\n\t\tif (!_.isRegExp(context.route)) context.route = this._routeToRegExp(context.route);\r\n\r\n\t\treturn context;\r\n\t},\r\n\r\n\t//internal method for merging context with user defined object\r\n\t_normalizeRegisterRouteContext(context){\r\n\t\t_.extend(context, this.routeContext(context));\r\n\t},\r\n\r\n\t//override this method if you need more information in route context\r\n\t// should return object wich will be merged with default context\r\n\t// be aware of providing reserved properties: route, name, callback\r\n\t// this will override context defaults\r\n\trouteContext: _.noop,\r\n\r\n\r\n\t//wraps provided callback with correct environment\r\n\t//and some events triggers\r\n\t_normalizeRegisterRouteCallback(context){\r\n\r\n\t\tif(!_.isFunction(context.callback) )\r\n\t\t\tcontext.callback = () => {};\r\n\r\n\t\t//context.originalCallback = context.callback;\r\n\t\t//context.callback = _.bind(this._processCallback, this, context);\r\n\t\tcontext.historyRouteCallback = _.bind(this._processCallback, this, context);\r\n\t},\r\n\r\n\t//finally, putting handler to the backbone.history.handlers\r\n\tregisterRouteContext(context){\r\n\t\tBackbone.history.route(context.route, context.historyRouteCallback, context);\r\n\t},\r\n\r\n\t//store registered context for further use\r\n\t_storeCreatedContext(context, opts = {}){\r\n\t\tthis.routeContexts || (this.routeContexts = {});\r\n\t\tif(!opts.massAdd)\r\n\t\t\tthis.routeContexts[context.name] = context;\r\n\t\treturn context;\r\n\t},\r\n\r\n\r\n\r\n\t/*\r\n\t\r\n\t\tprocess route methods\t\t\r\n\t\t\"when route happens\"\r\n\r\n\t*/\r\n\r\n\t//inner route handler\r\n\t//preparing actionContext and calls public processCallback\r\n\t_processCallback (routeContext, fragment, options = {}) {\r\n\t\tlet actionContext = this._createExecuteActionContext(routeContext, fragment, options);\r\n\r\n\t\tactionContext.options = options;\r\n\t\tif (actionContext.routeType == null) {\r\n\r\n\t\t\tactionContext.routeType = 'route';\r\n\t\t\trouteContext.lastAttempt = actionContext;\r\n\t\t\t//this.lastActionContext = routeContext;\r\n\t\t}\r\n\t\t//actionContext.restart = () => actionContext.callback(fragment, options);\r\n\t\tlet result = this.processCallback(actionContext, actionContext.routeType);\r\n\t\t//this.triggerHistory(history, actionContext.fragment, actionContext);\r\n\t\treturn result;\r\n\t},\r\n\t\r\n\t//by default behave as original router\r\n\t//override this method to process action by your own\r\n\tprocessCallback(actionContext, routeType){\r\n\r\n\t\tlet resultContext = {};\r\n\t\tlet toPromise = this.getOption('callbacksAsPromises');\r\n\t\tlet callback = (...args) => { \r\n\t\t\tlet result = actionContext.callback(...args);\r\n\t\t\tif (toPromise) {\r\n\t\t\t\tif (!(result instanceof Promise || (!!result && _.isFunction(result.then)))) {\r\n\t\t\t\t\tresult = Promise.resolve(result);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresultContext.result = result;\t\t\t\r\n\t\t};\r\n\r\n\t\tlet args = this.getOption('classicMode') \r\n\t\t\t? actionContext.rawArgs || [] \r\n\t\t\t: [actionContext];\r\n\r\n\t\tlet event = this.execute(callback, args) !== false ? routeType : 'fail';\r\n\t\tthis.triggerRouteEvents(actionContext, event, actionContext.name, ...args);\r\n\r\n\t\tlet delegate = this.getOption('delegatePromiseErrorsTo');\r\n\t\tlet catchErrors = this.getOption('catchPromiseErrors');\r\n\t\tresultContext.result.then(\r\n\t\t\t(arg) => arg,\r\n\t\t\t(error) => {\r\n\t\t\t\tif (delegate && _.isFunction(delegate.trigger)) {\r\n\t\t\t\t\ttriggerMethodOn(delegate, 'route:error', actionContext, error);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif(!catchErrors)\r\n\t\t\t\t\t\treturn Promise.reject(error);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\treturn resultContext.result;\r\n\t},\r\n\r\n\r\n\t_onReRouteLast(){\r\n\t\tif(!this.lastAttempt) return;\r\n\t\tlet ac = this.lastAttempt.lastActionContext;\r\n\t\tac.callback(ac.fragment, ac.options);\r\n\t},\r\n\r\n\r\n\t//just triggers appropriate events\r\n\ttriggerRouteEvents(context, event, name, ...args) {\r\n\t\tif (event == 'route') {\r\n\t\t\tthis.lastActionContext = context;\r\n\t\t}\r\n\t\tthis.trigger(`${event}:${name}`, ...args);\r\n\t\tthis.trigger(event, name, ...args);\r\n\t\tBackbone.history.trigger(event, this, name, ...args);\r\n\t},\r\n\r\n\t//triggers directional event on History.\r\n\t// triggerHistory(history, fragment, actionContext){\r\n\t// \tBackbone.history.trigger(history, fragment, actionContext);\r\n\t// },\r\n\r\n\t//converts actions arguments array to actionContext\r\n\t// context : {\r\n\t//   qs: {},\r\n\t//   args:{},\r\n\t// }\r\n\t_createExecuteActionContext(context, fragment, options) {\r\n\r\n\t\tlet rawArgs = this._extractParameters(context.route, fragment);\r\n\t\tlet result = _.extend({}, context, { fragment, rawArgs }, options);\r\n\t\tlet args = rawArgs.slice(0);\r\n\t\t_.extend(result, { qs: this._prepareActionQueryString(args) });\r\n\t\t_.extend(result, { args: this._prepareActionArguments(fragment, context.rawRoute, args) });\r\n\t\tresult.reroute = () => {\r\n\t\t\tlet newcontext = _.extend({ routeType: 'reroute' }, result);\r\n\t\t\treturn newcontext.callback(fragment, options);\r\n\t\t};\r\n\t\t//actionContext.restart = () => actionContext.callback(fragment, options);\r\n\t\treturn result;\r\n\t},\r\n\r\n\t//extracts last backbone action argument and converts it to key value object\r\n\t//using queryStringParser method.\r\n\t_prepareActionQueryString(args){\r\n\t\tif(!_.isArray(args) || args.length == 0 || (args.length == 1 && args[0] == null))\r\n\t\t\treturn {};\r\n\t\tlet rawQs = args.pop();\r\n\t\treturn this.queryStringParser(rawQs);\r\n\t},\r\n\r\n\t//converts action arguments array to named object {key:value}\r\n\t_prepareActionArguments(fragment, rawRoute, args){\r\n\t\tlet params = rawRoute.match(/:([^/|)]+)/g) || [];\r\n\t\tlet res = {};\r\n\t\t_(params).each((name, index) => {\r\n\t\t\tname = name.substring(1);\r\n\t\t\t\r\n\t\t\tif(args == null) return;\r\n\r\n\t\t\tif(name in res && _.isArray(res[name]))\r\n\t\t\t\tres[name].push(args[index]);\r\n\t\t\telse if(name in res && !_.isArray(res[name]))\r\n\t\t\t\tres[name] = [res[name]].concat(args[index]);\r\n\t\t\telse\r\n\t\t\t\tres[name] = args[index];\r\n\t\t});\r\n\t\treturn res;\r\n\t},\r\n\r\n\t//converts string to object\r\n\t//default implementation, can be overriden by user\r\n\tqueryStringParser: paramStringToObject,\t\r\n\r\n\r\n\t/*\r\n\t\tSome API methods\r\n\t*/\r\n\r\n\tgetContextByFragment(fragment)\t{\r\n\t\tif(!_.isString(fragment)) return;\r\n\t\t//let contexts = this.routeContexts;\r\n\t\t//console.log('Router contexts', contexts);\r\n\t\tlet result = _(this.routeContexts).find((cntx) => cntx.route.test(fragment));\r\n\t\treturn result;\r\n\t}\r\n\r\n\r\n});\r\n\r\nexport default Router;\r\n","import BaseRouter from '../router';\r\n\r\nexport default BaseRouter.extend({\r\n\t\r\n\tclassicMode:false,\r\n\tisRouterHoldsActions : false,\r\n\tisRouteChaining: false,\t\r\n\tcallbacksAsPromises: true,\r\n\tregisterPageRoutes(page){\r\n\t\tlet contexts = page.getRoutesContexts();\r\n\t\t_(contexts).each(context => {\r\n\t\t\tlet callback = (...args) => {\r\n\t\t\t\treturn page.start(...args);\r\n\t\t\t};\r\n\t\t\tthis.addRoute(context.route, context.name, callback);\r\n\t\t});\r\n\t},\r\n\t// processCallback(actionContext, routeType){\r\n\r\n\t// \trouteType || (routeType = 'route');\r\n\t// \tthis.triggerRouteEvents(actionContext, routeType, actionContext.name, actionContext);\r\n\t// \treturn actionContext.callback().then(\r\n\t// \t\t() => {},\r\n\t// \t\t(error) => this.processCallbackError(actionContext, error)\r\n\t// \t);\r\n\t// \t// return actionContext.page.start(actionContext).catch((error, ...args) => {\r\n\r\n\t// \t// \tthis.processStartError(actionContext, error);\r\n\r\n\t// \t// });\r\n\t// },\r\n\t// processCallbackError(ac, error){\r\n\r\n\t// },\r\n\r\n\t/*\r\n\tprocessStartError(actionContext, error){\r\n\t\tactionContext.error = error;\r\n\t\tlet errorEvents = [this.createErrorEvent(error, actionContext)];\r\n\t\tlet customErrors = this.processCustomError(error, actionContext);\r\n\t\tcustomErrors && !_.isArray(customErrors) && (customErrors = [customErrors]);\r\n\t\tthis.triggerErrors(actionContext, errorEvents.concat(customErrors || []));\t\t\r\n\t},\r\n\tcreateErrorEvent(risedError, actionContext, name){\r\n\t\tname != null && (name = ':' + String(name));\r\n\t\t!name && (name='');\r\n\t\tlet error = {\r\n\t\t\tevent: `error${name}`,\r\n\t\t\targs: [risedError, actionContext]\r\n\t\t};\r\n\t\treturn error;\r\n\t},\r\n\tprocessCustomError(error, actionContext){\r\n\t\tlet errors = [];\r\n\t\tif(error.status != null){\r\n\t\t\terrors.push(this.createErrorEvent(error, actionContext, error.status));\r\n\t\t}\r\n\t\treturn errors;\r\n\t},\r\n\ttriggerErrors(actionContext, errorEvents){\r\n\t\t//console.log('START ERRORS', errorEvents);\r\n\t\tlet page = actionContext.page;\r\n\t\t_(errorEvents).each((errorEvent) => {\r\n\t\t\tpage.trigger(errorEvent.event,  ...(errorEvent.args || []));\r\n\t\t});\r\n\t},\r\n\t*/\r\n});\r\n","import isModel from '../../bb/is-model';\r\nimport isView from '../../bb/is-view';\r\nexport default function getModel(arg){\r\n\treturn isModel(arg) ? arg\r\n\t\t: isView(arg) ? arg.model\r\n\t\t\t: undefined;\r\n}","import isView from '../../bb/is-view';\r\nexport default function getModel(arg){\r\n\treturn isView(arg) && arg;\r\n}","\r\nimport getModel from './get-model';\r\nimport getView from './get-view';\r\nexport default function compareAB(a, b, func){\r\n\tif(_.isArray(func)) {\r\n\r\n\t\tlet result = 0;\r\n\r\n\t\t_(func).every((f) => {\r\n\t\t\tresult = compareAB(a,b,f);\r\n\t\t\treturn result === 0;\r\n\t\t});\r\n\t\t\r\n\t\treturn result;\r\n\t} else {\r\n\t\tif (_.isFunction(func)) {\r\n\t\t\ta = func.call(a, getModel(a), getView(a)) ;\r\n\t\t\tb = func.call(b, getModel(b), getView(b));\r\n\t\t}\r\n\t\treturn a < b ? -1\r\n\t\t\t: a > b ? 1\r\n\t\t\t\t: 0;\r\n\t}\r\n}\r\n","import compareAB from '../compare-ab';\r\nexport default function comparator(...args){\r\n\tvar result = 0;\r\n\r\n\t//for simple case (arg1, arg2, compare)\r\n\tif (args.length <= 3 && !_.isArray(args[0])){\r\n\r\n\t\treturn compareAB.apply(null, args);\r\n\r\n\t} \r\n\t//for complex cases ([arg1, arg2, compare], [], .... [])\r\n\t//each arguments should be an array\r\n\telse {\r\n\r\n\t\t_(args).every((single) => {\r\n\r\n\t\t\tif(!_.isArray(single)) return true;\r\n\t\t\tresult = compareAB(...single);\r\n\t\t\treturn result === 0;\r\n\t\t});\r\n\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n","import BaseRouter from './router';\r\nimport comparator from '../../utils/comparator';\r\n\r\nexport default {\r\n\tinitializeRoutes(){\r\n\t\tif (this.initializeRouter()) {\r\n\t\t\tthis._buildRoutes();\r\n\t\t}\r\n\t},\r\n\tinitializeRouter(){\t\t\r\n\t\tif(this.getOption('shouldCreateRouter') && !this.router)\r\n\t\t\tthis.router = this._createRouter();\r\n\r\n\t\treturn !!this.router;\r\n\t},\r\n\t_createRouter(){\r\n\t\tlet Router = this.getOption('Router') || BaseRouter;\r\n\t\tlet options = _.extend({}, this.getOption('routerOptions'));\r\n\t\treturn new Router(options);\r\n\t},\r\n\t_buildRoutes(){\r\n\t\tthis._buildRoutesContexts();\r\n\t\tthis.router.registerPageRoutes(this);\r\n\t},\r\n\t_buildRoutesContexts(){\r\n\t\tlet routes = this.getOption('routes', {args: [this]});\r\n\t\tif (routes == null) return;\r\n\t\tif(_.isString(routes))\r\n\t\t\troutes = [routes];\r\n\r\n\t\tlet result = [];\r\n\t\tlet config = this.getRoutesConfig();\r\n\t\t_(routes).each((route, index) => {\r\n\t\t\tlet context = this._normalizeRoutesContextRoute(route, index, config);\r\n\t\t\t_.isObject(context) && (result.push(context));\r\n\t\t});\r\n\t\tthis.routesContext = result;\r\n\t\treturn this.routesContext;\r\n\t},\r\n\t_normalizeRoutesContextRoute(arg, index, config = {}){\r\n\t\tif(arguments.length < 2){\r\n\t\t\tconfig = this.getRoutesConfig();\r\n\t\t}\r\n\t\tlet context = {};\r\n\t\tif(arg == null)\r\n\t\t\treturn;\r\n\t\tif (_.isString(arg)) {\r\n\t\t\t_.extend(context, {route: arg, rawRoute: arg });\r\n\t\t} else if(_.isFunction(arg)) {\r\n\t\t\targ = arg.call(this, this, index);\r\n\t\t\treturn this._normalizeRoutesContextRoute(arg, index);\r\n\t\t} else {\r\n\t\t\t_.extend(context, arg);\r\n\t\t}\r\n\t\tlet name = (_.isString(index) && index) || context.name || context.route || _.uniqueId('route');\r\n\t\tcontext.name = name;\r\n\r\n\t\tif(_.isNumber(index) && context.order == null)\r\n\t\t\tcontext.order = index;\r\n\r\n\t\tif (!context.rawRoute)\r\n\t\t\tcontext.rawRoute = context.route;\r\n\t\t\t\t\r\n\t\tif(config.relative && config.parentContext)\r\n\t\t\tcontext.route = config.parentContext.route + '/' + context.route;\r\n\r\n\t\treturn context;\r\n\t},\r\n\tgetRoutesConfig(){\r\n\t\tlet config = _.extend({ \r\n\t\t\trelative: this.getOption('relativeRoutes', {args: [this]}),\r\n\t\t\tparent: this.parent,\r\n\t\t\tparentContext: this.parent && _.isFunction(this.parent.getMainRoute) && this.parent.getMainRouteContext()\r\n\t\t}, this.getOption('routesConfig', {args: [this]}));\r\n\r\n\t\treturn config;\r\n\t},\r\n\tgetRoutesContexts(){\r\n\t\treturn this.routesContext || [];\r\n\t},\r\n\r\n\tgetMainRouteContext(){\r\n\t\tif(this.mainRouteContext) return this.mainRouteContext;\r\n\r\n\t\tthis.mainRouteContext = this.getRoutesContexts()\r\n\t\t\t.chain()\r\n\t\t\t.sortBy((a,b) => comparator([ [b,a, c => c.main], [a,b, c => c.order] ]))\r\n\t\t\t.take(1)\r\n\t\t\t.value()[0];\r\n\t\treturn this.mainRouteContext;\r\n\t}\r\n};","import MnObject from '../../mn/object';\r\nimport mix from '../../utils/mix';\r\nimport GetOptionMixin from '../../mixins/common/get-option';\r\nimport StartableMixin from '../../mixins/common/startable';\r\nimport ChildrenableMixin from '../../mixins/common/childrenable';\r\nimport RoutesMixin from './routes-mixin';\r\n\r\nconst BasePage = mix(MnObject).with(GetOptionMixin, ChildrenableMixin, StartableMixin, RoutesMixin);\r\n\r\nexport default BasePage.extend({\r\n\tconstructor(opts = {}){\r\n\t\tBasePage.apply(this, arguments);\r\n\t\tthis.mergeOptions(opts, 'root, parent, router');\r\n\t\t\r\n\t\t//routes-mixin\r\n\t\tthis.initializeRoutes();\r\n\t\t//ChildrenableMixin\r\n\t\tthis.initializeChildren();\r\n\r\n\t},\r\n\tbuildChildOptions(options){\r\n\t\treturn _.extend({\r\n\t\t\troot: this.root,\r\n\t\t\tparent: this.parent,\r\n\t\t\trouter: this.router,\r\n\t\t}, options);\r\n\t},\r\n});\r\n\r\n","import isModel from '../../bb/is-model';\r\nexport default function traverse(fields, root)\r\n{\r\n\troot = root || '';\r\n\tif (this == null || typeof this != 'object') {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar hash = isModel(this) ? this.attributes : this;\r\n\r\n\tvar props = Object.getOwnPropertyNames(hash);\r\n\r\n\tfor (var x = 0; x < props.length; x++) {\r\n\t\tvar name = props[x];\r\n\t\tvar prop = this[name];\r\n\r\n\t\tif (prop == null || typeof prop != 'object' || (prop instanceof Date || prop instanceof Array)) {\r\n\r\n\t\t\tfields[root + name] = prop;\r\n\t\t}\r\n\t\telse if (typeof prop == 'object') {\r\n\r\n\t\t\ttraverse.call(prop, fields, root + name + '.');\r\n\t\t}\r\n\t}\r\n\t\t\r\n}","import traverse from './traverse';\r\n\r\nexport default function flattenObject(obj) {\r\n\tif (obj == null || !_.isObject(obj)) return;\r\n\tvar res = {};\r\n\ttraverse.call(obj, res);\r\n\treturn res;\r\n}","import getProperty from '../get-by-path/get-property';\r\nimport isModel from '../../bb/is-model';\r\nfunction setProperty(context, name, value) {\r\n\tif (isModel(context)) {\r\n\t\tcontext.set(name, value, { silent: true });\r\n\t}\r\n\telse {\r\n\t\tcontext[name] = value;\r\n\t}\r\n\r\n\treturn getProperty(context, name);\r\n}\r\n\r\nexport default setProperty;\r\n","export default function ensureSetByPathArguments(context, path)\r\n{\r\n\tlet errors = [];\r\n\tif (context == null || !_.isObject(context)) {\r\n\t\terrors.push(new Error('Context is not an object'));\r\n\t}\r\n\tif (!_.isString(path) || path === '') {\r\n\t\terrors.push(new Error('Path is not a string'));\r\n\t}\r\n\tif (errors.length) {\r\n\t\treturn errors;\r\n\t}\r\n}\r\n","import getProperty from '../get-by-path/get-property';\r\nimport setProperty from './set-property';\r\nimport ensureArguments from './ensure-arguments';\r\nimport isModel from '../../bb/is-model';\r\nexport default function setByPathArr(context, propertyName, pathArray, value, options) {\r\n\r\n\tlet argumentsErrors = ensureArguments(context, propertyName);\r\n\tif (argumentsErrors) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet modelContext;\r\n\tif (isModel(context)) {\r\n\t\tmodelContext = {\r\n\t\t\tmodel: context,\r\n\t\t\tproperty: propertyName,\r\n\t\t\tpathChunks: [].slice.call(pathArray)\r\n\t\t};\r\n\t}\r\n\r\n\t//set value if this is a last chunk of path\r\n\tif (!pathArray.length) {\r\n\r\n\t\tmodelContext && options.models.push(modelContext);\r\n\r\n\t\treturn setProperty(context, propertyName, value, options);\r\n\r\n\t} else {\r\n\r\n\t\tvar prop = getProperty(context, propertyName);\r\n\r\n\t\tif (!_.isObject(prop) && !options.force) {\r\n\t\t\treturn;\r\n\t\t} else if (!_.isObject(prop) && options.force) {\r\n\t\t\tprop = setProperty(context, propertyName, {}, options);\r\n\t\t} \r\n\r\n\t\tmodelContext && options.models.push(modelContext);\r\n\r\n\t\tvar nextName = pathArray.shift();\t\r\n\t\treturn setByPathArr(prop, nextName, pathArray, value, options);\r\n\r\n\t}\r\n}\r\n","export default function normalizeSetByPathOptions(opts = {}, ext)\r\n{\r\n\r\n\tlet options = _.extend({}, opts, ext, {\r\n\t\tsilent: opts.silent === true,\r\n\t\tforce: opts.force !== false,\r\n\t\t//passPath: [],\r\n\t\tmodels: []\r\n\t});\r\n\r\n\treturn options;\r\n}\r\n","export default function triggerModelEventsOnSetByPath(value, options = {})\r\n{\r\n\tif (options.silent || !options.models.length) {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\t_(options.models).each(context => {\r\n\t\tlet rest = context.pathChunks.join(':');\r\n\t\tif (rest) {\r\n\t\t\tcontext.model.trigger(`change:${context.property}:${rest}`, context.model, value);\r\n\t\t}\r\n\t\tcontext.model.trigger(`change:${context.property}`, context.model, value);\r\n\t\tcontext.model.trigger('change', context.model);\r\n\t});\r\n\r\n\t// //triggering change event on all met models\r\n\t// let originPath = options.pathArray.join(':');\r\n\t// while (options.models.length) {\r\n\t// \tlet modelContext = options.models.pop();\r\n\t// \tlet propertyEventName = modelContext.path == ''\r\n\t// \t\t? originPath\r\n\t// \t\t: originPath.substring(modelContext.path.length + 1);\r\n\r\n\t// \tif (propertyEventName) {\r\n\t// \t\tmodelContext.model.trigger('change:' + propertyEventName, value);\r\n\t// \t}\r\n\t// \tmodelContext.model.trigger('change', modelContext.model);\r\n\t// }\r\n}\r\n","import setByPathArray from './set-by-path-array';\r\nimport normalizeOptions from './normalize-options';\r\nimport triggerModelChangeEvents from './trigger-model-change-events';\r\nimport ensureArguments from './ensure-arguments';\r\nexport default function setByPath(context, path, value, opts = {}) {\r\n\r\n\tlet argumentsErrors = ensureArguments(context, path);\r\n\tif (argumentsErrors) {\r\n\t\treturn value;\r\n\t}\r\n\r\n\tlet pathArray = path.split('.');\t\r\n\tlet options = normalizeOptions(opts, { path, pathArray: [].slice.call(pathArray) });\r\n\r\n\tlet propertyName = pathArray.shift();\r\n\r\n\tlet result = setByPathArray(context, propertyName, pathArray, value, options);\r\n\r\n\tif (result === undefined && value !== undefined) {\r\n\t\treturn value;\r\n\t}\r\n\r\n\ttriggerModelChangeEvents(value, options);\r\n\r\n\treturn value;\r\n\r\n\t// if (_.isObject(path) && !_.isArray(path)) {\r\n\t// \tvalue = path.value;\r\n\t// \toptions.force = path.force !== false;\r\n\t// \toptions.silent = path.silent === true;\r\n\t// \tpath = path.path;\r\n\t// }\r\n\r\n\t// var prop = pathArray.shift();\r\n\r\n\t// if (isModel(context)) {\r\n\t// \toptions.models.push({\r\n\t// \t\tpath: '',\r\n\t// \t\tproperty: prop,\r\n\t// \t\tmodel: context\r\n\t// \t});\r\n\t// }\r\n\r\n}\r\n\r\n\r\n","import setByPath from '../set-by-path';\r\n\r\nexport default function unFlat(obj) {\r\n\r\n\tif (obj == null || !_.isObject(obj)) return;\r\n\tvar res = {};\r\n\tfor (var e in obj) {\r\n\t\tsetByPath(res, e, obj[e]);\r\n\t}\r\n\treturn res;\r\n}\r\n\r\n"],"names":["MnObject","Mn","Object","Model","Collection","View","Router","isKnownCtor","arg","isFn","_","isFunction","result","knownCtors","some","ctor","prototype","betterResult","obj","key","opts","context","args","checkAlso","force","defaultValue","default","isString","value","apply","isObject","alsoOptions","omit","getOption","options","extend","deep","Mixin","Base","defaultGetArguments","defaults","values","keys","split","each","option","undefined","createProcessContext","name","cancelation","promise","Promise","resolve","reject","cancel","uniqueId","camelCase","text","first","splitter","replace","match","prefix","toUpperCase","executingProcessFlagKey","processConcurrencyCheck","processContext","executingKey","previous","concurrent","triggerMethodOn","invokeOnContext","methodName","method","triggerOnContext","eventName","trigger","event","length","triggerBegin","beginError","onBegin","call","triggerBefore","triggerComplete","onComplete","triggerError","errors","isArray","push","onError","isPromisable","then","asArray","getCanNotRunPromise","contextMethod","race","getWaitPromise","promises","all","process","shouldExit","rejectWithError","error","catch","canBeRuned","waitFor","initializeProcess","concurrencyCheck","arguments","_initializeChildrenable","mergeOptions","parent","root","_childrenInitialized","children","_children","_initializeChild","child","Child","invoked","buildChildOptions","getNestedResult","schema","nested","getPropertySchema","model","getDisplayConfig","getPropertyDisplayConfig","display","isModel","getProperty","get","gettingByPath","getByPathArray","propertyName","pathArray","prop","nextName","shift","getByPath","path","slice","originalGet","Mixed","indexOf","size","transform","raw","alternative","ifEmpty","defaultCssConfig","_setupCssClassModifiers","className","_getCssClassString","$el","removeAttr","attr","optsModifiers","propsModifiers","modifiers","concat","_getCssClassModifiers","getCssClassModifiers","classes","map","cls","ready","filter","f","uniq","join","trim","_cssClassModifiersInitialized","cfg","getCssClassConfig","events","getCssClassEvents","on","refreshCssClass","modelChange","listenTo","_getCssClassConfig","refresh","beforeRender","_getCssClassEvents","defaultSelector","defaultUpdateDom","selector","element","$","addClass","append","buildRegionFunc","view","hash","autoCreateRegion","updateDom","el","regionEl","region","getRegion","testEl","find","definition","pick","addRegion","normalizeNestedViewContextRegion","regionName","replaceElement","show","partial","buildRegion","isView","isViewClass","_nestedViews","initializeNestedViews","_nestedViewsInitialized","showAllNestedViews","nesteds","index","addNestedView","normalizeRegion","contexts","getNestedViewContext","Error","_normalizeNestedContext","_createNestedContext","isRendered","showNestedView","getNestedViewRegion","buildNestedView","template","buildNestedViewOptions","triggerControlEvent","control","getControlName","triggerMethod","proxyControlEventToParent","getTriggerValue","getControlValue","convertValue","validate","_triggerControlEvent","type","previousTriggerName","getPreviousTriggerValueKey","JSON","stringify","_isValueAsPrevious","triggerValue","isValueAsPrevious","tryValidateControl","setPreviousTriggerValue","triggerControlInvalid","getParentControl","triggerChildControlEvent","_getOption","getInputType","inputView","valueType","isNumber","isDate","_valueIsNumber","inputType","setInputAttributes","attributes","restrictionKeys","restrictions","key2","ifNull","isChar","ctrlKey","eventContext","prevent","stop","isEnteredCharValid","keyCode","stopPropagation","preventDefault","triggerControlDone","originalEvent","clipboardData","getData","isValueValid","input","select","newvalue","setControlValue","target","toString","handleInputEvent","setInputEvents","passedEvents","eventsArray","eventHandlers","reduce","Memo","toNumber","parseFloat","isNaN","trueValues","falseValues","returnValue","isBoolean","valueOrAlternative","nullable","nullValue","alts","alt","convertToBoolean","other","defaultOptions","strict","returnNullAs","returnEmptyAs","returnNullAndEmptyAs","returnAnyAs","returnOtherAs","toLowerCase","isTrue","isFalse","convertString","toBoolean","ControlMixin","buildRestrictions","attrs","pickNumbers","pickStrings","pickBools","convert","prepareValueBeforeSet","silent","triggerControlChange","len","getMaxLength","substring","num","min","max","getValueType","maxlength","char","parseInt","required","strValue","pattern","RegExp","test","createMixinFromObject","clone","constructor","providedCtor","normalizeArguments","wrap","wrapObjectWithConstructor","merge","mergeObjects","mixins","unshift","withMethod","class","Ctor","mix","_ctor","pstoSetPair","pair","keyvalue","pstoSetKeyValue","decodeURIComponent","paramsToObject","emptyObject","pairs","BaseRouter","BbRouter","with","GetOptionMixin","_onReRouteLast","routes","getInitRoutes","addRoutes","cntrl","approutes","route","create","callback","_normalizeRegisterRouteArguments","_normalizeRegisterRouteContext","_normalizeRegisterRouteCallback","registerRouteContext","_storeCreatedContext","isRouteChaining","normalized","_normalizeRoutes","doNotReverse","reverse","registered","addRoute","massAdd","c","has","isRouterHoldsActions","rawRoute","isRegExp","_routeToRegExp","routeContext","noop","historyRouteCallback","bind","_processCallback","history","routeContexts","fragment","actionContext","_createExecuteActionContext","routeType","lastAttempt","processCallback","resultContext","toPromise","rawArgs","execute","triggerRouteEvents","delegate","catchErrors","ac","lastActionContext","_extractParameters","qs","_prepareActionQueryString","_prepareActionArguments","reroute","newcontext","rawQs","pop","queryStringParser","params","res","paramStringToObject","cntx","page","getRoutesContexts","start","getModel","compareAB","a","b","func","every","getView","comparator","single","initializeRouter","_buildRoutes","router","_createRouter","_buildRoutesContexts","registerPageRoutes","config","getRoutesConfig","_normalizeRoutesContextRoute","routesContext","order","relative","parentContext","getMainRoute","getMainRouteContext","mainRouteContext","chain","sortBy","main","take","BasePage","ChildrenableMixin","StartableMixin","RoutesMixin","initializeRoutes","initializeChildren","traverse","fields","babelHelpers.typeof","props","getOwnPropertyNames","x","Date","Array","flattenObject","setProperty","set","ensureSetByPathArguments","setByPathArr","argumentsErrors","ensureArguments","modelContext","models","normalizeSetByPathOptions","ext","triggerModelEventsOnSetByPath","rest","pathChunks","property","setByPath","normalizeOptions","setByPathArray","unFlat","e"],"mappings":"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"}