{"version":3,"file":"index.js","sources":["vendors/marionette.js","utils/is-known-ctor/ctors.js","utils/is-known-ctor/index.js","utils/better-result/index.js","utils/get-option/index.js","mixins/common/get-option/index.js","utils/mix/options.js","utils/mix/create-mixin-from-object.js","utils/mix/normalize-arguments.js","utils/mix/with.js","vendors/helpers.js","utils/mix/index.js","utils/camel-case/index.js","components/process/register.js","components/process/helpers.js","components/process/index.js","mixins/common/startable/index.js","mixins/common/childrenable/index.js","mixins/model/smart-get/get-nested-result.js","mixins/model/smart-get/get-property-schema.js","mixins/model/smart-get/get-display-config.js","utils/get-by-path/get-property.js","utils/get-by-path/get-by-path-array.js","utils/get-by-path/index.js","mixins/model/smart-get/index.js","mixins/view/css-class-modifiers/index.js","mixins/view/nested-views/build-region.js","mixins/view/nested-views/normalize-region.js","mixins/view/nested-views/index.js","components/view-manager/borrow.js","components/view-manager/collection.js","components/view-manager/common.js","components/view-manager/customs.js","components/view-manager/utils.js","components/view-manager/models.js","components/view-manager/render.js","components/view-manager/empty-view.js","components/view-manager/index.js","mixins/view/next-view/index.js","mixins/controls/control/trigger-control-event.js","mixins/controls/control/get-trigger-value.js","mixins/controls/control/index.js","mixins/controls/input/get-input-type.js","mixins/controls/input/set-attributes.js","mixins/controls/input/events/_get-option.js","mixins/controls/input/events/_is-char.js","mixins/controls/input/events/keydown.js","mixins/controls/input/events/keyup.js","mixins/controls/input/events/paste.js","mixins/controls/input/events/blur.js","mixins/controls/input/events/focus.js","mixins/controls/input/events/input.js","mixins/controls/input/events/index.js","mixins/controls/input/handle-event.js","mixins/controls/input/set-events.js","utils/convert-string/to-number.js","utils/to-bool/options.js","utils/to-bool/index.js","utils/convert-string/index.js","mixins/controls/input/index.js","utils/params-to-object/index.js","components/navigation/router/build-route-context.js","components/navigation/router/action-context.js","components/navigation/router/process-callback.js","components/navigation/route-error-handler/index.js","components/navigation/router/index.js","components/navigation/page/router.js","utils/compare-ab/get-model.js","utils/compare-ab/get-view.js","utils/compare-ab/index.js","utils/comparator/index.js","components/navigation/page/routes-mixin.js","components/navigation/page/index.js","components/navigation/history/index.js","components/navigation/history-watcher/index.js","components/navigation/navigator/index.js","components/bearer-token/index.js","components/store/fake.js","components/store/store.js","components/store/index.js","utils/flat/traverse.js","utils/flat/index.js","utils/has-flag/index.js","utils/set-by-path/set-property.js","utils/set-by-path/ensure-arguments.js","utils/set-by-path/set-by-path-array.js","utils/set-by-path/normalize-options.js","utils/set-by-path/trigger-model-change-events.js","utils/set-by-path/index.js","utils/unflat/index.js"],"sourcesContent":["import Mn, { triggerMethod as _triggerMethod }  from 'backbone.marionette';\r\n\r\nconst MnObject = Mn.Object || Mn.MnObject;\r\n\r\nconst triggerMethod = _triggerMethod || Mn.triggerMethod;\r\n\r\nexport {\r\n\tMnObject,\r\n\ttriggerMethod,\r\n};\r\n","import { Model, Collection, View, Router } from '../../vendors/backbone';\r\nimport { MnObject } from '../../vendors/marionette';\r\nimport Mn from 'backbone.marionette';\r\n\r\nlet ctors = [\r\n\tModel,\r\n\tCollection,\r\n\tView,\r\n\tRouter,\r\n\tMnObject,\r\n];\r\n\r\nlet tryGetFromMn = ['Region', 'Application', 'AppRouter'];\r\n\r\n_.each(tryGetFromMn, ClassName => {\r\n\t_.isFunction(Mn[ClassName]) && ctors.push(Mn[ClassName]);\r\n});\r\n\r\n\r\nexport default ctors;\r\n","import knownCtors from './ctors';\r\n\r\nfunction isKnownCtor(arg) {\r\n\tlet isFn = _.isFunction(arg);\r\n\tlet result = _(knownCtors).some((ctor) => arg === ctor || arg.prototype instanceof ctor);\r\n\treturn isFn && result;\r\n}\r\n\r\nexport default isKnownCtor;\r\n","import isKnownCtor from '../is-known-ctor';\r\nexport default function betterResult(obj, key, opts = {})\r\n{\r\n\tlet { context, args, checkAlso, force } = opts;\r\n\tlet defaultValue = opts.default;\r\n\r\n\tif(!_.isString(key) || key === '') return;\r\n\t\r\n\tlet value = (obj || {})[key];\r\n\r\n\tif (value != null && (!_.isFunction(value) || isKnownCtor(value)))\r\n\t\treturn value;\r\n\t\t\r\n\tlet result = force !== false && _.isFunction(value) ? value.apply(context || obj, args) : value;\r\n\r\n\tif (result == null && _.isObject(checkAlso)) {\r\n\t\tlet alsoOptions = _.omit(opts, 'checkAlso');\r\n\t\tresult = betterResult(checkAlso, key, alsoOptions);\r\n\t}\r\n\r\n\tif (result == null && defaultValue != null )\r\n\t\tresult = defaultValue;\r\n\r\n\treturn result;\r\n}\r\n","import result from '../better-result';\r\n\r\nexport default function getOption(context, key, opts, also) {\r\n\r\n\tif(_.isObject(key) && _.isString(opts)){\r\n\t\tlet _opts = also;\r\n\t\talso = key;\r\n\t\tkey = opts;\r\n\t\topts = _opts;\r\n\t}\r\n\r\n\tlet options = _.extend({ args:[context], context }, opts, { default: null });\r\n\tlet { deep } = options;\r\n\tlet defaultValue = opts && opts.default;\r\n\r\n\tlet value = result(context.options || also, key, options);\r\n\tif (value == null && deep !== false) {\r\n\t\tvalue = result(context, key, options);\r\n\t}\r\n\t\r\n\treturn value != null ? value : defaultValue;\r\n\r\n}\r\n","import result from '../../../utils/better-result';\r\nimport getOption from '../../../utils/get-option';\r\n\r\nconst Mixin = (Base) => Base.extend({\r\n\r\n\t//property first approach\r\n\tgetProperty(key, opts){\r\n\t\t\r\n\t\tlet defaultGetArguments = result(this, '_getPropertyArguments', { args:[this], default:[this] });\r\n\t\tlet options = _.extend({\r\n\t\t\tdeep: Mixin.defaults.deep,\r\n\t\t\tforce: Mixin.defaults.force,\r\n\t\t\targs: defaultGetArguments\r\n\t\t}, opts, {\r\n\t\t\tcontext: this,\r\n\t\t});\r\n\t\tlet { deep } = options;\r\n\r\n\t\tlet value = result(this, key, options);\r\n\t\tif (value == null && deep !== false) {\r\n\t\t\tvalue = result(this.options, key, options);\r\n\t\t}\r\n\t\treturn value;\r\n\t},\r\n\r\n\t//options first approach\r\n\tgetOption(key, opts){\r\n\t\tlet defaultGetArguments = result(this, '_getOptionArguments', { args:[this], default:[this] });\r\n\t\tlet options = _.extend({\r\n\t\t\tdeep: Mixin.defaults.deep,\r\n\t\t\tforce: Mixin.defaults.force,\r\n\t\t\targs: defaultGetArguments\r\n\t\t}, opts);\r\n\r\n\t\treturn getOption(this, key, options);\r\n\t},\r\n\r\n\tmergeOptions(values = {}, keys = [], opts = {}){\r\n\t\t\r\n\t\tif(_.isString(keys))\r\n\t\t\tkeys = keys.split(/\\s*,\\s*/);\r\n\r\n\t\t_.each(keys, (key) => {\r\n\t\t\tconst option = result(values, key, _.extend({ force: false }, opts));\r\n\t\t\tif (option !== undefined) {\r\n\t\t\t\tthis[key] = option;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n}, {\r\n\tGetOptionMixin:true\r\n});\r\n\r\nMixin.defaults = {\r\n\tdeep: true,\r\n\tforce: true\r\n};\r\n\r\nexport default Mixin;\r\n","export default {\r\n\tmergeObjects: true,\r\n\twrapObjectWithConstructor: true,\r\n};\r\n","export default function createMixinFromObject(arg) {\r\n\tlet mixedObj = _.clone(arg);\r\n\tlet mixedCtor = _.isFunction(mixedObj.constructor) && mixedObj.constructor;\r\n\treturn Base => { \r\n\t\tif (_.isFunction(mixedCtor)) {\r\n\t\t\t//let providedCtor = ((mixed) => mixed)(obj.constructor);\r\n\t\t\tmixedObj.constructor = function mx(){\r\n\t\t\t\tBase.apply(this, arguments);\r\n\t\t\t\tmixedCtor.apply(this, arguments);\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn Base.extend(mixedObj);\r\n\t};\r\n}\r\n","\r\nimport createMixinFromObject from './create-mixin-from-object';\r\n\r\nexport default function normalizeArguments(args, opts = {}) {\r\n\tlet raw = {};\r\n\tlet wrap = opts.wrapObjectWithConstructor == true;\r\n\tlet merge = opts.mergeObjects == true;\r\n\tlet mixins = [];\r\n\t_(args).each(arg => {\r\n\t\t\r\n\t\t//if argument is function just put it to mixins array\r\n\t\t//and continue;\r\n\t\tif (_.isFunction(arg)) {\r\n\t\t\tmixins.push(arg);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//if argument is not an object just skip it\r\n\t\tif (!_.isObject(arg)) return;\r\n\r\n\t\t//if mergeObjects == false or wrapObjectWithConstructor == true \r\n\t\t//and there is a constructor function\r\n\t\t//converting to a mixin function\r\n\t\t//otherwise extend rawObject\r\n\t\tif (!merge || (wrap && _.isFunction(arg.constructor))) {\r\n\t\t\tmixins.push(createMixinFromObject(arg));\r\n\t\t} \r\n\t\telse {\r\n\t\t\t_.extend(raw, arg);\r\n\t\t}\r\n\t\r\n\t});\r\n\r\n\t//if rawObject is not empty\r\n\t//convert it to a mixin function\r\n\t//and put it to the begin of mixins array\r\n\tif (_.size(raw))\r\n\t\tmixins.unshift(createMixinFromObject(raw));\r\n\r\n\treturn mixins;\r\n}\r\n","\r\n\r\nimport normalizeArguments from './normalize-arguments';\r\n\r\nexport default function withMethod(...args) {\r\n\r\n\tlet mixins = normalizeArguments(args, this.options);\r\n\tlet Mixed = this.class;\r\n\tif (!mixins.length) return Mixed;\r\n\telse\r\n\t\treturn _.reduce(mixins, (Memo, Ctor) => { \r\n\t\t\tlet mixed = Ctor(Memo);\r\n\t\t\treturn mixed;\r\n\t\t}, Mixed);\r\n\r\n}\r\n","import { Model, Collection, View } from './backbone';\r\nimport { triggerMethod } from './marionette';\r\n\r\nexport function isClass(arg, Base){\r\n\treturn _.isFunction(arg) && (arg == Base || arg.prototype instanceof Base);\r\n}\r\n\r\n\r\nexport function isModel(arg){\r\n\treturn arg instanceof Model;\r\n}\r\nexport function isModelClass(arg) {\r\n\treturn isClass(arg, Model);\r\n}\r\n\r\n\r\nexport function isCollection(arg){\r\n\treturn arg instanceof Collection;\r\n}\r\nexport function isCollectionClass(arg) {\r\n\treturn isClass(arg, Collection);\r\n}\r\n\r\n\r\nexport function isView(arg){\r\n\treturn arg instanceof View;\r\n}\r\n\r\n\r\nexport function isViewClass(arg) {\r\n\treturn isClass(arg, View);\r\n}\r\n\r\n\r\nexport function triggerMethodOn(context, ...args) {\r\n\tif (_.isFunction(context.triggerMethod)) {\r\n\t\treturn context.triggerMethod.apply(context, args);\r\n\t}\r\n\r\n\treturn triggerMethod.apply(context, args);\r\n\t\r\n}\r\n\r\nexport const extend = Model.extend;\r\n","import defaultOptions from './options';\r\nimport withMethod from './with';\r\n\r\nimport extend from '../extend';\r\n\r\n\r\n\r\nexport default function mix(_ctor, options) {\r\n\r\n\tlet opts = _.extend({}, defaultOptions, options);\r\n\r\n\tlet ctor;\r\n\r\n\tif (_.isFunction(_ctor)) {\r\n\t\tctor = _ctor;\r\n\t}\r\n\telse if (_.isObject(_ctor)) {\r\n\t\tlet b = _.isFunction(_ctor.constructor) && _ctor.constructor;\r\n\t\tctor = function mx() { b.apply(this, arguments); };\r\n\t\t_.extend(ctor.prototype, _.omit(_ctor,'constructor'));\r\n\r\n\t} else {\r\n\t\tthrow new Error('Mix argument should be a class or a plain object');\r\n\t}\r\n\r\n\tif (!_.isFunction(ctor.extend))\r\n\t\tctor.extend = extend;\r\n\r\n\treturn {\r\n\t\toptions: opts,\r\n\t\twith: withMethod,\r\n\t\tclass: ctor,\r\n\t};\r\n}\r\n","// camelCase('asd:qwe:zxc') -> asdQweZxc\r\n// camelCase('asd:qwe:zxc', true) -> AsdQweZxc\r\nexport default function camelCase(text, first) {\r\n\tif (!_.isString(text)) return text;\r\n\tvar splitter = first === true ? /(^|:)(\\w)/gi : /(:)(\\w)/gi;\r\n\ttext = text.replace(splitter, (match, prefix, text) => text.toUpperCase());\r\n\tif(!first)\r\n\t\ttext = text.replace(/(^)(\\w)/gi, (match, prefix, text) => text.toLowerCase());\r\n\treturn text;\r\n}","\r\nexport default function (Process, context, name, opts) {\r\n\r\n\tcontext[name] = function(...args){\r\n\t\t\r\n\t\tlet process = new Process(context, name, _.extend({}, opts));\r\n\t\tlet concurrent = process.concurrencyCheck();\r\n\r\n\t\tif (concurrent)\r\n\t\t\treturn concurrent;\r\n\t\telse\r\n\t\t\treturn process.run(...args);\r\n\r\n\t};\r\n\r\n}\r\n","export function isPromisable(arg){\r\n\treturn arg instanceof Promise || _.isFunction(arg && arg.then);\r\n}\r\n\r\nexport function asArray(arg) {\r\n\tif(_.isArray(arg))\r\n\t\treturn arg;\r\n\telse if(arg == null || arg === '')\r\n\t\treturn [];\r\n\telse\r\n\t\treturn [arg];\r\n}\r\n\r\nexport function race(...promises){\r\n\treturn Promise.race(promises);\r\n}\r\n\r\nexport function valueToPromise(arg){\r\n\tif(!isPromisable(arg)) {\r\n\t\tlet result = arg;\r\n\t\targ = arg == null || arg === '' ? Promise.resolve() : Promise.reject(result);\r\n\t}\r\n\treturn arg;\t\t\r\n}\r\n","import mix from '../../utils/mix';\r\nimport { triggerMethodOn } from '../../vendors/helpers';\r\nimport camelCase from '../../utils/camel-case';\r\nimport result from '../../utils/better-result';\r\nimport register from './register';\r\n\r\nimport { isPromisable, race, asArray, valueToPromise } from './helpers';\r\n\r\nconst Process = mix({\r\n\tconstructor: function Process(context, name, opts){\r\n\t\tthis._initDefaults(name, context);\r\n\t\tthis._initCancelation();\r\n\t\tthis._mergeOptions(opts);\r\n\t},\r\n\r\n\r\n\t// initialize methods\r\n\r\n\t_initDefaults(name, context){\r\n\t\tif(name == null || name === '')\r\n\t\t\tthrow new Error('Process requires two arguments: name [string], context [object]. name missing');\r\n\t\t\r\n\t\tif(!_.isObject(context))\r\n\t\t\tthrow new Error('Process requires two arguments: name [string], context [object]. context is not an object');\r\n\r\n\t\tthis.cid = _.uniqueId('process');\r\n\t\tthis.name = name;\r\n\t\tthis.context = context;\r\n\t\tthis.errors = [];\r\n\t},\r\n\r\n\t_initCancelation(){\r\n\t\tthis.cancelPromise = new Promise((resolve, reject) => {\r\n\t\t\tthis.cancel = () => reject('cancel'); \r\n\t\t});\r\n\t},\r\n\t_mergeOptions(opts = {}){\r\n\t\tlet options = _.omit(opts, 'cid', 'name', 'context', 'cancelPromise', 'cancel', 'errors');\r\n\t\t_(options).each((value, key) => this[key] = value);\r\n\t},\r\n\r\n\t\r\n\tconcurrencyCheck(){\r\n\r\n\t\tlet previous = this.getProcessFromContext();\r\n\t\t//console.log(previous, this.context);\r\n\t\tif(!previous) return;\r\n\t\r\n\t\tlet concurrent = this.concurrent;\t\r\n\t\t\r\n\t\tif (concurrent === false) {\r\n\t\r\n\t\t\tthis.cancel();\r\n\t\r\n\t\t} else if (concurrent == 'first') {\r\n\t\r\n\t\t\treturn previous.promise;\r\n\t\r\n\t\t} else if (concurrent == 'last') {\r\n\t\r\n\t\t\tprevious.cancel();\r\n\t\r\n\t\t}\t\t\r\n\t},\r\n\r\n\r\n\t// life cycle methods\t\r\n\r\n\trun(...args){\r\n\t\tthis.updateProcessInContext(this);\r\n\t\tthis.args = args || [];\r\n\t\tthis.promise = this._createLifeCyclePromise();\r\n\t\treturn this.promise;\r\n\t},\r\n\r\n\r\n\t_createLifeCyclePromise(){\r\n\r\n\r\n\t\treturn this._notCanceled()\r\n\t\t\t.then(() => this._begin())\r\n\t\t\t.then(() => this._beforeStart())\r\n\t\t\t.then(() => this._canBeStarted())\r\n\t\t\t.then(() => this._waitOtherPromises())\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.triggerComplete();\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tthis.triggerError(error);\r\n\t\t\t\tlet jsError;\r\n\t\t\t\tif(error instanceof Error) {\r\n\t\t\t\t\tthrow error;\r\n\t\t\t\t} else if ((jsError = this.getJsError())) {\r\n\t\t\t\t\tthrow jsError;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn Promise.reject(this);\r\n\t\t\t\t}\r\n\t\t\t});\t\t\r\n\t},\r\n\r\n\r\n\r\n\r\n\t_notCanceled() {\r\n\t\treturn this._cancelationRace(Promise.resolve());\r\n\t},\r\n\t_begin(){\r\n\t\treturn this._getHookResultAsPromise('begin');\r\n\t},\r\n\t_beforeStart(){\r\n\t\treturn this._getHookResultAsPromise('before');\r\n\t},\r\n\t_canBeStarted(){\r\n\t\tlet contextMethod = 'can:not:' + this.name;\r\n\t\tlet promise = this.invokeOnContext(contextMethod);\r\n\t\tif(!isPromisable(promise)) {\r\n\t\t\tpromise = (promise == null || promise === '') \r\n\t\t\t\t? Promise.resolve()\r\n\t\t\t\t: Promise.reject(promise);\r\n\t\t}\r\n\t\treturn this._cancelationRace(promise);\r\n\t},\r\n\t_waitOtherPromises(){\r\n\t\tlet contextMethod = `get:${this.name}:promises`;\r\n\t\t\r\n\t\tlet promises = asArray(this.invokeOnContext(contextMethod));\r\n\r\n\t\treturn this._cancelationRace(Promise.all(promises));\r\n\t},\r\n\r\n\t_getHookResultAsPromise(hookName){\r\n\t\tlet procMethod = camelCase('on:' + hookName);\r\n\t\tlet procHook = _.isFunction(this[procMethod]) && this[procMethod](this.context, ...this.args) || undefined;\r\n\t\tlet result = valueToPromise(procHook).then(() => {\r\n\t\t\tlet cntxHook = this.triggerOnContext(hookName);\r\n\t\t\treturn valueToPromise(cntxHook);\r\n\t\t});\r\n\r\n\t\treturn this._cancelationRace(result);\r\n\r\n\t},\r\n\r\n\t// trigger methods\r\n\r\n\ttriggerComplete() { \r\n\r\n\t\tthis.updateProcessInContext(null);\r\n\r\n\t\tif (_.isFunction(this.onComplete))\r\n\t\t\tthis.onComplete(this.context, ...this.args);\r\n\r\n\t\tthis.triggerOnContext();\r\n\r\n\t\tthis.triggerEnd();\r\n\t\t\r\n\t\r\n\t},\r\n\ttriggerError(errors){\r\n\r\n\r\n\t\tthis.updateProcessInContext(null);\t\t\r\n\r\n\t\tif(!_.isArray(errors))\r\n\t\t\terrors = [errors];\r\n\r\n\t\tthis.errors.push(...errors);\r\n\r\n\t\t\r\n\t\tif (_.isFunction(this.onError))\r\n\t\t\tthis.onError(this.context, ...this.errors);\r\n\t\t\r\n\t\tthis.triggerOnContext('error', ...this.errors);\r\n\t\t\r\n\t\tthis.triggerEnd();\r\n\r\n\t\t\r\n\t},\r\n\ttriggerEnd(){\r\n\t\tthis.triggerOnContext('end');\r\n\t},\r\n\r\n\r\n\r\n\t// helpers methods\r\n\r\n\tgetJsError(context){\r\n\t\t!context && (context = this);\r\n\t\tif(context != this && (!_.isObject(context) || !_.isArray(context.errors)))\r\n\t\t\treturn;\r\n\r\n\t\treturn _(context.errors).filter(f => f instanceof Error)[0];\r\n\t},\t\r\n\r\n\t_cancelationRace(promise){\r\n\t\treturn race(this.cancelPromise, promise);\r\n\t},\r\n\r\n\r\n\tgetContextProcessKey(){\r\n\t\treturn camelCase(`_process:${this.name}:executing`);\r\n\t},\r\n\tgetProcessFromContext(){\r\n\t\tlet key = this.getContextProcessKey();\r\n\t\treturn this.context[key];\r\n\t},\r\n\tupdateProcessInContext(process){\r\n\t\tlet key = this.getContextProcessKey();\t\t\r\n\t\tthis.context[key] = process;\r\n\t},\r\n\r\n\r\n\r\n\ttriggerOnContext (eventName) {\r\n\t\r\n\t\tlet context = this.context; \r\n\t\tif(!_.isFunction(context.trigger))\r\n\t\t\treturn;\r\n\t\t\r\n\t\tlet event = (eventName ? eventName + ':' : '') + this.name;\r\n\t\t\r\n\t\treturn triggerMethodOn(context, event, this, ...this.args);\r\n\t\r\n\t},\r\n\r\n\tinvokeOnContext(methodName)\r\n\t{\r\n\t\tlet method = camelCase(methodName);\r\n\t\tlet context = this.context;\r\n\t\tlet args = this.args;\r\n\t\treturn result(context, method, { args });\r\n\r\n\t}\r\n\r\n}).class;\r\n\r\n\r\nProcess.register = function(context, name, opts) {\r\n\treturn register(this, context, name, opts);\r\n};\r\n\r\nexport default Process;\r\n","import Process from '../../../components/process';\r\n\r\n\r\nconst defaultStartableOptions  = {\r\n\tconcurrent: false,\r\n\r\n\t//good place to supply own state collecting logic\r\n\tstoreState(){\r\n\r\n\t\tthis.contextState = [{\r\n\t\t\tkey: 'startable.status',\r\n\t\t\tvalue: this.context['startable.status']\r\n\t\t}];\r\n\r\n\r\n\t\t/*\r\n\r\n\t\tfor example: take all simple values from context\r\n\r\n\t\tfor(var key in this.context){\r\n\t\t\tlet value = this.context[key];\r\n\t\t\tif (value == null || !_.isObject(value.valueOf()))\r\n\t\t\t\tthis.contextState.push({ key, value });\r\n\t\t}\r\n\r\n\t\t*/\r\n\r\n\t},\r\n\trestoreState(){\r\n\t\t_(this.contextState || []).each(keyValue => {\r\n\t\t\tthis.context[keyValue.key] = keyValue.value;\r\n\t\t});\r\n\t},\r\n\tonBefore(...args){\r\n\t\tthis.storeState();\r\n\t\tthis.ensureState();\r\n\t\tthis.context['startable.status'] = this.processingName;\r\n\t\tthis.context['startable.start.lastArguments'] = args;\r\n\t},\r\n\tonComplete(){\r\n\t\tthis.context['startable.status'] = this.processedName;\r\n\t},\t\r\n\tonError(){\r\n\t\tthis.restoreState();\r\n\t},\r\n\tensureState(shouldThrow = true){\r\n\t\tlet other = this.name == 'start' ? 'stop' : 'start';\r\n\t\tlet error = this.name == 'start' ? 'not:stopped' : 'not:started';\r\n\t\tlet status = this.context['startable.status'];\r\n\t\tswitch(status){\r\n\t\tcase 'stopping':\r\n\t\tcase 'starting':\r\n\t\t\tif(shouldThrow) throw new Error('not:iddle');\r\n\t\t\telse return 'not:iddle';\r\n\t\tcase 'iddle':\r\n\t\t\tif(this.name == 'start') return;\r\n\t\t\telse if(shouldThrow) throw new Error(error);\r\n\t\t\telse return error;\r\n\t\tcase other:\r\n\t\t\tif(shouldThrow) throw new Error(error);\r\n\t\t\telse return error;\t\t\t\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst defaultStartOptions  = {\r\n\tprocessingName: 'starting',\r\n\tprocessedName: 'started'\r\n};\r\nconst defaultStopOptions  = {\r\n\tprocessingName: 'stopping',\r\n\tprocessedName: 'stopped'\r\n};\r\n\r\nexport default Base => Base.extend({\r\n\tconstructor(){\r\n\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis._initializeStartable();\r\n\r\n\t},\r\n\t'startable.status': 'iddle',\r\n\t_initializeStartable(){\r\n\r\n\t\tlet startable = _.extend({}, defaultStartableOptions, this.getOption('startableOptions', {args:[this]}));\r\n\r\n\t\tlet start = _.extend({}, startable, defaultStartOptions, this.getOption('startOptions', {args:[this]}));\r\n\t\tlet stop = _.extend({}, startable, defaultStopOptions, this.getOption('stopOptions', {args:[this]}));\r\n\r\n\t\tProcess.register(this, 'start', start);\r\n\t\tProcess.register(this, 'stop', stop);\r\n\r\n\t},\r\n\tisStarted(){\r\n\t\treturn this['startable.status'] === 'started';\r\n\t},\r\n\tisStopped(){\r\n\t\treturn this['startable.status'] === 'stopped' || this['startable.status'] === 'iddle';\r\n\t},\r\n\tisNotIddle(){\r\n\t\treturn this['startable.status'] === 'stopping' || this['startable.status'] === 'starting';\r\n\t},\r\n\trestart(){\r\n\t\tif(this.isNotIddle())\r\n\t\t\tthrow new Error('Restart not allowed while startable instance is not iddle: ', this['startable.status']);\r\n\t\tlet stop = this.isStarted() ? this.stop() : Promise.resolve();\r\n\t\tlet args = this['startable.start.lastArguments'] || [];\r\n\t\treturn stop.then(() => this.start(...args));\r\n\t}\r\n}, {\r\n\tStartable: true\r\n});\r\n","import isKnownCtor from '../../../utils/is-known-ctor';\r\n\r\nexport default Base => Base.extend({\r\n\r\n\tconstructor(opts){\r\n\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis._initializeChildrenable(opts);\r\n\r\n\t},\r\n\t_initializeChildrenable(opts){\r\n\t\tthis.mergeOptions(opts, ['parent', 'root']);\r\n\t\tif (this.parent == null && this.root == null) \r\n\t\t\tthis.root = this;\r\n\t},\r\n\r\n\t//call this method manualy for initialize children\r\n\tinitializeChildren(){\r\n\t\tif (this._childrenInitialized) return;\r\n\r\n\t\tlet children = this.getOption('children');\r\n\t\tthis._children = [];\r\n\t\t_(children).each(child => this._initializeChild(child));\r\n\r\n\t\tthis._childrenInitialized = true;\r\n\r\n\t},\r\n\r\n\t_initializeChild(arg){\r\n\t\tlet Child;\r\n\t\tlet options = {};\r\n\r\n\t\tif (isKnownCtor(arg))\r\n\t\t\tChild = arg;\r\n\t\telse if(_.isFunction(arg)){\r\n\t\t\t\r\n\t\t\tlet invoked = arg.call(this, this);\r\n\t\t\treturn this._initializeChild(invoked);\r\n\r\n\t\t} else if (_.isObject(arg)) {\r\n\t\t\tChild = arg.Child;\r\n\t\t\t_.extend(options, _.omit(arg, 'Child'));\r\n\t\t}\r\n\r\n\t\t//if (!isKnownCtor(arg)) return;\r\n\r\n\t\t_.extend(options, this.getOption('childOptions'), { parent: this });\r\n\t\toptions = this.buildChildOptions(options);\r\n\t\t\r\n\t\tlet child = this.buildChild(Child, options);\r\n\t\tthis._children.push(child);\r\n\r\n\t},\r\n\r\n\tbuildChildOptions(options){\r\n\t\treturn options;\r\n\t},\r\n\tbuildChild(Child, options){\r\n\t\t!Child && (Child = this.getOption('defaultChildClass') || this.prototype.constructor);\r\n\t\treturn new Child(options);\r\n\t},\r\n\t_getChildren(items, opts = {}){\r\n\t\tlet { exclude, filter, map } = opts;\r\n\r\n\t\tif(exclude != null && !_.isArray(exclude))\r\n\t\t\topts.exclude = [exclude];\r\n\r\n\t\tif(!_.isFunction(filter))\r\n\t\t\tdelete opts.filter;\r\n\r\n\t\tlet result = [];\r\n\t\t_(items).each((item, index) => {\r\n\r\n\t\t\tif(!this._childFilter(item, index, opts))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif(_.isFunction(map))\r\n\t\t\t\titem = map(item);\r\n\r\n\t\t\titem && result.push(item);\r\n\t\t});\r\n\t\treturn result;\r\n\t},\r\n\t_childFilter(item, index, opts = {}){\r\n\t\t\r\n\t\tif(opts.force) return item;\r\n\r\n\t\tlet { exclude, filter } = opts;\r\n\r\n\t\tif(_.isFunction(this.childFilter) && !this.childFilter(item, index, opts))\r\n\t\t\treturn;\r\n\r\n\t\tif(_.isArray(exclude) && exclude.indexOf(item) >= 0)\r\n\t\t\treturn;\r\n\r\n\t\tif(_.isFunction(filter) && !filter.call(this, item, index, opts))\r\n\t\t\treturn;\r\n\r\n\t\treturn item;\r\n\t},\r\n\tchildFilter: false,\r\n\tgetChildren(opts = {}){\r\n\t\tlet children = [].slice.call(this._children || []);\r\n\t\topts.reverse && children.length > 1 && children.reverse();\t\t\r\n\t\treturn this._getChildren(children, opts);\r\n\t},\r\n\tgetAllChildren(opts = {}){\r\n\r\n\t\tlet { includeSelf, map, reverse } = opts;\r\n\t\tlet options = _.omit(opts, 'includeSelf', 'map');\r\n\r\n\r\n\t\tlet children = this.getChildren(options);\r\n\t\tlet result = _(children).chain()\r\n\t\t\t.map(child => {\r\n\t\t\t\tlet children = child.getAllChildren(options);\r\n\t\t\t\treturn reverse ? [children, child] : [child, children];\r\n\t\t\t})\r\n\t\t\t.flatten()\r\n\t\t\t.value();\r\n\r\n\t\tif (includeSelf) {\r\n\t\t\tlet method = reverse ? 'push' : 'unshift';\r\n\t\t\tresult[method](this);\r\n\t\t}\r\n\t\t\r\n\t\tif (_.isFunction(map)) {\r\n\t\t\treturn _(result).chain().map(map).filter(f => !!f).value();\r\n\t\t} else {\t\t\t\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetParent(){\r\n\t\treturn this.parent;\r\n\t}\r\n\r\n\r\n\r\n});\r\n","export default function getNestedResult(value, context, schema) {\r\n\treturn value != null \r\n\t\t&& _.isFunction(schema.nested) \r\n\t\t&& schema.nested(value, context);\r\n}","export default function getPropertySchema(model, key)\r\n{\r\n\tif (_.isFunction(model.getPropertySchema)) {\r\n\t\treturn model.getPropertySchema(key);\r\n\t} else {\r\n\t\treturn {};\r\n\t}\r\n}","export default function getDisplayConfig(key, model, schema){\r\n\tif (key == null) return {};\r\n\treturn (_.isFunction(model.getPropertyDisplayConfig) && model.getPropertyDisplayConfig(key))\r\n\t\t|| (schema && schema.display) || {};\r\n}","import { isModel } from '../../vendors/helpers';\r\nfunction getProperty(context, name)\r\n{\r\n\tif(context == null || !_.isObject(context) || name == null || name == '') return;\r\n\tif (isModel(context))\r\n\t\treturn context.get(name, { gettingByPath: true  });\r\n\telse\r\n\t\treturn context[name];\r\n}\r\nexport default getProperty;\t\r\n","\r\nimport getProperty from './get-property';\r\n\r\nfunction getByPathArray(context, propertyName, pathArray) {\r\n\t\r\n\tif (context == null || !_.isObject(context) || propertyName == null || propertyName == '')\r\n\t\treturn;\r\n\r\n\tvar prop = getProperty(context, propertyName);\r\n\r\n\tif (!pathArray.length || (pathArray.length && prop == null))\r\n\t\treturn prop;\r\n\r\n\tvar nextName = pathArray.shift();\r\n\r\n\treturn getByPathArray(prop, nextName, pathArray);\r\n\r\n}\r\n\r\nexport default getByPathArray;\r\n","import getByPathArray from './get-by-path-array';\r\n\r\nexport default function getByPath(obj, path) {\r\n\r\n\tif (obj == null || !_.isObject(obj) || path == null || path == '') return;\r\n\r\n\tvar pathArray = _.isString(path) ? path.split('.')\r\n\t\t: _.isArray(path) ? [].slice.call(path)\r\n\t\t\t: [path];\r\n\r\n\tvar prop = pathArray.shift();\r\n\r\n\treturn getByPathArray(obj, prop, pathArray);\r\n\r\n}\r\n","import { Model } from '../../../vendors/backbone';\r\nimport getNestedResult from './get-nested-result';\r\nimport getPropertySchema from './get-property-schema';\r\nimport getDisplayConfig from './get-display-config';\r\nimport getByPath from '../../../utils/get-by-path';\r\nexport default Base => {\r\n\tconst originalGet = Model.prototype.get;\r\n\tconst Mixed = Base.extend({\r\n\t\tgetByPath(key){\r\n\t\t\tif(key.indexOf('.') > -1)\r\n\t\t\t\treturn getByPath(this, key);\r\n\t\t\telse\r\n\t\t\t\treturn originalGet.call(this, key);\r\n\t\t},\r\n\t\tget(key, opts = {}){\r\n\t\t\tif(key == null || key == '') return;\t\r\n\t\t\t\r\n\t\t\tlet value = 'value' in opts \r\n\t\t\t\t? opts.value\r\n\t\t\t\t: this.getByPath.call(this, key);\r\n\r\n\t\t\tif (!_.size(opts)) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\r\n\t\t\tlet prop = getPropertySchema(this, key);\r\n\t\t\tlet result = opts.nested && getNestedResult(value, this, prop);\r\n\t\t\tif (result != null) {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\r\n\t\t\tif(_.isFunction(opts.transform) && !opts.raw) {\r\n\t\t\t\tvalue = opts.transform.call(this, value, opts, this);\r\n\t\t\t}\r\n\r\n\t\t\tif(_.isFunction(prop.transform) && !opts.raw){\r\n\t\t\t\tvalue = prop.transform.call(this, value, opts, this);\r\n\t\t\t}\r\n\r\n\t\t\tif(opts.display === true){\r\n\r\n\t\t\t\tlet display = getDisplayConfig(key, this, prop);\r\n\r\n\t\t\t\tif(opts.alternative){\r\n\t\t\t\t\tvalue = _.isFunction(display.alternative) && display.alternative.call(this, value, _.extend({},opts,prop), this);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_.isFunction(display.transform)) {\r\n\t\t\t\t\tvalue = display.transform.call(this, value, opts, this);\r\n\t\t\t\t}\r\n\t\t\t\tif(display.ifEmpty && (value == null || value === ''))\r\n\t\t\t\t\treturn display.ifEmpty;\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tdisplay(key, opts = {}){\r\n\t\t\t_.extend(opts, { display:true });\r\n\t\t\treturn this.get(key, opts);\r\n\t\t},\r\n\t\tpropertyName(key) {\r\n\t\t\tlet prop = getPropertySchema(this, key);\r\n\t\t\tlet display = getDisplayConfig(key, this, prop);\r\n\t\t\treturn display.label || key;\r\n\t\t}\r\n\t});\r\n\r\n\treturn Mixed;\r\n};\r\n","\r\nconst defaultCssConfig = {\r\n\tbeforeRender: true,\r\n\tmodelChange: true,\r\n\trefresh: true,\r\n};\r\n\r\nexport default (Base) => Base.extend({\r\n\tconstructor(){\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis._setupCssClassModifiers();\t\t\r\n\t},\r\n\r\n\trefreshCssClass(){\r\n\t\tlet className = this._getCssClassString();\r\n\t\tif(className == ''){\r\n\t\t\tthis.$el.removeAttr('class');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.$el.attr({\r\n\t\t\t\tclass: className\r\n\t\t\t});\r\n\t\t}\r\n\t},\t\r\n\r\n\t_getCssClassModifiers(){\r\n\t\tlet optsModifiers = this.getOption('cssClassModifiers',{deep:false, args:[this.model, this]});\r\n\t\tlet propsModifiers = this.getProperty('cssClassModifiers',{deep:false, args:[this.model, this]});\r\n\t\tlet modifiers = [this.getOption('className')].concat(optsModifiers || [], propsModifiers || []);\r\n\t\treturn modifiers;\r\n\t},\r\n\t//override this if you need other logic\r\n\tgetCssClassModifiers(){\r\n\t\treturn this._getCssClassModifiers();\r\n\t},\r\n\t_getCssClassString()\r\n\t{\r\n\t\tlet modifiers = this.getCssClassModifiers();\r\n\t\tlet classes = _(modifiers).map((cls) => {\r\n\t\t\treturn _.isString(cls) \r\n\t\t\t\t? cls \r\n\t\t\t\t: _.isFunction(cls) \r\n\t\t\t\t\t? cls.call(this, this.model, this) \r\n\t\t\t\t\t: null;\r\n\t\t});\r\n\t\tlet ready = _(classes).filter((f) => f != null && f != '');\r\n\t\tlet className = _.uniq(ready).join(' ');\r\n\t\treturn (className || '').trim();\r\n\t},\r\n\r\n\t_setupCssClassModifiers(){\r\n\r\n\t\tif(this._cssClassModifiersInitialized) return;\r\n\r\n\t\tlet cfg = this.getCssClassConfig();\r\n\t\tif(!cfg) return;\r\n\r\n\t\tlet events = this.getCssClassEvents(cfg);\r\n\t\t_(events).each((eventName) => this.on(eventName, this.refreshCssClass));\r\n\r\n\t\tif (cfg.modelChange && this.model) {\r\n\t\t\tthis.listenTo(this.model, 'change', this.refreshCssClass);\r\n\t\t}\r\n\r\n\t\tthis._cssClassModifiersInitialized = true;\r\n\t},\r\n\t\r\n\t_getCssClassConfig(){\r\n\t\tlet cfg = _.extend({}, defaultCssConfig, this.getOption('cssClassConfig'));\r\n\t\tif(!cfg || _.size(cfg) == 0) return;\r\n\t\treturn cfg;\r\n\t},\r\n\t//override this if you need other logic\r\n\tgetCssClassConfig(){\r\n\t\treturn this._getCssClassConfig();\r\n\t},\r\n\r\n\t_getCssClassEvents(cfg){\r\n\t\tlet events = [].concat(cfg.events || []);\r\n\t\tif(cfg.refresh) events.push('refresh');\r\n\t\tif(cfg.beforeRender) events.push('before:render');\r\n\t\tevents = _(events).uniq();\r\n\t\treturn events;\r\n\t},\r\n\t//override this if you need other logic\r\n\tgetCssClassEvents(cfg){\r\n\t\treturn this._getCssClassEvents(cfg);\r\n\t}\r\n});\r\n","\r\nconst defaultSelector = (name, prefix = '') => prefix + 'region-' + name;\r\n\r\nfunction defaultUpdateDom(name, $el)\r\n{\r\n\tlet selector = defaultSelector(name);\r\n\tlet element = $('<div>').addClass(selector);\r\n\t$el.append(element);\r\n\r\n\treturn '.' + selector;\r\n}\r\n\r\nexport default function buildRegionFunc(view, hash, context){\r\n\r\n\tlet { $el } = view;\t\r\n\tlet { autoCreateRegion } = context;\r\n\tlet { updateDom, name, el } = hash;\r\n\tlet regionEl;\r\n\t\r\n\tlet region = view.getRegion(name);\r\n\r\n\r\n\tif (el == null && autoCreateRegion !== false) {\r\n\r\n\t\tlet testEl = region && region.getOption('el',{ deep:false});\r\n\r\n\t\tif (!region || !testEl || !$el.find(testEl).length) {\r\n\r\n\t\t\tregionEl = defaultUpdateDom(name, $el);\r\n\r\n\t\t} \r\n\r\n\t} else if(_.isFunction(updateDom)) {\r\n\t\tupdateDom.call(view, $el, view);\r\n\r\n\t} \r\n\t\r\n\t\r\n\tif (!region) {\r\n\t\tlet definition = _.pick(hash, 'replaceElement', 'regionClass');\r\n\t\tdefinition.el = hash.el || regionEl;\r\n\t\tregion = view.addRegion(name, definition);\r\n\t}\r\n\r\n\r\n\treturn region;\r\n}\r\n","import buildRegion from './build-region';\r\n\r\nexport default function normalizeNestedViewContextRegion(context) {\r\n\r\n\tlet { region } = context;\r\n\tlet regionName = (_.isString(region) && region) || context.regionName || context.name;\r\n\r\n\tif (_.isString(region) || region == null) {\r\n\t\tregion = {};\r\n\t} else if (_.isFunction(region)) {\r\n\t\tregion = region.call(this, context, this);\r\n\t}\r\n\r\n\tif (_.isObject(region)) {\r\n\r\n\t\tif(!region.name)\r\n\t\t\tregion.name = regionName;\r\n\t\tlet replaceElement = this.getOption('replaceNestedElement');\r\n\t\tcontext.region = _.extend({ replaceElement }, region);\r\n\t\tcontext.show = _.partial(buildRegion, this, context.region, context);\r\n\t}\r\n\treturn context;\r\n}\r\n","import result from '../../../utils/better-result';\r\nimport normalizeRegion from './normalize-region';\r\nimport { isView, isViewClass } from '../../../vendors/helpers';\r\nexport default Base => Base.extend({\r\n\tconstructor(){\r\n\t\tthis._nestedViews = {};\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis.initializeNestedViews();\r\n\t},\r\n\ttemplate: false,\r\n\r\n\tshowAllNestedViewsOnRender: false,\r\n\tshowNestedViewOnAdd: false,\r\n\treplaceNestedElement: true,\r\n\r\n\tinitializeNestedViews(){\r\n\t\tif (this._nestedViewsInitialized) return;\r\n\r\n\t\tif(this.getOption('showAllNestedViewsOnRender')) {\r\n\t\t\tthis.on('render', () => this.showAllNestedViews());\r\n\t\t}\r\n\r\n\t\tlet nesteds = this.getOption('nestedViews', { args:[this.model, this]});\r\n\t\t_(nesteds).each((context, index) => {\r\n\r\n\t\t\tlet name = _.isString(index) ? index : (context.name || _.uniqueId('nested'));\r\n\t\t\tthis.addNestedView(name, context);\r\n\r\n\t\t});\r\n\r\n\t\tthis._nestedViewsInitialized = true;\r\n\t},\r\n\t_normalizeNestedContext(name, context){\r\n\r\n\t\tif (isViewClass(context)) {\r\n\t\t\tlet View = context;\r\n\t\t\tcontext = {\r\n\t\t\t\tname, View\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t//unwrap to plain object\r\n\t\tif (_.isFunction(context)) {\r\n\t\t\tcontext = context.call(this, this.model, this);\r\n\t\t}\r\n\r\n\t\t//fix name if its not provided\r\n\t\tif (context.name == null) {\r\n\t\t\tcontext.name = name || _.uniqueId('nested');\r\n\t\t}\r\n\r\n\t\t//convert region to valid function\r\n\t\tcontext = normalizeRegion.call(this, context);\t\t\r\n\r\n\r\n\t\treturn context;\r\n\t},\r\n\t_createNestedContext(context){\r\n\t\tlet contexts = this.getNestedViewContext();\r\n\t\tcontexts[context.name] = context;\r\n\t},\r\n\r\n\taddNestedView(name, context){\r\n\r\n\t\tif (!_.isString(name) || name === '') {\r\n\t\t\tthrow new Error('addNestedView: first argument should be a string');\r\n\t\t}\r\n\r\n\t\tcontext = this._normalizeNestedContext(name, context);\r\n\t\tthis._createNestedContext(context);\r\n\t\tif(this.getOption('showNestedViewOnAdd') && this.isRendered()){\r\n\t\t\tthis.showNestedView(context);\r\n\t\t}\t\t\r\n\t},\r\n\r\n\tshowNestedView(name){\r\n\t\tlet region = this.getNestedViewRegion(name);\r\n\t\tlet view = region && this.buildNestedView(name);\r\n\t\tif (view) {\r\n\t\t\tregion.show(view);\r\n\t\t}\r\n\t},\r\n\tshowAllNestedViews(){\r\n\t\tlet contexts = this.getNestedViewContext();\r\n\t\t_(contexts).each(context => this.showNestedView(context));\r\n\t},\r\n\tgetNestedViewContext(name){\r\n\t\tlet contexts = this._nestedViews;\r\n\t\tif (arguments.length == 0)\r\n\t\t\treturn contexts;\r\n\t\telse\r\n\t\t\treturn contexts[name];\r\n\t},\r\n\r\n\r\n\tbuildNestedView(name){\r\n\r\n\t\tlet context = _.isObject(name) ? name\r\n\t\t\t: _.isString(name) ? this.getNestedViewContext(name)\r\n\t\t\t\t: null;\r\n\r\n\t\tif(!context) return;\r\n\t\tlet passedView = result(context, 'view', { context: this, args: [this, this.model] });\r\n\t\tif(_.isFunction(context.template))\r\n\t\t\treturn context.template;\r\n\t\telse if ( isView(passedView) ) {\r\n\t\t\treturn passedView;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet View = context.View;\r\n\t\t\tlet options = this.buildNestedViewOptions(result(context, 'options', { context: this, args: [this, this.model], default:{} }));\r\n\t\t\t\r\n\t\t\treturn new View(options);\r\n\t\t}\r\n\t},\r\n\tbuildNestedViewOptions(opts){\r\n\t\treturn opts;\r\n\t},\r\n\tgetNestedViewRegion(name){\r\n\t\tlet context = _.isObject(name) ? name\r\n\t\t\t: _.isString(name) ? this.getNestedViewContext(name)\r\n\t\t\t\t: null;\r\n\t\treturn context && _.result(context, 'show');\r\n\t}\r\n\t\r\n});\r\n","import { MnObject } from '../../vendors/marionette';\r\nconst base = MnObject.prototype;\r\nexport default {\r\n\tgetOption: base.getOption,\r\n\tmergeOptions: base.mergeOptions,\r\n\ttriggerMethod: base.triggerMethod,\r\n};\r\n","//import { isInPage } from './utils';\r\n\r\nexport default {\r\n\r\n\t//desc: setups the collection for ViewManager instance\r\n\t//returns: previous collection\r\n\tsetCollection(collection, { init = false} = {}){\r\n\t\t\r\n\t\tif (this.collection == collection) return;\r\n\r\n\t\t//take previous collection for return\r\n\t\tlet previousCollection = this.collection;\r\n\r\n\t\t//take contexts to destroy\r\n\t\tlet destroy = this._removeCollection() || [];\r\n\r\n\t\tthis.collection = collection;\r\n\r\n\t\tif (collection == null && destroy.length){\r\n\t\t\tthis.trigger('change', { destroy });\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tinit && this.initModels();\r\n\t\tthis._setCollectionListeners();\r\n\r\n\r\n\t\treturn previousCollection;\r\n\t},\r\n\t_clearCollectionStore(){\r\n\t\t\r\n\t\tlet store = this._store;\r\n\t\tstore.filtered.length = 0;\r\n\t\tstore.items.length = 0;\r\n\t\tstore.byModel = {};\r\n\t\tstore.isFiltered = false;\r\n\t\tstore.isSorted = false;\r\n\t},\r\n\t_removeCollection(){\r\n\t\tif (this.collection == null) return;\r\n\r\n\t\tlet previousCollection = this.collection;\r\n\r\n\t\tthis.stopListening(previousCollection);\r\n\r\n\t\tlet destroy = this._removeItems(previousCollection.models);\r\n\r\n\t\tdelete this.collection;\r\n\r\n\t\tthis._clearCollectionStore();\r\n\r\n\t\tdelete this._modelsInitialized;\r\n\r\n\t\treturn destroy;\r\n\r\n\t},\r\n\t_setCollectionListeners(){\r\n\t\tif(!this.collection) return;\r\n\t\tthis.listenTo(this.collection, 'update', this._onCollectionUpdate);\r\n\t\tthis.listenTo(this.collection, 'reset', this._onCollectionReset);\r\n\t\tthis.listenTo(this.collection, 'sort', this._onCollectionSort);\r\n\t\tif (this.collection.length === 0) {\r\n\t\t\tthis.listenToOnce(this.collection, 'sync', this._onCollectionFirstFetch);\r\n\t\t}\r\n\t},\r\n\r\n\t//first run, initialized all collection models\r\n\tinitModels(){\r\n\r\n\t\tif(!this.enableCollection || this._modelsInitialized) return;\r\n\r\n\t\tthis._rebuildModels();\r\n\r\n\t\tthis._modelsInitialized = true;\r\n\r\n\t},\r\n\r\n\t_rebuildModels({ sort = true} = {}){\r\n\r\n\t\tlet items = this._store.items;\r\n\t\tlet filtered = this._store.filtered;\r\n\t\titems.length = 0;\r\n\t\tfiltered.length = 0;\r\n\r\n\t\tlet filter = this.getFilter();\r\n\t\tlet models = this.collection.models;\r\n\r\n\t\tfor(let index = 0, length = models.length; index < length; index++) {\r\n\t\t\tlet model = models[index];\r\n\r\n\t\t\tlet context = this._getModelContext(model, { create: true });\r\n\t\t\tcontext.index = index;\r\n\r\n\t\t\tthis._storeContext(context);\r\n\t\t\titems.push(context);\r\n\r\n\t\t\tif(!filter || filter(context))\r\n\t\t\t\tfiltered.push(context);\r\n\r\n\t\t}\r\n\t\tthis._store.isFiltered = true;\r\n\r\n\t\tsort && this._sortItems(filtered, { comparator: this.getComparator(), force: true },'rebuild');\r\n\t\tthis._store.isSorted = sort;\r\n\r\n\t},\r\n\t_onCollectionUpdate(col, opts = {}){\r\n\r\n\t\tlet { changes = {} } = opts;\r\n\t\tlet { added = [], removed = [], merged = [] } = changes;\r\n\t\tlet destroy;\r\n\t\tif (removed.length) {\r\n\r\n\t\t\tdestroy = this._removeItems(removed);\r\n\t\t\tthis._rebuildModels();\r\n\r\n\t\t} else {\r\n\t\t\tif(added.length) {\t\t\t\t\r\n\t\t\t\tlet data = this._filterItems(added, { force: true });\r\n\t\t\t\tthis._addItems(data.attach, { isSorted: false });\t\t\r\n\t\t\t}\r\n\t\t\tif(merged.length){\r\n\t\t\t\tthis._store.isFiltered = false;\r\n\t\t\t}\r\n\t\t\tif((added.length || merged.length) && !_.isFunction(this.getComparator())){\r\n\t\t\t\tthis._updateIndexes();\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.processAndRender({ destroy });\r\n\t},\r\n\r\n\t_addItems(items, {isSorted, isFiltered} = {}){\r\n\r\n\t\tif(!items || !items.length) return;\r\n\r\n\t\tisSorted != null && (this._store.isSorted = isSorted);\r\n\t\tisFiltered != null && (this._store.isFiltered = isFiltered);\r\n\r\n\t\tlet filter = this.getFilter();\r\n\r\n\t\tlet _items = this._store.items;\r\n\t\tlet _filtered = this._store.filtered;\r\n\r\n\t\tfor (let index = 0, length = items.length; index < length; index++) {\r\n\t\t\tlet item = items[index];\r\n\t\t\t_items.push(item);\r\n\t\t\tif(!filter || filter(item))\r\n\t\t\t\t_filtered.push(item);\r\n\t\t}\r\n\t\tthis._store.isFiltered = true;\r\n\r\n\t},\t\r\n\r\n\t_onCollectionFirstFetch(){\r\n\t\tif(this.collection.length) return;\r\n\t\tthis.processAndRender();\r\n\t},\r\n\r\n\t_onCollectionSort(col, { add, merge, remove } = {}){\r\n\r\n\t\tif (_.isFunction(this.getComparator())) return;\r\n\t\tif (add || remove || merge) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._updateIndexes();\r\n\r\n\t\tlet items = this._getItems();\r\n\t\tthis._sortItems(items, { comparator: this._dataComparator, force: true },'collectionsort');\r\n\t\tthis._store.isSorted = true;\r\n\t\tthis.processAndRender();\r\n\r\n\t},\r\n\r\n\t_onCollectionReset(col, { previousModels = []} = {}){\r\n\r\n\t\tlet destroy = this._removeItems(previousModels);\r\n\t\tthis._rebuildModels();\r\n\t\tthis.processAndRender({ destroy });\r\n\r\n\t},\r\n};\r\n","export default {\r\n\t_ensureOptions(){\r\n\t\tif(!this.view)\r\n\t\t\tthrow new Error('view is not set');\r\n\r\n\t\tif(!this.$container){\r\n\t\t\tthis.$container = this.view.$el;\r\n\t\t}\r\n\r\n\t\tif(!this.$container.length)\r\n\t\t\tthrow new Error('children container is not in the DOM');\r\n\r\n\t},\r\n\tgetPaginator(){\r\n\t\tlet skip = this.skip || 0;\r\n\t\tlet take = this.take || Infinity;\r\n\t\t!_.isNumber(skip) || skip < 0 && (skip = 0);\r\n\t\t!_.isNumber(take) || take < 0 && (take = Infinity);\r\n\t\tif(skip == 0 && take == Infinity)\r\n\t\t\treturn;\r\n\t\telse\r\n\t\t\treturn {\r\n\t\t\t\tfrom: skip,\r\n\t\t\t\tto: skip + take\r\n\t\t\t};\r\n\t},\r\n\t_dataComparator(a, b){\r\n\t\treturn a.index - b.index;\r\n\t},\t\r\n\tgetComparator(){\r\n\t\treturn this.dataComparator;\r\n\t},\r\n\tsetComparator(comparator, {preventRender} = {}){\r\n\r\n\t\tif(this.dataComparator == comparator) return;\r\n\r\n\t\tthis.dataComparator = comparator;\r\n\t\tthis._store.isSorted = false;\r\n\r\n\t\tif(!preventRender)\r\n\t\t\tthis.processAndRender();\r\n\t},\r\n\tgetFilter(){\r\n\t\treturn this.dataFilter;\r\n\t},\r\n\tsetFilter(filter, {preventRender} = {}){\r\n\t\tif(this.dataFilter == filter) return;\r\n\r\n\t\tthis.dataFilter = filter;\r\n\t\tthis._store.isFiltered = false;\r\n\t\tif(!preventRender)\r\n\t\t\tthis.processAndRender();\r\n\t},\r\n};\r\n","import { isView, isViewClass } from '../../vendors/helpers';\r\n\r\n\r\nexport default {\r\n\r\n\tgetCustoms(){\r\n\t\treturn this._store.customs;\r\n\t},\r\n\taddCustomView(arg, index){\t\t\r\n\t\tlet customContext = this._normalizeAddCustomContext(arg, index);\r\n\t\tif (!customContext) { return; }\r\n\t\tthis._store.customs.push(customContext);\r\n\t},\r\n\r\n\r\n\t_extractCustomView(arg, custom = {}){\r\n\t\tif(isView(arg) && !arg._isDestroyed) {\r\n\t\t\treturn arg;\r\n\t\t} else if(_.isFunction(custom.build)) {\r\n\t\t\tcustom.view = custom.build();\r\n\t\t\treturn custom.view;\r\n\t\t}\r\n\t},\r\n\r\n\t_injectCustoms(items){\r\n\r\n\t\tif (!items.length) {\r\n\t\t\titems = [];\r\n\t\t\tthis._injectEmptyView(items);\r\n\t\t}\r\n\r\n\t\tlet customs = this.getCustoms() || [];\r\n\r\n\t\tif(!customs.length)\r\n\t\t\treturn items;\r\n\r\n\t\tlet newitems = items.slice(0);\r\n\t\t_.each(customs, custom => {\r\n\t\t\tlet view = this._extractCustomView(custom.view, custom);\r\n\t\t\tif(!view) return;\r\n\t\t\tif(custom.index == null){\r\n\t\t\t\tnewitems.push(custom);\r\n\t\t\t} else {\r\n\t\t\t\tnewitems.splice(custom.index, 0, custom);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn newitems;\r\n\t},\r\n\r\n\t_normalizeAddCustomContext(arg, index){\r\n\t\tif(isView(arg)){\r\n\t\t\treturn {\r\n\t\t\t\tview: arg,\r\n\t\t\t\trebuild: false,\r\n\t\t\t\tindex\r\n\t\t\t};\r\n\t\t} else if (_.isFunction(arg) && isViewClass(arg)){\r\n\t\t\treturn {\r\n\t\t\t\tbuild: () => new arg(),\r\n\t\t\t\tindex,\r\n\t\t\t\trebuild: true,\r\n\t\t\t};\r\n\t\t} else if(_.isFunction(arg)) {\r\n\t\t\treturn {\r\n\t\t\t\tbuild: arg,\r\n\t\t\t\tindex,\r\n\t\t\t\trebuild: true,\r\n\t\t\t};\r\n\t\t} else if (_.isObject(arg)) {\r\n\t\t\tif(index != null)\r\n\t\t\t\targ.index = index;\r\n\t\t\targ.rebuild = !(arg.view instanceof Backbone.View);\r\n\t\t\treturn arg;\r\n\t\t}\r\n\t}\t\r\n};\r\n","export function isInPage(paginator, index){\r\n\treturn !paginator || (index >= paginator.from && index < paginator.to);\r\n}\r\n\r\n\r\nexport function renderView(view) {\r\n\tif (view._isRendered) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!view.supportsRenderLifecycle) {\r\n\t\tview.triggerMethod('before:render', view);\r\n\t}\r\n\r\n\tview.render();\r\n\tview._isRendered = true;\r\n\r\n\tif (!view.supportsRenderLifecycle) {\r\n\t\tview.triggerMethod('render', view);\r\n\t}\r\n}\r\n\r\nexport function destroyView(view, disableDetachEvents) {\r\n\tif (view.destroy) {\r\n\t\t// Attach flag for public destroy function internal check\r\n\t\tview._disableDetachEvents = disableDetachEvents;\r\n\t\tview.destroy();\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Destroy for non-Marionette Views\r\n\tif (!view.supportsDestroyLifecycle) {\r\n\t\tview.triggerMethod('before:destroy', view);\r\n\t}\r\n\r\n\tconst shouldTriggerDetach = view._isAttached && !disableDetachEvents;\r\n\r\n\tif (shouldTriggerDetach) {\r\n\t\tview.triggerMethod('before:detach', view);\r\n\t}\r\n\r\n\tview.remove();\r\n\r\n\tif (shouldTriggerDetach) {\r\n\t\tview._isAttached = false;\r\n\t\tview.triggerMethod('detach', view);\r\n\t}\r\n\r\n\tview._isDestroyed = true;\r\n\r\n\tif (!view.supportsDestroyLifecycle) {\r\n\t\tview.triggerMethod('destroy', view);\r\n\t}\r\n}\r\n","import { isInPage } from './utils';\r\n\r\n\r\nexport default {\r\n\r\n\r\n\tprocess({ destroy = [], silent, forceSort, forceFilter } = {}){\r\n\r\n\t\tthis._removeEmptyViewInstance({ destroy });\r\n\r\n\t\tlet items = this._getItems({ forceFilter });\r\n\t\tlet resultDetach = [];\r\n\r\n\t\tif (!this._store.isFiltered || forceFilter) {\r\n\t\t\tlet { attach, detach } = this._filterItems(items, { filter: this.getFilter() });\r\n\t\t\tthis._setItems(attach, { isFiltered: true });\r\n\t\t\titems = attach;\r\n\t\t\tresultDetach = detach;\r\n\t\t}\r\n\t\tthis._sortItems(items, { comparator: this.getComparator(), force: forceSort },'process');\r\n\t\tthis._store.isSorted = true;\r\n\r\n\r\n\t\tlet data = this._filterItems(items, { paginator: this.getPaginator() });\r\n\t\tresultDetach = resultDetach.concat(data.detach);\r\n\t\tlet attach = this._injectCustoms(data.attach);\r\n\r\n\t\tlet result = {\r\n\t\t\tattach,\r\n\t\t\tdetach: resultDetach,\r\n\t\t\tdestroy,\r\n\t\t\ttotal: data.total,\r\n\t\t\tskiped: data.skiped,\r\n\t\t\ttaked: data.taked\r\n\t\t};\r\n\r\n\t\t\r\n\t\tthis.lastResult = result;\r\n\t\tif(!silent)\r\n\t\t\tsetTimeout(() => this.trigger('change', result), 0);\r\n\r\n\t\t\r\n\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\r\n\t_getItems({ forceFilter } = {}){\r\n\r\n\t\tif (this._store.isFiltered && !forceFilter)\r\n\t\t\treturn this._store.filtered;\r\n\t\telse\r\n\t\t\treturn this._store.items;\r\n\t},\r\n\r\n\t_filterItems(items, { filter, paginator, force } = {}){\r\n\r\n\t\tlet iterator = -1;\r\n\t\tlet detach = [];\r\n\t\tlet attach = [];\r\n\r\n\t\tif (!filter && !paginator && !force) {\r\n\t\t\treturn { attach: items, detach:[] };\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\tlet shouldUpdateIndex = items == this.collection.models;\r\n\t\t\r\n\t\t\r\n\t\tfor(let index = 0, length = items.length; index < length; index++){\r\n\r\n\t\t\tlet model = items[index];\r\n\t\t\tlet item = model;\r\n\t\t\tlet isModel = model instanceof Backbone.Model;\r\n\t\t\tlet isNew = false;\r\n\r\n\t\t\tif (isModel) {\r\n\t\t\t\titem = this._getModelContext(model, { create: true, markNew: true });\r\n\t\t\t\tisNew = item.isNew === true;\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\tlet pass = !filter || filter(item);\r\n\t\t\tif (!pass) {\r\n\t\t\t\titem.view && !item.view._isDestroyed && detach.push(item);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(isInPage(paginator, ++iterator)) {\r\n\t\t\t\tattach.push(item);\r\n\r\n\t\t\t\tif(shouldUpdateIndex){\r\n\t\t\t\t\titem.index = index;\r\n\t\t\t\t}\r\n\t\t\t\tif (isNew) {\r\n\t\t\t\t\tthis._storeContext(item);\r\n\t\t\t\t}\r\n\t\t\t} else if (paginator && iterator > paginator.to){\r\n\t\t\t\tbreak;\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\r\n\t\t\r\n\t\tlet res = { attach , detach };\r\n\t\tif(paginator){\r\n\t\t\tres.total = items.length;\r\n\t\t\tres.skiped = paginator.from;\r\n\t\t\tres.taked = iterator - paginator.from - 1;\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\r\n\t_sortItems(items, { comparator, force } = {}){\r\n\r\n\t\tif(this._store.isSorted && !force) { return; }\r\n\r\n\t\tif(!comparator) {\r\n\t\t\tcomparator = this._dataComparator;\r\n\t\t\tif(!comparator) return;\r\n\t\t}\r\n\r\n\t\tif (this._store.isFiltered && items !== this._store.items) {\r\n\t\t\tsetTimeout(() => this._sortItems(this._store.items, { comparator, force: true },'timeout sort'),0);\r\n\t\t}\r\n\r\n\t\t\r\n\t\tlet iteratee = comparator.length == 1 \r\n\t\t\t? (a,b) => {\r\n\t\t\t\tlet _a = comparator(a); let _b = comparator(b);\r\n\t\t\t\tif(_a < _b) return -1;\r\n\t\t\t\tif(_a > _b) return 1;\r\n\t\t\t\treturn 0;\t\t\t\t\r\n\t\t\t}\r\n\t\t\t: comparator;\r\n\r\n\t\titems.sort(iteratee);\r\n\t\t\r\n\t},\r\n\r\n\r\n\t_setItems(items, { isSorted, isFiltered } = {}){\r\n\r\n\t\tisSorted != null && (this._store.isSorted = isSorted);\r\n\t\tisFiltered != null && (this._store.isFiltered = isFiltered);\r\n\t\tif (isFiltered) {\r\n\t\t\tthis._store.filtered = items;\r\n\t\t} else {\r\n\t\t\tthis._store.items = items;\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_removeItems(items = []){\r\n\r\n\t\tlet destroy = [];\r\n\t\tfor (let index = 0, length = items.length; index < length; index++) {\r\n\t\t\tlet item = items[index];\r\n\t\t\tlet view = this._removeItem(item);\r\n\t\t\tview && destroy.push(view);\r\n\t\t}\r\n\t\treturn destroy;\r\n\t},\r\n\r\n\t_removeItem(item){\r\n\t\tlet model = item instanceof Backbone.Model ? item : item.model;\r\n\t\tlet context = this._store.byModel[model.id] || this._store.byModel[model.cid];\r\n\t\tdelete this._store.byModel[model.id];\r\n\t\tdelete this._store.byModel[model.cid];\r\n\t\treturn context.view;\r\n\t},\r\n\r\n\t_getModelView(model){\r\n\t\tlet id = model.id == null ? model.cid : model.id;\r\n\t\tlet context = this._store.byModel[id];\r\n\t\treturn context && context.view;\r\n\t},\r\n\r\n\t_getModelContext(model, { create, markNew } = {}){\r\n\t\tlet id = model.id == null ? model.cid : model.id;\r\n\t\tlet context = this._store.byModel[id];\r\n\t\tif (context) { return context; }\r\n\t\tif (create) {\r\n\t\t\tcontext = { model, isCollection: true };\r\n\t\t\tmarkNew && (context.isNew = true);\r\n\t\t\treturn context;\r\n\t\t}\r\n\t},\r\n\r\n\t_storeContext(context){\r\n\t\tlet id = context.model.id;\r\n\t\tcontext.isNew && (delete context.isNew);\r\n\t\tif(id != null)\r\n\t\t\tthis._store.byModel[id] = context;\r\n\t\tthis._store.byModel[context.model.cid] = context;\r\n\t},\r\n\r\n\t_initView(context){\r\n\t\tif(context.view && !context.view._isDestroyed)\r\n\t\t\treturn;\r\n\t\tcontext.view = this.createView(context.model);\r\n\t},\r\n\r\n\t_updateIndexes(){\r\n\r\n\t\tlet models = this.collection.models;\r\n\t\tfor (let index = 0, length = models.length; index < length; index++) {\r\n\t\t\tlet model = models[index];\r\n\t\t\tlet id = model.id == null ? model.cid : model.id;\r\n\t\t\tlet context = this._store.byModel[id];\r\n\t\t\tcontext && (context.index = index);\r\n\t\t}\r\n\t},\r\n\r\n\r\n};\r\n","import { destroyView, renderView } from './utils';\r\n\r\nexport default {\r\n\r\n\ttriggerViewMethod(){\r\n\t\tthis.view.triggerMethod.apply(this.view, arguments);\r\n\t},\r\n\tprocessAndRender(opts){\r\n\t\tlet data = this.process(opts);\r\n\t\tthis.render(data);\r\n\t},\r\n\tbeforeRender(){\r\n\t\tif (this.view._isRendered) {\r\n\t\t\tthis.removeCustomViews();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.initModels();\r\n\t\t}\r\n\t},\r\n\trender(data){\t\t\r\n\t\tif(!data) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telse {\r\n\r\n\t\t\tthis.triggerViewMethod('before:render:children', data);\r\n\r\n\t\t\tif(this.view._isRendered)\r\n\t\t\t\tthis.removeCustomViews();\r\n\r\n\t\t\tthis._destroyChildViews(data.destroy);\r\n\t\t\tthis._detachChildViews(data.detach);\r\n\t\t\tthis._attachChildViews(data.attach);\r\n\r\n\t\t\tthis.triggerViewMethod('render:children', data);\r\n\r\n\t\t}\r\n\t},\r\n\r\n\tremoveCustomViews(){\r\n\t\tlet customs = this.getCustoms() || [];\r\n\t\t_.each(customs, custom => {\r\n\t\t\tif(!custom.view) return;\r\n\t\t\tif(custom.rebuild)\r\n\t\t\t\tthis._destroyChildView(custom.view);\r\n\t\t\telse\r\n\t\t\t\tthis._detachChildView(custom.view);\r\n\t\t});\r\n\t},\r\n\t_destroyChildViews(views = []){\r\n\t\tif(!views.length) return;\r\n\r\n\t\tthis.triggerViewMethod('before:destroy:children', this);\r\n\r\n\t\tif (this.view.monitorViewEvents === false) {\r\n\t\t\tthis.view.Dom.detachContents(this.$container);\r\n\t\t}\r\n\t\r\n\t\tconst shouldDisableEvents = this.view.monitorViewEvents === false;\r\n\t\t_.each(views, view => {\r\n\t\t\tthis._destroyChildView(view, shouldDisableEvents);\r\n\t\t});\r\n\t\r\n\t\r\n\t\tthis.triggerViewMethod('destroy:children', this);\r\n\r\n\t},\r\n\r\n\t_destroyChildView(view, shouldDisableEvents){\r\n\r\n\t\tif(shouldDisableEvents == null)\r\n\t\t\tshouldDisableEvents = this.view.monitorViewEvents === false;\r\n\r\n\t\t//view.off('destroy', this.removeChildView, this);\r\n\t\tif (!view || view._isDestroyed) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdestroyView(view, shouldDisableEvents);\t\t\r\n\t\tthis.view.stopListening(view);\r\n\t},\r\n\r\n\t_detachChildViews(contexts = []){\r\n\t\tif(!contexts.length) return;\r\n\t\tlet monitorViewEvents = this.monitorViewEvents !== false;\r\n\t\t_.each(contexts, context => {\r\n\t\t\tthis._detachChildView(context.view, monitorViewEvents);\r\n\t\t});\r\n\t},\r\n\r\n\t_detachChildView(view, monitorViewEvents){\r\n\t\tif(!view) return;\r\n\t\tif(monitorViewEvents == null) {\r\n\t\t\tmonitorViewEvents = this.view.monitorViewEvents !== false;\r\n\t\t}\r\n\t\tconst shouldTriggerDetach = view._isAttached && monitorViewEvents;\r\n\t\tif (shouldTriggerDetach) {\r\n\t\t\tview.triggerMethod('before:detach', view);\r\n\t\t}\r\n\t\t\t\t\r\n\t\tthis.view.Dom.detachEl(view.el, view.$el);\r\n\r\n\t\tif (shouldTriggerDetach) {\r\n\t\t\tview._isAttached = false;\r\n\t\t\tview.triggerMethod('detach', view);\r\n\t\t}\t\r\n\t},\r\n\r\n\t_attachChildViews(contexts = []){\r\n\t\tif(!contexts.length) return;\r\n\t\t\r\n\t\tconst shouldTriggerAttach = this.view._isAttached && this.view.monitorViewEvents !== false;\r\n\r\n\t\tconst elBuffer = this.view.Dom.createBuffer();\r\n\r\n\t\t_.each(contexts, context => {\r\n\t\t\tlet view = this._ensureContextHasView(context);\r\n\r\n\t\t\tif(!view) return;\r\n\r\n\t\t\trenderView(view);\r\n\t\t\tthis.view.Dom.appendContents(elBuffer, view.el, {_$contents: view.$el});\r\n\r\n\t\t\tif (shouldTriggerAttach && !view._isAttached) {\t\t\t\t\r\n\t\t\t\tview.triggerMethod('before:attach', view);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.view.Dom.appendContents(this.$container[0], elBuffer, {_$el: this.$container});\r\n\r\n\t\tif(shouldTriggerAttach){\r\n\t\t\t_.each(contexts, context => {\r\n\t\t\t\tlet view = context.view;\r\n\t\t\t\tif(!view || view._isAttached) return;\r\n\t\t\t\tview._isAttached = true;\r\n\t\t\t\tview.triggerMethod('attach', view);\r\n\t\t\t});\t\t\t\r\n\t\t}\r\n\t},\r\n\t_ensureContextHasView(context){\r\n\t\tif (context.view && !context.view._isDestroyed)\r\n\t\t\treturn context.view;\r\n\t\telse if (context.isCollection) {\r\n\t\t\tcontext.view = this._createModelChildView(context.model);\r\n\t\t\treturn context.view;\r\n\t\t} else if(context.rebuild && _.isFunction(context.build)) {\r\n\t\t\tcontext.view = context.build();\r\n\t\t\treturn context.view;\r\n\t\t} \r\n\t},\r\n\t_createModelChildView(model){\r\n\t\tlet View = this._getChildViewClass(model);\r\n\t\tif(!View) return;\r\n\t\tlet options = this._getChildViewOptions(model, View);\r\n\t\treturn new View(options);\r\n\t},\r\n\t_getChildViewClass(model){\r\n\t\tif(this.modelView === Backbone.View || this.modelView.prototype instanceof Backbone.View)\r\n\t\t\treturn this.modelView;\r\n\t\telse {\r\n\t\t\treturn this.modelView(model);\r\n\t\t}\r\n\t},\r\n\t_getChildViewOptions(model, View){\r\n\t\tlet options = {};\r\n\t\tif(_.isFunction(this.modelViewOptions)){\r\n\t\t\toptions = this.modelViewOptions.call(this, model, View, this) || {};\r\n\t\t} else if(_.isObject(this.modelViewOptions)) {\r\n\t\t\toptions = this.modelViewOptions;\r\n\t\t}\r\n\t\treturn _.extend({}, options, { model });\r\n\t},\r\n\r\n\r\n\r\n\r\n};\r\n","import { isViewClass } from '../../vendors/helpers';\r\n\r\nconst EmptyViewMixin = {\r\n\tremoveEmptyViewInstance(opts = {}){\r\n\t\tlet view = this._emptyViewInstance;\r\n\t\tif (!view) return;\r\n\t\tlet { destroy = []} = opts;\r\n\t\tif (view) {\r\n\t\t\tdelete this._emptyViewInstance;\r\n\t\t\tdestroy.push(view);\r\n\t\t\topts.destroy = destroy;\r\n\t\t}\r\n\t},\r\n\t_getEmptyViewClas(){\r\n\t\tif (!this.emptyView) { return; }\r\n\t\telse if(isViewClass(this.emptyView)){\r\n\t\t\treturn this.emptyView;\r\n\t\t} else if(_.isFunction(this.emptyView)) {\r\n\t\t\treturn this.emptyView.call(this.view);\r\n\t\t}\r\n\t},\r\n\t_injectEmptyView(items){\r\n\t\tlet View = this._getEmptyViewClas();\r\n\t\tif (!View) return;\r\n\t\tlet options = _.extend({}, this.emptyViewOptions);\r\n\t\tlet view = new View(options);\r\n\t\tthis._emptyViewInstance = view;\r\n\t\titems.push({ view });\r\n\t},\r\n\t_removeEmptyViewInstance({ destroy = [] } = {}){\r\n\t\tlet view = this._emptyViewInstance;\r\n\t\tif (!view) return;\r\n\r\n\t\tif (view) {\r\n\t\t\tdelete this._emptyViewInstance;\r\n\t\t\tdestroy.push(view);\r\n\t\t}\r\n\t},\t\r\n};\r\nexport default EmptyViewMixin;\r\n","import extend from '../../utils/extend';\r\nimport borrow from './borrow';\r\nimport collection from './collection';\r\nimport common from './common';\r\nimport customs from './customs';\r\nimport models from './models';\r\nimport render from './render';\r\nimport emptyView from './empty-view';\r\n\r\nimport { Events } from '../../vendors/backbone';\r\n\r\nconst MergeOptions = [\r\n\t'createView',\r\n\t'dataFilter',\r\n\t'dataComparator',\r\n\t'enableCollection',\r\n\t'$container',\r\n\t'view',\r\n\t'modelView',\r\n\t'modelViewOptions',\r\n\t'emptyView',\r\n\t'emptyViewOptions'\r\n];\r\n\r\nconst ViewManager = function(options = {}){\r\n\tthis.options = _.omit(options, 'collection');\r\n\tthis.mergeOptions(options, MergeOptions);\r\n\tthis._ensureOptions();\r\n\tthis._store = {\r\n\r\n\t\t//holds current filtered set of model contexts\r\n\t\tfiltered:[],\r\n\r\n\t\t//holds all model contexts\r\n\t\titems: [],\r\n\r\n\t\t//grants fast access to a context through model id or cid\r\n\t\tbyModel: {},\r\n\r\n\t\t//holds all cutoms contexts\r\n\t\tcustoms: [],\r\n\t\r\n\t\t//indicates if comparator should be applied\r\n\t\tisSorted: false,\r\n\r\n\t\t//indicates if filter should be applied\r\n\t\tisFiltered: false,\r\n\r\n\t};\r\n\t\r\n\t//in collection mixin\r\n\tif(this.enableCollection)\r\n\t\tthis.setCollection(this.collection || options.collection);\r\n};\r\n\r\nViewManager.extend = extend;\r\n\r\n_.extend(ViewManager.prototype, Events, borrow, collection, common, customs, models, render, emptyView);\r\n\r\nexport default ViewManager;\r\n","import ViewManager from '../../../components/view-manager';\r\n\r\nexport default BaseView => BaseView.extend({\r\n\t\r\n\tconstructor(options){\r\n\t\tthis.options = options;\r\n\t\tthis.mergeOptions(options,['managedCollection','collection','viewFilter','viewComparator', 'modelView', 'modelViewOptions', 'emptyView', 'emptyViewOptions']);\r\n\t\t\r\n\t\tBaseView.apply(this, arguments);\r\n\t\t\r\n\t\t//tries to initialize viewManager\r\n\t\tthis._initializeViewManager();\r\n\t},\r\n\r\n\ttemplate: _.noop,\r\n\t//if true - initializes ViewManager without collection support\r\n\tenableCustomViews: false,\r\n\t//if true - initializes ViewManager with collection and customviews support\r\n\tenableCollectionViews: false,\r\n\r\n\t_initializeViewManager(){\r\n\t\tlet customs = this.getOption('enableCustomViews');\r\n\t\tlet models = this.getOption('enableCollectionViews');\r\n\t\tif(!(customs || models)) return;\r\n\t\t\r\n\t\tthis._fallbackOptions();\r\n\r\n\t\tthis._viewManager = new ViewManager({\r\n\t\t\tenableCollection: models,\r\n\t\t\tcollection: models && this.managedCollection || this.collection || null,\r\n\t\t\tview: this,\r\n\t\t\tmodelView: this.modelView,\r\n\t\t\tmodelViewOptions: this.modelViewOptions,\r\n\t\t\tdataFilter: this.getFilter(),\r\n\t\t\tdataComparator: this.getComparator(),\r\n\t\t\temptyView: this.emptyView,\r\n\t\t\temptyViewOptions: this.emptyViewOptions,\r\n\t\t});\r\n\r\n\t},\r\n\r\n\t_fallbackOptions(){\r\n\t\tif(!this.modelView) {\r\n\t\t\tthis.modelView = this.childView || this.options.childView;\r\n\t\t}\r\n\t\tif(!this.modelViewOptions){\r\n\t\t\tthis.modelViewOptions = this.childViewOptions || this.options.childViewOptions;\r\n\t\t}\r\n\t},\t\r\n\r\n\r\n\t/*\r\n\t\trender has two additional calls\r\n\t\t\t- this._viewManager.beforeRender()\r\n\t\t\t- this._viewManager.processAndRender()\r\n\t*/\r\n\trender() {\r\n\t\tconst template = this.getTemplate();\r\n\r\n\t\tif (template === false || this._isDestroyed) { return this; }\r\n\r\n\t\tthis._viewManager && this._viewManager.beforeRender();\r\n\r\n\t\tthis.triggerMethod('before:render', this);\r\n\r\n\r\n\t\t// If this is not the first render call, then we need to\r\n\t\t// re-initialize the `el` for each region\r\n\t\tif (this._isRendered) {\r\n\t\t\tthis._reInitRegions();\r\n\t\t}\r\n\r\n\t\tthis._renderTemplate(template);\r\n\t\tthis.bindUIElements();\r\n\r\n\t\tthis._viewManager && this._viewManager.processAndRender();\r\n\r\n\t\tthis._isRendered = true;\r\n\t\tthis.triggerMethod('render', this);\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\r\n\t/*\r\n\t\tmanaging sort and filter\r\n\t*/\r\n\tsetComparator(comparator, opts) {\r\n\t\tthis._viewManager && this._viewManager.setComparator(comparator, opts);\r\n\t\tthis.viewComparator = comparator;\r\n\t\treturn this;\r\n\t},\r\n\tgetComparator(){\r\n\t\treturn this.viewComparator;\r\n\t},\r\n\tsetFilter(filter, opts) {\r\n\t\tthis._viewManager && this._viewManager.setFilter(filter, opts);\r\n\t\tthis.viewFilter = filter;\r\n\t\treturn this;\r\n\t},\r\n\tgetFilter(){\r\n\t\treturn this.viewFilter;\r\n\t},\r\n\r\n\r\n\t/*\r\n\t\tfallback methods for CollectionView \r\n\t*/\r\n\tsort(){\r\n\t\tthis._viewManager && this._viewManager.processAndRender({ forceSort: true, forceFilter: true });\r\n\t},\r\n\tfilter(){\r\n\t\tthis._viewManager && this._viewManager.processAndRender({ forceFilter: true });\r\n\t},\t\r\n\r\n\taddChildView(){\r\n\t\tthis._viewManager && this._viewManager.addCustomView.apply(this._viewManager, arguments);\r\n\t},\r\n\r\n});\r\n","export default function triggerControlEvent(control, event, ...args){\r\n\r\n\t//let control = _control.getParentControl() || _control;\r\n\r\n\tlet name = control.getControlName();\r\n\tlet eventName = name + ':' + event;\r\n\tlet method = _.isFunction(control.triggerMethod) ? control.triggerMethod\r\n\t\t: _.isFunction(control.trigger) ? control.trigger\r\n\t\t\t: function(){};\r\n\tmethod.call(control, eventName, ...args);\r\n\t\r\n\r\n\tcontrol.proxyControlEventToParent(eventName, ...args);\r\n\r\n}\r\n","export default function getTriggerValue(control, args = []){\r\n\r\n\tlet value = args.length ? args[0] : control.getControlValue();\r\n\r\n\tif(_.isFunction(control.convertValue))\r\n\t\tvalue = control.convertValue(value);\r\n\t\t\r\n\treturn value;\r\n}\r\n","import triggerControlEvent from './trigger-control-event';\r\nimport getTriggerValue from './get-trigger-value';\r\nimport getOption from '../../../utils/get-option';\r\nimport camelCase from '../../../utils/camel-case';\r\n\r\nexport default Base => Base.extend({\t\r\n\r\n\tgetControlValue(){\r\n\t\treturn this.value;\r\n\t},\r\n\tsetControlValue(value){\r\n\t\tthis.value = value;\r\n\t},\r\n\r\n\tgetControlName(){\r\n\t\treturn getOption(this, 'controlName', { args:[this]}) || 'control';\r\n\t},\r\n\r\n\tgetParentControl(){\r\n\t\treturn getOption(this, 'proxyTo', { args:[this]});\r\n\t},\r\n\ttriggerChildControlEvent(eventName, ...args){\r\n\t\tlet events = getOption(this, 'childControlEvents', { args:[this]}) || {};\r\n\t\tif (_.isFunction(events[eventName])) {\r\n\t\t\tevents[eventName].apply(this, args);\r\n\t\t}\r\n\t},\r\n\r\n\ttryValidateControl(value){\r\n\t\tlet validate = getOption(this, 'validateControl', { force: false });\r\n\t\tif(_.isFunction(validate))\r\n\t\t\treturn validate.call(this, value, this);\r\n\t},\r\n\r\n\ttriggerControlChange(){\r\n\t\tthis._triggerControlEvent('change', arguments);\r\n\t},\r\n\ttriggerControlDone(){\r\n\t\tthis._triggerControlEvent('done', arguments);\r\n\t},\r\n\t_isValueAsPrevious(value, type){\r\n\t\tlet previousTriggerName = this.getPreviousTriggerValueKey(type);\r\n\t\tif (previousTriggerName in this) {\r\n\t\t\treturn JSON.stringify(this[previousTriggerName]) === JSON.stringify(value);\r\n\t\t}\r\n\t},\r\n\tisValueAsPrevious(value, type)\r\n\t{\r\n\t\treturn this._isValueAsPrevious(value, type);\r\n\t},\r\n\tsetPreviousTriggerValue(value, type){\r\n\t\tlet key = this.getPreviousTriggerValueKey(type);\r\n\t\tthis[key] = value;\r\n\t},\r\n\tgetPreviousTriggerValueKey(type){\r\n\t\treturn camelCase('_previous:' + type);\r\n\t},\r\n\t_triggerControlEvent(eventName, args) {\r\n\r\n\t\tlet triggerValue = getTriggerValue(this, args);\r\n\t\tif (this.isValueAsPrevious(triggerValue, eventName)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet errors = this.tryValidateControl(triggerValue);\r\n\t\tif (!errors) {\r\n\t\t\tthis.setPreviousTriggerValue(triggerValue, eventName);\t\t\t\r\n\t\t\ttriggerControlEvent(this, eventName, triggerValue);\r\n\t\t} else {\r\n\t\t\tthis.triggerControlInvalid(errors);\r\n\t\t}\r\n\t},\r\n\ttriggerControlInvalid(errors){\r\n\t\ttriggerControlEvent(this, 'invalid', errors);\r\n\t},\r\n\tproxyControlEventToParent(eventName, ...args){\r\n\t\tlet parent = this.getParentControl();\r\n\t\tif (parent && _.isFunction(parent.triggerChildControlEvent)) {\r\n\t\t\tparent.triggerChildControlEvent(eventName, ...args);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\r\n}, {\r\n\tControlMixin: true\r\n});\r\n","import getOption from '../../../utils/get-option';\r\nconst _getOption = (context, key, checkAlso) => getOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function getInputType(inputView, opts = {}){\r\n\t\r\n\tlet valueType = _getOption(inputView, 'valueType', opts);\r\n\tif (valueType == null) {\r\n\t\tlet value = inputView.getControlValue();\r\n\t\tif ( value == null) {\r\n\t\t\tvalueType = 'string';\r\n\t\t} else {\r\n\t\t\tif(_.isNumber(value))\r\n\t\t\t\tvalueType = 'number';\r\n\t\t\telse if(_.isDate(value))\r\n\t\t\t\tvalueType = 'datetime';\r\n\t\t\telse\r\n\t\t\t\tvalueType = 'string';\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tif (valueType == 'number') {\r\n\t\tinputView._valueIsNumber = true;\r\n\t}\r\n\r\n\tlet type = _getOption(inputView, 'inputType', opts);\r\n\r\n\tif (!type) {\r\n\t\tif (inputView._valueIsNumber) {\r\n\t\t\ttype = _getOption(inputView, 'inputNumberType', opts) || 'number';\r\n\t\t} else if (valueType == 'string') {\r\n\t\t\ttype = 'text';\r\n\t\t} else if (valueType == 'datetime') {\r\n\t\t\ttype = 'datetime';\r\n\t\t} else {\r\n\t\t\ttype = 'text';\r\n\t\t}\r\n\t}\r\n\tinputView.inputType = type;\r\n\tinputView.valueType = valueType;\r\n\treturn type;\r\n}\r\n","import getInputType from './get-input-type';\r\n\r\nimport getOption from '../../../utils/get-option';\r\n\r\n\r\nexport default function setInputAttributes(inputView, opts = {}) {\r\n\r\n\tlet attributes = getOption(inputView, opts, 'attributes');\r\n\r\n\tlet restrictionKeys = {\r\n\t\t'maxLength':'maxlength', \r\n\t\t'minValue':'min', \r\n\t\t'maxValue':'max', \r\n\t\t'valuePattern':'pattern',\r\n\t\t'required':'required',\r\n\t\t'value':'value'\r\n\t};\r\n\tlet restrictions = {};\r\n\t_(restrictionKeys).each((key2, key) => {\r\n\t\tlet value = getOption(inputView, opts, key);\r\n\t\tif (value != null)\r\n\t\t\trestrictions[key2] = value;\r\n\t});\r\n\r\n\tinputView.attributes = _.extend({\r\n\t\tvalue: inputView.value,\r\n\t\ttype: getInputType(inputView, opts),\r\n\t}, restrictions, attributes);\r\n\t\r\n\tif(opts.attributes)\r\n\t\tdelete opts.attributes;\r\n}\r\n","import getOption from '../../../../utils/get-option';\r\nexport default (context, key, ifNull) => getOption(key, { args:[context], default: ifNull });\r\n\r\n","export default function isChar(event){\r\n\treturn event.key && event.key.length == 1 && !event.ctrlKey;\r\n}","import getOption from './_get-option';\r\nimport isChar from './_is-char';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\tlet prevent = false;\r\n\tlet stop = false;\r\n\r\n\tif (isChar(event)) {\r\n\t\tif (!context.isEnteredCharValid(event.key)) {\r\n\t\t\tprevent = true;\r\n\t\t}\r\n\t}\r\n\tif(event.keyCode == 13 && getOption(context, 'doneOnEnter', true)){\r\n\t\tprevent = true;\r\n\t\tstop = true;\r\n\t}\r\n\r\n\tstop && event.stopPropagation();\r\n\tprevent && event.preventDefault();\r\n}\r\n","import getOption from './_get-option';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\tif(event.keyCode == 13 && getOption(context, 'doneOnEnter', true)){\r\n\t\tcontext.triggerControlDone();\r\n\t\tevent.stopPropagation();\r\n\t\tevent.preventDefault();\r\n\t}\r\n}","export default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\tlet text = event.originalEvent.clipboardData.getData('text/plain');\r\n\tif (!text) return;\r\n\tif (!context.isValueValid(text)) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\t}\r\n}\r\n","import getOption from './_get-option';\r\nexport default function(eventContext) {\r\n\tlet { context } = eventContext;\r\n\tif (getOption(context, 'doneOnBlur', true)) {\r\n\t\tcontext.triggerControlDone();\r\n\t}\r\n}","import getOption from './_get-option';\r\nexport default function(eventContext) {\r\n\tlet { context, input } = eventContext;\r\n\tif (getOption(context, 'selectOnFocus', true)) {\r\n\t\tinput.select();\r\n\t}\r\n}\r\n","export default function(eventContext) {\r\n\r\n\tlet { context, input, event } = eventContext;\r\n\r\n\tlet newvalue = context.setControlValue(event.target.value);\r\n\tif (event.target.value != (newvalue || '').toString()) {\r\n\t\tinput.value = newvalue;\r\n\t}\r\n\t//context.triggerControlChange();\r\n}\r\n","import keydown from './keydown';\r\nimport keyup from './keyup';\r\nimport paste from './paste';\r\nimport blur from './blur';\r\nimport focus from './focus';\r\nimport input from './input';\r\n//import jsChange from './js-change';\r\nexport default {\r\n\tkeydown, \r\n\t//keypress,\r\n\tkeyup,\r\n\tpaste,\r\n\tblur,\r\n\tfocus,\r\n\tinput,\r\n\t//'js:change': jsChange\r\n};","import camelCase from '../../../utils/camel-case';\r\nimport events from './events';\r\nexport default function handleInputEvent(control, eventName, event) {\r\n\tlet options = _.extend({\r\n\t\tcontext: control,\r\n\t\tinput: control.el,\r\n\t\trestrictions: control.restrictions,\r\n\t\teventName,\r\n\t\tevent\r\n\t});\r\n\r\n\r\n\tlet method = camelCase(`on:dom:${eventName}`);\r\n\r\n\tif (_.isFunction(events[eventName])) {\r\n\t\tevents[eventName].call(control, options);\r\n\t} \r\n\t\r\n\tif (_.isFunction(control[method])) {\r\n\t\tcontrol[method](event, options);\r\n\t} \r\n}","import handleEvent from './handle-event';\r\nimport eventHandlers from './events';\r\nimport getOption from '../../../utils/get-option';\r\n\r\nconst _getOption = (context, key, checkAlso) => \r\n\tgetOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function setInputEvents(inputView, opts = {}) {\r\n\r\n\tlet passedEvents = _getOption(inputView, 'events', opts);\t\r\n\r\n\tlet eventsArray = _(eventHandlers).keys();\t\r\n\tlet events = _.reduce(eventsArray, (Memo, eventName) => {\r\n\t\tMemo[eventName] = function(event){ \r\n\t\t\thandleEvent(this, eventName, event); \r\n\t\t};\r\n\t\treturn Memo;\r\n\t}, {});\r\n\tinputView.events = _.extend(events, passedEvents);\r\n}\r\n","export default function toNumber(text){\r\n\tif(_.isNumber(text)) return text;\r\n\tif(!_.isString(text)) return;\r\n\t\r\n\tlet value = parseFloat(text, 10);\r\n\tif(isNaN(value))\r\n\t\tvalue = undefined;\r\n\t\t\r\n\treturn value;\r\n}\r\n","export default {\r\n\tnullable: true, \r\n\tstrict: false,\r\n\treturnNullAs: undefined, \r\n\treturnEmptyAs: undefined, \r\n\treturnNullAndEmptyAs: undefined,\r\n\treturnAnyAs: undefined, \r\n\treturnOtherAs: undefined\r\n};\r\n","import defaultOptions from './options';\r\n\r\nconst trueValues = ['true','1','-1','yes'];\r\nconst falseValues = ['false','0','no'];\r\n\r\nconst alternative = function(...args) {\r\n\tlet returnValue;\r\n\t_(args).some(arg => {\r\n\t\tif(_.isBoolean(arg)) {\r\n\t\t\treturnValue = arg;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t});\r\n\treturn returnValue;\r\n};\r\n\r\nconst valueOrAlternative = function(nullable, nullValue, value, ...alts){\r\n\tlet alt = alternative(...alts);\r\n\tif (alt != null)\r\n\t\treturn alt;\r\n\telse if (nullable)\r\n\t\treturn nullValue;\r\n\telse\r\n\t\treturn value;\r\n};\r\n\r\nconst convertToBoolean = function (arg, opts = {})\r\n{\r\n\r\n\tlet other;\r\n\tlet options = _.extend({}, defaultOptions, opts);\r\n\tlet { \r\n\t\tnullable, strict,\r\n\t\treturnNullAs, returnEmptyAs, returnNullAndEmptyAs,\r\n\t\treturnAnyAs, returnOtherAs\r\n\t} = options;\r\n\r\n\r\n\r\n\tif (arg == null) {\r\n\t\treturn valueOrAlternative(nullable, undefined, false, returnNullAs, returnNullAndEmptyAs);\r\n\t}\r\n\telse if (arg === '') {\r\n\t\treturn valueOrAlternative(nullable, undefined, false, returnEmptyAs, returnNullAndEmptyAs);\r\n\t} else if (_.isBoolean(arg)) {\r\n\t\treturn arg;\r\n\t}\r\n\t//  else if (_.isObject(arg)) {\r\n\t// }\r\n\t\r\n\tother = strict \r\n\t\t? (nullable ? undefined : false) \r\n\t\t: true;\r\n\t\t\r\n\r\n\tlet text = arg.toString().toLowerCase();\r\n\tlet isTrue = convertToBoolean.trueValues.indexOf(text) > -1;\r\n\tlet isFalse = convertToBoolean.falseValues.indexOf(text) > -1;\r\n\r\n\r\n\tif (_.isBoolean(returnAnyAs)) {\r\n\t\treturn returnAnyAs;\r\n\t} else if (_.isBoolean(returnOtherAs)) {\r\n\t\tother = returnOtherAs;\r\n\t}\r\n\t\r\n\treturn isTrue \r\n\t\t? true \r\n\t\t: isFalse \r\n\t\t\t? false \r\n\t\t\t: other;\r\n};\r\n\r\nconvertToBoolean.trueValues = trueValues;\r\nconvertToBoolean.falseValues = falseValues;\r\nexport default convertToBoolean;\r\n","import toNumber from './to-number';\r\nimport toBoolean from '../to-bool';\r\n\r\n\r\n//this is under development yet and can be change in any time\r\nexport default function convertString(text, type, opts) {\r\n\r\n\tswitch(type){\r\n\tcase 'number':\r\n\t\treturn toNumber(text, opts);\r\n\tcase 'boolean':\r\n\t\treturn toBoolean(text, opts);\r\n\tdefault:\r\n\t\treturn text;\r\n\t}\r\n\r\n\r\n}\r\n","import ControlMixin from '../control';\r\nimport setInputAttributes from './set-attributes';\r\nimport setInputEvents from './set-events';\r\nimport getOption from '../../../utils/get-option';\r\nimport convert from '../../../utils/convert-string';\r\n\r\nexport default Base => {\r\n\r\n\tlet Mixin = Base.ControlMixin ? Base : ControlMixin(Base);\r\n\r\n\treturn Mixin.extend({\r\n\t\tconstructor(opts){\r\n\t\t\t\r\n\t\t\tsetInputAttributes(this, opts);\r\n\t\t\tsetInputEvents(this, opts);\r\n\t\t\tMixin.apply(this, arguments);\r\n\r\n\t\t\tif (!_.isFunction(this.getOption)) {\r\n\t\t\t\tthis.getOption = _.partial(getOption, this, _, { args: [this]});\r\n\t\t\t}\r\n\r\n\t\t\tthis.buildRestrictions();\r\n\t\t\tlet value = this.getOption('value') || '';\t\t\t\r\n\t\t\tthis.el.value = value;\r\n\t\t\tthis.setControlValue(value);\r\n\t\t},\r\n\t\ttagName:'input',\r\n\t\ttemplate: false,\r\n\t\tbuildRestrictions(){\r\n\t\t\tlet attrs = _.result(this, 'attributes');\r\n\t\t\tlet pickNumbers = ['maxlength', 'min', 'max'];\r\n\t\t\tlet pickStrings = ['pattern'];\r\n\t\t\tlet pickBools = ['required'];\r\n\t\t\tlet restrictions = {};\r\n\t\t\t_(attrs).each((value, key) => {\r\n\t\t\t\tlet pick = false;\r\n\t\t\t\tkey = key.toLowerCase();\r\n\t\t\t\tif (pickNumbers.indexOf(key) > -1) {\r\n\t\t\t\t\tvalue = convert(value, 'number');\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickStrings.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickBools.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t\tvalue = convert(value, 'boolean', { returnNullAndEmptyAs: true, returnOtherAs: true });\r\n\t\t\t\t}\r\n\t\t\t\tpick && (restrictions[key] = value);\r\n\t\t\t});\r\n\t\t\tthis.restrictions = restrictions;\t\t\r\n\t\t},\r\n\t\tsetControlValue(value, opts = {})\r\n\t\t{\r\n\t\t\tthis.value = this.prepareValueBeforeSet(value);\r\n\t\t\tif(!opts.silent)\r\n\t\t\t\tthis.triggerControlChange();\r\n\t\t\treturn this.value;\r\n\t\t},\r\n\t\tprepareValueBeforeSet(value){\r\n\t\t\tif (value == null || value === '') return value;\r\n\t\t\t\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\tif (len > 0) {\r\n\t\t\t\tvalue = value.toString().substring(0, len);\r\n\t\t\t}\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tlet num = convert(value, 'number');\r\n\t\t\t\tif(isNaN(num))\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlet min = this.restrictions.min;\r\n\t\t\t\tlet max = this.restrictions.max;\r\n\t\t\t\t!isNaN(min) && num < min && (num = min);\r\n\t\t\t\t!isNaN(max) && num > max && (num = max);\r\n\t\t\t\treturn num;\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tgetValueType(){\r\n\t\t\treturn this.valueType;\r\n\t\t},\r\n\t\tconvertValue(value){\r\n\t\t\treturn convert(value, this.getValueType());\r\n\t\t},\t\t\r\n\t\tgetMaxLength()\r\n\t\t{\r\n\t\t\treturn this.restrictions.maxlength;\r\n\r\n\t\t},\r\n\t\tisLengthValid(){\r\n\t\t\tlet value = this.getControlValue();\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\treturn len == null || value.length < len;\r\n\t\t},\r\n\t\tisEnteredCharValid(char) {\r\n\t\t\tlet type = this.getValueType();\r\n\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn ['.','-'].indexOf(char) > -1 || !isNaN(parseInt(char, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tisValueValid(value){\r\n\t\t\tlet type = this.getValueType();\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn !isNaN(parseFloat(value, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tvalidateControlValue(value){\r\n\t\t\tif (value == null || value === '') {\r\n\t\t\t\tif(this.restrictions.required)\r\n\t\t\t\t\treturn 'required';\r\n\t\t\t\telse\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet strValue = value.toString();\r\n\t\t\tif (_.isNumber(this.restrictions.maxlength) && strValue.length > this.restrictions.maxlength)\r\n\t\t\t\treturn 'length:big';\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tif (!_.isNumber(value))\r\n\t\t\t\t\treturn 'not:number';\r\n\t\t\t\tif (_.isNumber(this.restrictions.min) && value < this.restrictions.min)\r\n\t\t\t\t\treturn 'less:than:min';\r\n\t\t\t\tif (_.isNumber(this.restrictions.max) && value > this.restrictions.max)\r\n\t\t\t\t\treturn 'greater:than:max';\r\n\t\t\t}\r\n\t\t\tif (this.restrictions.pattern) {\r\n\t\t\t\tlet pattern = RegExp(this.restrictions.pattern);\r\n\t\t\t\tif (pattern.test(strValue)) {\r\n\t\t\t\t\treturn 'pattern:mismatch';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n};\r\n","function pstoSetPair(context, pair){\r\n\tif(!_.isString(pair)) return;\r\n\tlet keyvalue = pair.split('=');\r\n\tlet key = keyvalue.shift();\r\n\tlet value = keyvalue.join('=');\r\n\tpstoSetKeyValue(context, key, value);\r\n}\r\n\r\nfunction pstoSetKeyValue(context, key, value){\r\n\t\t\r\n\tif (key == null) return;\r\n\tkey = decodeURIComponent(key);\r\n\tvalue != null && (value = decodeURIComponent(value));\r\n\r\n\tif(!(key in context))\r\n\t\treturn (context[key] = value);\r\n\r\n\t!_.isArray(context[key]) && (context[key] = [context[key]]);\r\n\r\n\tcontext[key].push(value);\r\n\r\n\treturn context[key];\r\n}\r\n\r\nexport default function paramsToObject(raw, opts = {emptyObject: true}){\r\n\tlet result = {};\r\n\tif(!_.isString(raw)) return opts.emptyObject ? result : raw;\r\n\r\n\tlet pairs = raw.split('&');\r\n\t_(pairs).each((pair) => pstoSetPair(result, pair));\r\n\t\r\n\treturn result;\r\n}\r\n","import result from '../../../utils/better-result';\r\n\r\nfunction get(router, opts = {}, key, update){\r\n\t\r\n\tlet value = result(opts, key, { context: router, args:[ router ] });\r\n\tif(value == null) {\r\n\t\tvalue = router.getOption(key, {args: [ router ]});\r\n\t\tif(update)\r\n\t\t\topts[key] = value;\r\n\t}\r\n\treturn value;\t\t\r\n}\r\n\r\n// converts route method arguments to plain object;\r\n// _normalizeRegisterRouteArguments\r\n// { route, rawRoute, callback, name }\r\nexport default function routeArgumentsToObject(router, route, name, callback, opts = {}){\r\n\r\n\tlet context = {};\r\n\r\n\tif(_.isObject(route)){\r\n\t\tcontext = route;\r\n\t\t//_.extend(context, route);\r\n\t\t//then second argument is probably options;\r\n\t\t_.extend(opts, name);\r\n\r\n\t} else if (_.isFunction(name)) {\r\n\t\t_.extend(context, { route, callback: name, name: _.uniqueId('routerAction') });\r\n\t} else {\r\n\t\t_.extend(context, { route, name, callback });\r\n\t}\r\n\r\n\tlet isRouterHoldsActions = get(router, opts, 'isRouterHoldsActions', true);\r\n\t//let isRouteChaining = get(router, opts, 'isRouteChaining', true);\r\n\r\n\t// !_(opts).has('isRouterHoldsActions') && (opts.isRouterHoldsActions = this.getOption('isRouterHoldsActions'));\r\n\t// !_(opts).has('isRouteChaining') && (opts.isRouteChaining = this.getOption('isRouteChaining'));\r\n\r\n\r\n\t// last chance to get callback from router instance by name\r\n\t// this behavior can be disabled through `isRouterHoldsActions` options\r\n\tif(!_.isFunction(context.callback) && isRouterHoldsActions && _.isFunction(router[context.name])) {\r\n\r\n\t\tcontext.callback = router[context.name];\r\n\r\n\t}\r\n\r\n\t//store original route\r\n\tcontext.rawRoute = context.route;\r\n\r\n\t!context.name && (context.name = _.uniqueId('routerAction'));\r\n\r\n\t//converts route to RegExp pattern\r\n\tif (!_.isRegExp(context.route)) context.route = router._routeToRegExp(context.route);\r\n\r\n\t// by default backbone router wraps every callback with own wrapper\r\n\t// which in turn call actual callback with correct arguments on route\r\n\t// this callback was inlined and can not be overrided, so now its possible\t\r\n\tcontext.callbackWrapper = _.bind(router._processCallback, router, context);\r\n\r\n\treturn context;\r\n}\r\n\r\n\r\n\r\n","export function createActionContext(router, routeContext, fragment, options = {}) {\r\n\r\n\tlet rawArgs = router._extractParameters(routeContext.route, fragment);\r\n\r\n\tlet result = _.extend({}, routeContext, { fragment, rawArgs }, options, { options });\r\n\r\n\tlet args = rawArgs.slice(0);\r\n\tlet queryString = args.pop();\r\n\r\n\t_.extend(result, { qs: prepareActionQueryString(router, queryString) });\r\n\t_.extend(result, { args: prepareActionArguments(routeContext.rawRoute, args) });\r\n\r\n\tif (result.routeType == null) {\r\n\t\tresult.routeType = 'route';\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction prepareActionQueryString(router, queryString){\r\n\tif(_.isString(queryString))\r\n\t\treturn router.queryStringParser(queryString);\r\n\telse\r\n\t\treturn {};\r\n}\r\n\r\nfunction prepareActionArguments(rawRoute, args){\r\n\r\n\tlet params = rawRoute.match(/:([^/|)]+)/g) || [];\r\n\t\r\n\tlet res = {};\r\n\t_(params).each((name, index) => {\r\n\t\tname = name.substring(1);\r\n\t\t\r\n\t\tif(args == null) return;\r\n\r\n\t\tif(name in res && _.isArray(res[name]))\r\n\t\t\tres[name].push(args[index]);\r\n\t\telse if(name in res && !_.isArray(res[name]))\r\n\t\t\tres[name] = [res[name]].concat(args[index]);\r\n\t\telse\r\n\t\t\tres[name] = args[index];\r\n\t});\r\n\treturn res;\r\n}\r\n","\r\nfunction toPromise(arg, resolve = true){\r\n\tif (arg instanceof Promise || (arg && _.isFunction(arg.then)))\r\n\t\treturn arg;\r\n\telse if (arg instanceof Error)\r\n\t\treturn Promise.reject(arg);\r\n\telse\r\n\t\treturn resolve \r\n\t\t\t? Promise.resolve(arg) \r\n\t\t\t: Promise.reject(arg);\r\n}\r\nfunction getCallbackFunction(callback, executeResult)\r\n{\r\n\treturn (...args) => {\r\n\t\ttry {\r\n\t\t\texecuteResult.value = callback && callback(...args);\r\n\t\t} catch(exception) {\r\n\t\t\texecuteResult.value = exception;\r\n\t\t}\r\n\t\texecuteResult.promise = toPromise(executeResult.value);\r\n\t\treturn executeResult.value;\r\n\t};\r\n}\r\n\r\n\r\nexport function processCallback(router, actionContext, routeType){\t\r\n\t\r\n\tlet args = router.getOption('classicMode') \r\n\t\t? actionContext.rawArgs || [] \r\n\t\t: [ actionContext ];\r\n\r\n\tlet asPromise = router.getOption('callbackAsPromises');\r\n\tlet executeResult = {};\r\n\tlet callback = getCallbackFunction(actionContext.callback, executeResult, asPromise);\r\n\r\n\t//console.log('routeType:',routeType);\r\n\r\n\trouter.triggerEvent('before:' + routeType, actionContext);\r\n\r\n\tlet shouldTriggerEvent = router.execute(callback, args);\r\n\tif (shouldTriggerEvent !== false) {\r\n\t\trouter.triggerEvent(routeType, actionContext);\r\n\t\tif(routeType == 'route' || routeType == 'backroute')\r\n\t\t\trouter.lastAttempt = actionContext;\r\n\t}\r\n\r\n\texecuteResult.promise.then(\r\n\t\t(arg) => {\r\n\t\t\trouter.triggerEvent('after:'+routeType, actionContext);\r\n\t\t\treturn arg;\r\n\t\t},\r\n\t\t(error) => {\r\n\t\t\trouter.triggerEvent('error:' + routeType, error, actionContext);\r\n\t\t\trouter.handleError(error, actionContext);\r\n\t\t}\r\n\t);\r\n\r\n\treturn executeResult.value;\r\n}\r\n\r\n\r\n\r\n","\r\nexport default {\r\n\thandlers: {\r\n\t\t'js:error'(error){\r\n\t\t\tthrow error;\r\n\t\t},\r\n\t},\r\n\thandle(error, context, args){\r\n\r\n\t\tlet handlers = this._getHandleContext(error, context, args) || {};\r\n\t\treturn _(handlers).some((options, key) => this.applyHandler(key, options));\r\n\r\n\t},\r\n\tapplyHandler(key, options = {}){\r\n\r\n\t\tlet handler = this.getHandler(key, options);\r\n\t\tif (!handler) return;\r\n\t\tlet { context, args } = options;\r\n\t\treturn handler.apply(context, args);\r\n\r\n\t},\r\n\tgetHandler(key){\r\n\t\tif(_.isFunction(this.handlers[key]))\r\n\t\t\treturn this.handlers[key];\r\n\t},\r\n\tsetHandler(key, handler){\r\n\t\tif(!_.isString(key) || key === '')\r\n\t\t\tthrow new Error('setHandler first argument must be a non empty string');\r\n\r\n\t\tif (!_.isFunction(handler)) {\r\n\t\t\tdelete this.handlers[key];\r\n\t\t} else {\r\n\t\t\tthis.handlers[key] = handler;\r\n\t\t}\r\n\t},\r\n\tsetHandlers(hash){\r\n\t\tlet nullable = hash === null;\r\n\t\tlet items = nullable && this.handlers || hash;\r\n\t\tif(!_.isObject(items)) return;\r\n\t\t_(items).each((handler, key) => this.setHandler(key, nullable || handler));\r\n\t},\r\n\r\n\t// should return hash: { 'handler_key': { context: handler_context, args: handler_arguments}}\r\n\t_getHandleContext(error, context, args = []){\r\n\r\n\t\tif (_.isArray(error)) {\r\n\t\t\treturn _(error).reduce((memo, item) => _.extend(memo, this._getHandleContext(item, context, args)), {});\r\n\t\t}\r\n\r\n\t\tif(_.isFunction(this.getHandleContext)) {\r\n\t\t\tlet custom = this.getHandleContext(error, context, args);\r\n\t\t\tif(custom != null) return custom;\r\n\t\t}\r\n\r\n\t\tif (error instanceof Error) {\r\n\t\t\targs.unshift(error);\r\n\t\t\treturn { 'js:error': { context, args } };\r\n\t\t}\r\n\t\telse if(_.isString(error)) {\r\n\t\t\treturn { [error]: { context, args } };\r\n\t\t}\r\n\t\telse if(error instanceof $.Deferred().constructor){\r\n\t\t\targs.unshift(error);\r\n\t\t\treturn { 'jq:xhr': { context, args }};\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// provide your own arguments processor\r\n\t// should return hash: { 'handler_key': { context: handler_context, args: handler_arguments}}\r\n\tgetHandleContext: undefined,\r\n\r\n};\r\n","import mix from '../../../utils/mix';\r\nimport GetOptionMixin from '../../../mixins/common/get-option';\r\nimport paramStringToObject from '../../../utils/params-to-object';\r\nimport { Router as BbRouter } from '../../../vendors/backbone';\r\n\r\nimport buildRouteContextFromArguments from './build-route-context';\r\n\r\nimport  { createActionContext } from './action-context';\r\nimport { processCallback } from './process-callback';\r\nimport errorHandler from '../route-error-handler';\r\n\r\n\r\nconst BaseRouter = mix(BbRouter).with(GetOptionMixin);\r\nconst Router = BaseRouter.extend({\r\n\r\n\r\n\t// for migrating from Mn.AppRoute\r\n\t// set to true. it will populate routes from { controller, appRoutes } structure.\r\n\tisMarionetteStyle: false,\r\n\r\n\t// by default Backbone.Router tries to lookup callback in router instance by name `callback = this[name]` if there is no callback provided\r\n\t// its recomend to turn this feature to false\r\n\t// default value is true for Backbone.Router compatability\r\n\tisRouterHoldsActions : true,\r\n\r\n\t// by default Backbone.Router `route` method returns router itself instead of just created routeContext for chaining purposes.\r\n\t// you can change this behavior turning this feature to false\r\n\tisRouteChaining: true,\r\n\r\n\t//in classic mode actions receive argument array\r\n\t//if you need actionContext instead turn this option to false\r\n\tclassicMode: true,\r\n\r\n\tconstructor(options = {}){\r\n\t\t\r\n\t\tthis.options = _.extend({}, _.result(this, 'options'), options);\r\n\r\n\t\tBaseRouter.apply(this, arguments);\r\n\r\n\t\t//this.on('re:route:last', this._onReRouteLast);\r\n\t},\r\n\r\n\r\n\t/*\r\n\r\n\t\tinitialize methods\r\n\t\t\"when a router initialized\"\r\n\r\n\t*/\r\n\r\n\t//by default router expects that routes will result in { route, callback } hash\r\n\t//we are extending this to provide more flexibility\r\n\t// - overrided\r\n\t_bindRoutes: function() {\r\n\t\t\r\n\t\tlet routes = this.getInitRoutes();\r\n\t\tif(!_.size(routes)) return;\r\n\t\tthis.addRoutes(routes);\r\n\r\n\t},\r\n\tgetInitRoutes(){\r\n\t\tlet routes;\r\n\t\tif(this.getOption('isMarionetteStyle')) {\r\n\t\t\tlet controller = this.getOption('controller') || {};\r\n\t\t\tlet approutes = this.getOption('appRoutes') || {};\r\n\t\t\troutes = _(approutes).map((name, route) => ({ \r\n\t\t\t\troute, name, \r\n\t\t\t\tcallback: controller[name] \r\n\t\t\t}));\r\n\t\t}\r\n\t\telse {\r\n\t\t\troutes = this.getOption('routes');\r\n\t\t}\r\n\t\treturn routes;\r\n\t},\r\n\r\n\r\n\t/*\r\n\t\tmanipulating routes\r\n\t\tadding\r\n\t*/\r\n\r\n\t// refactored original route method\r\n\t// chain:true by default is for supporting default behavior\r\n\t// routerHoldsActions: true - backbone router tries to get callback from router itself if there is no callback provided. \r\n\t// this options allow to support this behavior, but its recomended not to hold action inside router instance\r\n\t// - overrided\r\n\troute(route, name, callback, opts = {}){\r\n\t\t\r\n\t\t//normalizing passed arguments and putting them into a context object\r\n\t\t//refactored from original route\r\n\t\t// let context = this._normalizeRegisterRouteArguments(route, name, callback, opts);\r\n\r\n\t\t// //extends context with result of `mergeWithRegisterRouteContext`\r\n\t\t// this._normalizeRegisterRouteContext(context);\r\n\r\n\t\t// //wrapping provided callback \r\n\t\t// this._normalizeRegisterRouteCallback(context);\r\n\r\n\t\tlet context = this._buildRouteContext(route, name, callback, opts);\r\n\r\n\t\t//refactored for providing possibility to override\r\n\t\t//at this point context should be almost ready\r\n\t\tthis.registerRouteContext(context);\r\n\r\n\t\tthis._storeCreatedContext(context, opts);\r\n\r\n\t\treturn opts.isRouteChaining === true \r\n\t\t\t? this \r\n\t\t\t: context;\r\n\r\n\t},\r\n\r\n\t// provide more semantic alias for route\r\n\taddRoute(route, name, callback, opts = {}){\r\n\t\tif(opts.isRouteChaining == null)\r\n\t\t\topts.isRouteChaining = this.getOption('isRouteChaining');\r\n\r\n\t\tlet context = this.route(route, name, callback, opts);\r\n\t\treturn context;\r\n\t},\r\n\r\n\t//process many routes at once\r\n\t//accepts object { name, routeContext | handler }\r\n\t// or array of routeContexts\r\n\taddRoutes(routes, opts = {}){\r\n\r\n\t\tif(opts.isRouteChaining == null)\r\n\t\t\topts.isRouteChaining = this.getOption('isRouteChaining');\r\n\r\n\t\tlet normalized = _(routes)\r\n\t\t\t.chain()\r\n\t\t\t.map((value, key) => this._normalizeRoutes(value, key))\r\n\t\t\t.filter(f => _.isObject(f))\r\n\t\t\t.value();\r\n\r\n\t\tif(opts.doNotReverse != true)\r\n\t\t\tnormalized.reverse();\r\n\r\n\t\tlet registered = _(normalized).map(\r\n\t\t\troute => route && \r\n\t\t\tthis.addRoute(route, _.extend({ massAdd:true }, opts))\r\n\t\t); \r\n\t\t\r\n\t\tif(opts.doNotReverse != true)\r\n\t\t\tregistered.reverse();\r\n\r\n\t\t_(registered).each((c) => this._storeCreatedContext(c));\r\n\t\t\r\n\t\treturn registered;\r\n\t},\r\n\r\n\t// internal method called by `addRoutes` to normalize provided data\r\n\t_normalizeRoutes(value, key){\r\n\t\t//let route, name, callback;\r\n\t\tlet context;\r\n\t\tif (_.isString(value)) {\r\n\t\t\tcontext = { \r\n\t\t\t\troute: key, \r\n\t\t\t\tname: value, \r\n\t\t\t};\r\n\t\t}\r\n\t\telse if(_.isFunction(value)){\r\n\t\t\tcontext = { route:key, callback:value };\r\n\t\t}else if(_.isObject(value)){\r\n\t\t\tcontext = _.clone(value);\r\n\t\t\tif(!_.has(context, 'route'))\r\n\t\t\t\tcontext.route = key;\r\n\t\t\telse if(_.has(context, 'route') && !_.has(context, 'name'))\r\n\t\t\t\tcontext.name = key;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn context;\r\n\t},\r\n\r\n\r\n\r\n\r\n\t_buildRouteContext(route, name, callback, opts) {\r\n\r\n\t\tlet context = buildRouteContextFromArguments(this, route, name, callback, opts);\r\n\r\n\t\treturn this.buildRouteContext(context);\r\n\t},\r\n\r\n\t//override this method if you need more information in route context\r\n\t// should return object wich will be merged with default context\r\n\t// be aware of providing reserved properties: route, name, callback\r\n\t// this will override context defaults\r\n\tbuildRouteContext: context => context,\r\n\r\n\r\n\t//finally, putting handler to the backbone.history.handlers\r\n\tregisterRouteContext(context){\r\n\t\tBackbone.history.route(context.route, context.callbackWrapper, context);\r\n\t},\r\n\r\n\t//store registered context for further use\r\n\t_storeCreatedContext(context, opts = {}){\r\n\t\tthis.routeContexts || (this.routeContexts = {});\r\n\t\tif(!opts.massAdd)\r\n\t\t\tthis.routeContexts[context.name] = context;\r\n\t\treturn context;\r\n\t},\r\n\r\n\r\n\r\n\t/*\r\n\t\r\n\t\tprocess route methods\t\t\r\n\t\t\"when route happens\"\r\n\r\n\t*/\r\n\r\n\t//inner route handler\r\n\t//preparing actionContext and calls public processCallback\r\n\t_processCallback (routeContext, fragment, options = {}) {\r\n\t\tlet actionContext = createActionContext(this, routeContext, fragment, options);\r\n\t\tactionContext.restart = () => actionContext.callbackWrapper(fragment, options);\r\n\t\tlet result = this.processCallback(actionContext, actionContext.routeType, options);\r\n\t\treturn result;\r\n\t},\r\n\t\r\n\t//by default behave as original router\r\n\t//override this method to process action by your own\r\n\tprocessCallback(actionContext, routeType){\r\n\r\n\t\treturn processCallback(this, actionContext, routeType);\r\n\r\n\t},\r\n\r\n\thandleError(error, action){\t\t\r\n\t\terrorHandler.handle(error, this, [action]);\r\n\t},\r\n\r\n\t//just triggers appropriate events\r\n\t// triggerRouteEvents(context, event, name, ...args) {\r\n\t// \tif (event == 'route') {\r\n\t// \t\tthis.lastActionContext = context;\r\n\t// \t}\r\n\t// \tthis.trigger(`${event}:${name}`, ...args);\r\n\t// \tthis.trigger(event, name, ...args);\r\n\t// \tBackbone.history.trigger(event, this, name, ...args);\r\n\t// },\r\n\r\n\ttriggerEvent(event, context){\r\n\t\tthis.trigger(event, context);\r\n\t\tBackbone.history.trigger(event, context);\r\n\t},\r\n\r\n\r\n\r\n\r\n\t//converts string to object\r\n\t//default implementation, can be overriden by user\r\n\tqueryStringParser: paramStringToObject,\t\r\n\r\n\t// navigate(...args){\r\n\t// \thistoryNavigate(...args);\r\n\t// \treturn this;\r\n\t// },\r\n\r\n\t_routeToRegExp(route) {\r\n\r\n\t\tvar optionalParam = /\\((.*?)\\)/g;\r\n\t\tvar namedParam    = /(\\(\\?)?:\\w+/g;\r\n\t\tvar splatParam    = /\\*\\w+/g;\r\n\t\tvar escapeRegExp  = /[-{}[]+?.,\\\\\\^$|#\\s]/g;\r\n\r\n\t\troute = route.replace(escapeRegExp, '\\\\$&')\r\n\t\t\t.replace(optionalParam, '(?:$1)?')\r\n\t\t\t.replace(namedParam, function(match, optional) {\r\n\t\t\t\treturn optional ? match : '([^/?]+)';\r\n\t\t\t})\r\n\t\t\t.replace(splatParam, '([^?]*?)');\r\n\t\tlet flags = this.getOption('routeCaseInsensitive') ? 'i' : '';\r\n\t\treturn new RegExp('^' + route + '(?:\\\\?([\\\\s\\\\S]*))?$', flags);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t\tSome API methods\r\n\t*/\r\n\r\n\tgetContextByFragment(fragment)\t{\r\n\t\tif(!_.isString(fragment)) return;\r\n\t\t//let contexts = this.routeContexts;\r\n\t\t//console.log('Router contexts', contexts);\r\n\t\tlet result = _(this.routeContexts).find((cntx) => cntx.route.test(fragment));\r\n\t\treturn result;\r\n\t}\r\n\r\n\r\n});\r\n\r\nexport default Router;\r\n","import Process from '../../process';\r\nimport BaseRouter from '../router';\r\nimport errorHandler from '../route-error-handler';\r\n\r\nexport default BaseRouter.extend({\r\n\t\r\n\tclassicMode:false,\r\n\tisRouterHoldsActions : false,\r\n\tisRouteChaining: false,\t\r\n\tcallbackAsPromises: true,\r\n\trouteCaseInsensitive: true,\r\n\tregisterPageRoutes(page){\r\n\t\tlet contexts = page.getRoutesContexts({ reverse: true });\r\n\t\t_(contexts).each(context => {\r\n\t\t\tlet callback = (...args) => {\r\n\t\t\t\treturn this.startPage(page, ...args);\r\n\t\t\t};\r\n\t\t\tthis.addRoute(context.route, context.name, callback);\r\n\t\t});\r\n\t},\r\n\thandleError(process, action){\r\n\t\tlet args, error;\r\n\r\n\t\tif(process instanceof Process) {\r\n\t\t\targs = [].slice.call(process.errors) ;\r\n\t\t\terror = args.shift();\r\n\t\t\targs.push(action);\r\n\t\t} else {\r\n\t\t\terror = process;\r\n\t\t\targs = [action];\r\n\t\t}\r\n\r\n\t\terrorHandler.handle(error, this, args);\r\n\r\n\t\t//BaseRouter.prototype.handleError(error, action);\r\n\t},\r\n\tstartPage(page, ...args){\r\n\t\treturn this.beforePageStart(page)\r\n\t\t\t.then(() => page.start(...args))\r\n\t\t\t.then(() => this.afterPageStart(page, ...args));\r\n\t},\r\n\tbeforePageStart(){\r\n\t\tif (this.previousPage && this.previousPage.isStarted())\r\n\t\t\treturn this.previousPage.stop();\r\n\t\telse\r\n\t\t\treturn Promise.resolve();\r\n\t},\r\n\tafterPageStart(page){\r\n\t\tthis.previousPage = page;\r\n\t},\r\n\trestartLastAttempt(){\r\n\t\tif(this.lastAttempt)\r\n\t\t\treturn this.lastAttempt.restart();\r\n\t}\r\n});\r\n","import { isModel, isView } from '../../vendors/helpers';\r\nexport default function getModel(arg){\r\n\r\n\tif (isModel(arg)) { return arg; }\r\n\t\r\n\tif (isView(arg)) { return arg.model; }\r\n\r\n}\r\n","import { isView }  from '../../vendors/helpers';\r\nexport default function getModel(arg){\r\n\treturn isView(arg) && arg;\r\n}\r\n","\r\nimport getModel from './get-model';\r\nimport getView from './get-view';\r\nexport default function compareAB(a, b, func){\r\n\tif(_.isArray(func)) {\r\n\r\n\t\tlet result = 0;\r\n\r\n\t\t_(func).every((f) => {\r\n\t\t\tresult = compareAB(a,b,f);\r\n\t\t\treturn result === 0;\r\n\t\t});\r\n\t\t\r\n\t\treturn result;\r\n\t} else {\r\n\t\tif (_.isFunction(func)) {\r\n\t\t\ta = func.call(a, getModel(a), getView(a)) ;\r\n\t\t\tb = func.call(b, getModel(b), getView(b));\r\n\t\t}\r\n\r\n\t\tif (a < b) return -1;\r\n\t\tif (a > b) return 1;\r\n\t\treturn 0;\r\n\r\n\t}\r\n}\r\n","import compareAB from '../compare-ab';\r\nexport default function comparator(...args){\r\n\tvar result = 0;\r\n\r\n\t//for simple case (arg1, arg2, compare)\r\n\tif (args.length <= 3 && !_.isArray(args[0])){\r\n\r\n\t\treturn compareAB.apply(null, args);\r\n\r\n\t} \r\n\t//for complex cases ([arg1, arg2, compare], [], .... [])\r\n\t//each arguments should be an array\r\n\telse {\r\n\r\n\t\t_(args).every((single) => {\r\n\r\n\t\t\tif(!_.isArray(single)) return true;\r\n\t\t\tresult = compareAB(...single);\r\n\t\t\treturn result === 0;\r\n\t\t});\r\n\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n","import BaseRouter from './router';\r\nimport comparator from '../../../utils/comparator';\r\n\r\nexport default {\r\n\tinitializeRoutes(){\r\n\t\tif (this.initializeRouter()) {\r\n\t\t\tthis._buildRoutesContexts();\r\n\r\n\t\t}\r\n\t},\r\n\tinitializeRouter(){\t\t\r\n\t\tif(this.getOption('shouldCreateRouter') && !this.router) {\r\n\t\t\tthis.router = this._createRouter();\r\n\t\t\tthis._shouldRegisterAllRoutes = true;\r\n\t\t}\r\n\r\n\t\treturn !!this.router;\r\n\t},\r\n\t_createRouter(){\r\n\t\tlet Router = this.getOption('Router') || BaseRouter;\r\n\t\tlet options = _.extend({}, this.getOption('routerOptions'));\r\n\t\treturn new Router(options);\r\n\t},\r\n\tregisterAllRoutes(){\r\n\t\tif(!this._shouldRegisterAllRoutes) return;\r\n\r\n\t\tlet pages = this.getAllChildren({ reverse: true, includeSelf: true, force: true });\r\n\t\t\r\n\t\tlet router = this.router;\r\n\t\t_(pages).each(page => router.registerPageRoutes(page));\r\n\t\t\r\n\t},\r\n\t_buildRoutesContexts(){\r\n\t\tlet routes = this.getOption('routes', {args: [this]});\r\n\t\tif (routes == null) return;\r\n\t\tif(_.isString(routes))\r\n\t\t\troutes = [routes];\r\n\r\n\t\tlet result = [];\r\n\t\tlet config = this.getRoutesConfig();\r\n\t\t_(routes).each((route, index) => {\r\n\t\t\tlet context = this._normalizeRoutesContextRoute(route, index, config);\r\n\t\t\t_.isObject(context) && (result.push(context));\r\n\t\t});\r\n\t\tthis.routesContext = result;\r\n\t\treturn this.routesContext;\r\n\t},\r\n\t_normalizeRoutesContextRoute(arg, index, config = {}){\r\n\t\tif(arguments.length < 2){\r\n\t\t\tconfig = this.getRoutesConfig();\r\n\t\t}\r\n\t\tlet context = { page: this };\r\n\t\tif(arg == null)\r\n\t\t\treturn;\r\n\t\tif (_.isString(arg)) {\r\n\t\t\t_.extend(context, {route: arg, rawRoute: arg });\r\n\t\t} else if(_.isFunction(arg)) {\r\n\t\t\targ = arg.call(this, this, index);\r\n\t\t\treturn this._normalizeRoutesContextRoute(arg, index);\r\n\t\t} else {\r\n\t\t\t_.extend(context, arg);\r\n\t\t}\r\n\t\tlet name = (_.isString(index) && index) || context.name || context.route || _.uniqueId('route');\r\n\t\tcontext.name = name;\r\n\r\n\t\tif(_.isNumber(index) && context.order == null)\r\n\t\t\tcontext.order = index;\r\n\r\n\t\tif (!context.rawRoute)\r\n\t\t\tcontext.rawRoute = context.route;\r\n\t\t\t\t\r\n\t\tif(config.relative && config.parentContext && config.parentContext.route)\r\n\t\t\tcontext.route = config.parentContext.route + '/' + context.route;\r\n\r\n\t\treturn context;\r\n\t},\r\n\tgetRoutesConfig(){\r\n\t\tlet config = _.extend({ \r\n\t\t\trelative: this.getOption('relativeRoutes', {args: [this]}),\r\n\t\t\tparent: this.parent,\r\n\t\t\tparentContext: this.parent && _.isFunction(this.parent.getMainRouteContext) && this.parent.getMainRouteContext()\r\n\t\t}, this.getOption('routesConfig', {args: [this]}));\r\n\t\t\r\n\t\treturn config;\r\n\t},\r\n\tgetRoutesContexts(opts = {}){\r\n\t\tlet { clone, reverse } = opts;\r\n\t\tlet result = this.routesContext || [];\r\n\t\tif (clone || reverse) result = [].slice.call(result);\r\n\t\tif (reverse) result.reverse();\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetMainRouteContext(){\r\n\r\n\t\tif(this.mainRouteContext) return this.mainRouteContext;\r\n\t\tthis.mainRouteContext = _(this.getRoutesContexts())\r\n\t\t\t.chain()\r\n\t\t\t.sortBy((a,b) => comparator([ [b,a, c => c.main], [a,b, c => c.order] ]))\r\n\t\t\t.take(1)\r\n\t\t\t.value()[0];\r\n\r\n\t\treturn this.mainRouteContext;\r\n\t}\r\n};\r\n","import { MnObject } from '../../../vendors/marionette';\r\nimport mix from '../../../utils/mix';\r\nimport GetOptionMixin from '../../../mixins/common/get-option';\r\nimport StartableMixin from '../../../mixins/common/startable';\r\nimport ChildrenableMixin from '../../../mixins/common/childrenable';\r\nimport RoutesMixin from './routes-mixin';\r\n\r\nconst BasePage = mix(MnObject).with(GetOptionMixin, ChildrenableMixin, StartableMixin, RoutesMixin);\r\n\r\nexport default BasePage.extend({\r\n\tconstructor(opts = {}){\r\n\t\tBasePage.apply(this, arguments);\r\n\r\n\t\tthis.mergeOptions(opts, ['root','parent','router','canNotStart','onStart','onBeginStart', 'onBeforeStart', 'onEndStart', 'onStop', 'onBeginStop', 'onBeforeStop', 'onEndStop']);\r\n\t\t\r\n\t\t// resides in routes-mixin\r\n\t\tthis.initializeRoutes();\r\n\r\n\t\t// resides in ChildrenableMixin\r\n\t\tthis.initializeChildren();\r\n\t\t\r\n\t\t// resides in routes-mixin\r\n\t\tthis.registerAllRoutes();\r\n\t},\r\n\r\n\tgetLabel(){\r\n\t\tlet result = this.getOption('label', { args: [this, this.model]});\r\n\t\treturn result;\r\n\t},\r\n\tgetMenuLabel(){\r\n\t\tlet result = this.getOption('menuLabel', { args: [this, this.model], default: this.getLabel()});\r\n\t\treturn result;\r\n\t},\r\n\r\n\tbuildChildOptions(options){\r\n\t\treturn _.extend({\r\n\t\t\troot: this.root,\r\n\t\t\tparent: this.parent,\r\n\t\t\trouter: this.router,\r\n\t\t}, options);\r\n\t},\r\n\r\n\tgetSiblings(opts = {}){\r\n\t\tlet parent = this.getParent();\r\n\t\tlet options = _.extend({ exclude: [this] }, opts);\r\n\t\treturn parent && parent.getChildren(options) || [];\r\n\t\t// if(_.isFunction(opts.map))\r\n\t\t// \treturn _(pages).chain().map(opts.map).filter(f => !!f).value();\r\n\t\t// else\r\n\t\t// \treturn pages;\r\n\t},\r\n\tgetChildrenHashes(){\r\n\t\treturn this.getChildren({ map: i => i.getHash(), visible: true, });\r\n\t},\r\n\tgetSiblingsHashes(){\r\n\t\treturn this.getSiblings({ map: i => i.getHash(), visible: true, });\r\n\t},\r\n\r\n\tgetAllPages(opts = {}){\r\n\t\t\r\n\t\tlet options = _.extend({}, opts, { includeSelf: true });\r\n\t\tdelete options.map;\r\n\t\tlet pages = this.root.getAllChildren(options);\r\n\r\n\t\tif (_.isFunction(opts.map)) {\r\n\t\t\treturn _(pages).chain().map(opts.map).filter(f => !!f).value();\r\n\t\t} else {\r\n\t\t\treturn pages;\r\n\t\t}\r\n\t},\r\n\tgetAllHashes(opts = {}){\r\n\t\tlet options = _.extend({ map: i => i.getHash(), visible: true, }, opts);\r\n\t\treturn this.getAllPages(options);\r\n\t},\r\n\tgetHash(){\r\n\t\tlet context = this.getMainRouteContext();\r\n\r\n\t\tif(!_.isObject(context))\r\n\t\t\treturn;\r\n\r\n\t\tlet parent = this.getParent();\r\n\t\tlet parentCid = parent && parent.cid || undefined;\t\t\r\n\t\treturn {\r\n\t\t\tcid: this.cid,\r\n\t\t\tparentCid,\r\n\t\t\turl: context.route,\r\n\t\t\tlabel: this.getMenuLabel(),\r\n\t\t\torder: this.order,\r\n\t\t};\r\n\t},\r\n\r\n\r\n\t_childFilter(item, index, opts = {}) {\r\n\r\n\t\tif(!BasePage.prototype._childFilter.apply(this, arguments))\r\n\t\t\treturn;\r\n\r\n\t\tlet { visible } = opts;\r\n\r\n\t\tif(visible && (item.visible === false || item.hidden === true))\r\n\t\t\treturn;\r\n\r\n\t\treturn item;\r\n\t},\r\n\r\n});\r\n\r\n","import { history } from '../../../vendors/backbone';\r\nimport errorHandler from '../route-error-handler';\r\n\r\n// supports passing options to the callback\r\n// by using new version of loadUrl\r\nexport function historyNavigate(fragment, opts){\r\n\t\r\n\tlet options = opts === true ? { trigger: true }\r\n\t\t: _.isObject(opts) ? _.clone(opts)\r\n\t\t\t: {};\r\n\r\n\tlet { trigger } = options;\t\r\n\tdelete options.trigger;\r\n\r\n\thistory.navigate(fragment, options);\r\n\r\n\tif (trigger) {\r\n\t\treturn historyLoadUrl(fragment, opts);\r\n\t}\r\n\r\n}\r\n\r\n// original loadUrl does not pass options to the callback\r\n// and this one does\r\nexport function historyLoadUrl(fragment, opts = {}) {\r\n\r\n\t// If the root doesn't match, no routes can match either.\r\n\tif (!history.matchRoot()) return false;\r\n\tfragment = history.fragment = history.getFragment(fragment);\r\n\tlet executed = executeHandler(fragment, opts);\r\n\tif (!executed) {\r\n\t\terrorHandler.handle('not:found', opts.context, [fragment]);\r\n\t\t//history.trigger('handler:not:found', fragment, opts);\r\n\t}\r\n\treturn executed;\r\n}\r\n\r\n//TODO: think about constraints check\r\nfunction testHandler(handler, fragment){\r\n\treturn handler.route.test(fragment);\r\n}\r\n\r\nexport function findHandler(fragment, customTest){\r\n\tlet test = _.isFunction(customTest) ? customTest : testHandler;\r\n\tfragment = history.getFragment(fragment);\r\n\treturn _.filter(history.handlers || [], handler => test(handler, fragment))[0];\r\n}\r\n\r\nexport function executeHandler(fragment, opts = {}, resultContext = {}) {\r\n\tlet handler = findHandler(fragment, opts.testHandler);\r\n\thandler && (resultContext.value = handler.callback(fragment, opts));\r\n\treturn !!handler;\r\n}\r\n\r\nexport function start(options){\r\n\r\n\tif(history.loadUrl !== historyLoadUrl)\r\n\t\thistory.loadUrl = historyLoadUrl;\r\n\r\n\treturn history.start(options);\r\n}\r\n\r\nexport {\r\n\thistory\r\n};\r\n","import { history, historyNavigate }  from '../history';\r\nimport { Events } from '../../../vendors/backbone';\r\n\r\n\r\nexport default _.extend({\r\n\twatch(){\r\n\t\tthis.entries = [];\r\n\t\tthis.listenTo(history, 'route', this.onRoute);\r\n\t\tthis.listenTo(history, 'backroute', this.onBackRoute);\r\n\t},\r\n\tisActionContext: cntx => _.isObject(cntx) && _.isString(cntx.fragment),\r\n\thasElements(){\r\n\t\treturn this.entries.length > 0;\r\n\t},\r\n\tonRoute(actionContext){\r\n\r\n\t\tif(!this.isActionContext(actionContext))\r\n\t\t\treturn;\r\n\r\n\t\tif (this.isActionContext(this.lastElement)) {\r\n\t\t\tthis.entries.push(this.lastElement);\r\n\t\t}\r\n\t\tthis.lastElement = actionContext;\r\n\r\n\t},\r\n\tonBackRoute(actionContext){\r\n\t\tif(!this.isActionContext(actionContext) || !this.isActionContext(actionContext.gobackContext))\r\n\t\t\treturn;\r\n\r\n\t\tlet lookFor = actionContext.gobackContext;\r\n\t\tlet index = this.entries.indexOf(lookFor);\r\n\t\tif (index >= 0) {\r\n\t\t\tthis.entries = this.entries.slice(0, index);\r\n\t\t\tthis.lastElement = lookFor;\r\n\t\t}\r\n\r\n\t},\r\n\tgoBack(){\r\n\t\tlet last = this.hasElements() && _(this.entries).last();\r\n\t\thistoryNavigate(last.fragment, { trigger: true, routeType: 'backroute', gobackContext: last });\r\n\t},\r\n}, Events);\r\n","import { historyNavigate, executeHandler } from '../history';\r\n\r\nfunction normalizeOptions(type = 'route', opts = {}){\r\n\tif(_.isObject(type)) {\r\n\t\topts = type;\r\n\t\ttype = 'route';\r\n\t} \r\n\treturn _.extend({ routeType: type, trigger: true }, opts);\r\n}\r\n\r\nexport function execute(url, opts){\r\n\treturn go(url, 'execute', opts);\r\n}\r\nexport function navigate(url, opts){\r\n\treturn go(url, 'route', opts);\r\n}\r\nexport function navigateBack(url, opts){\r\n\treturn go(url, 'backroute', opts);\r\n}\r\n\r\nexport function go(url, type, opts)\r\n{\r\n\tlet options = normalizeOptions(type, opts);\r\n\tswitch(options.routeType){\r\n\tdefault:\r\n\tcase 'route':\r\n\tcase 'backroute':\r\n\t\treturn historyNavigate(url, options);\r\n\tcase 'execute':\r\n\t\treturn executeHandler(url, options);\r\n\t}\r\n\r\n}\r\n","import { Model, ajax as _nativeAjax } from '../../vendors/backbone';\r\nimport Backbone from 'backbone';\r\n\r\n// import Model from '../../b b/model';\r\n\r\nlet nativeAjax = _nativeAjax;\r\n\r\nconst tokenizedAjax = function(...args){\r\n\tlet options;\r\n\r\n\tif(args && args.length == 1 && _.isObject(args[0])){\r\n\t\toptions = args[0];\r\n\t}\r\n\tif(args && args.length == 2 && !_.isObject(args[0]) && _.isObject(args[1])){\r\n\t\toptions = args[1];\r\n\t}\r\n\r\n\toptions && (options.headers = _.extend({}, options.headers, this.getAjaxHeaders()));\r\n\r\n\treturn nativeAjax.apply($, args);\r\n};\r\n\r\n\r\nconst Token = Model.extend({\r\n\r\n\ttokenAttribute: 'access_token',\r\n\trefreshTokenAttribute: 'refresh_token',\r\n\tendPoint: 'auth/token',\r\n\tsecondsOffset: 0,\r\n\r\n\tshouldRequestOnInitialize: true,\r\n\r\n\tconstructor(){\r\n\t\tthis.ajaxHeaders = {};\r\n\t\tthis.flows = {};\r\n\t\tthis.initializeFlows();\r\n\t\tthis.setExpiration(null);\r\n\r\n\t\tModel.apply(this, arguments);\r\n\r\n\t\tif (this.shouldRequestOnInitialize) {\r\n\t\t\tthis.getReady();\r\n\t\t}\r\n\t},\r\n\r\n\tgetReady(){\r\n\t\tif(this.ready) return this.ready;\r\n\t\t\r\n\t\tif (!this.hasToken()) {\r\n\t\t\tthis.ready = Promise.resolve();\r\n\t\t} else {\r\n\t\t\tthis.ready = this.refresh({force: true}).catch(() => {\r\n\t\t\t\tthis.update(null);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this.ready;\r\n\t},\r\n\t\r\n\r\n\tinitializeFlows(){\r\n\r\n\t\tthis.setFlow('password', {\r\n\t\t\turl: this.endPoint,\r\n\t\t\tmethod: 'POST'\r\n\t\t});\r\n\t\tthis.setFlow('refresh', {\r\n\t\t\turl: this.endPoint,\r\n\t\t\tmethod: 'POST'\r\n\t\t});\r\n\r\n\t},\r\n\tgetFlow(key){\r\n\t\treturn _.clone(this.flows[key] || {});\r\n\t},\r\n\tsetFlow(key, value){\r\n\t\tthis.flows[key] = value;\r\n\t},\r\n\r\n\r\n\r\n\thasToken(){\r\n\t\treturn this.getToken() != null;\r\n\t},\r\n\tgetToken(){\r\n\t\treturn this.get(this.tokenAttribute);\r\n\t},\r\n\r\n\tgetRefreshToken(){\r\n\t\treturn this.get(this.refreshTokenAttribute);\r\n\t},\r\n\r\n\tgetAjaxHeaders(){\t\t\r\n\t\treturn this.ajaxHeaders;\r\n\t},\t\r\n\r\n\tparse(data){\r\n\t\treturn data;\r\n\t},\r\n\r\n\tfetch(options = {}){\r\n\t\tif(this._fetching) return this._fetching;\t\t\r\n\t\tthis._fetching = nativeAjax(options).then(\r\n\t\t\t(json) => {\r\n\r\n\t\t\t\tlet parsed = this.parse(_.clone(json));\r\n\t\t\t\tthis.update(parsed);\r\n\t\t\t\tdelete this._fetching;\r\n\t\t\t\treturn Promise.resolve(json);\r\n\t\t\t}, \r\n\t\t\t(xhr) => {\r\n\t\t\t\t\r\n\t\t\t\tdelete this._fetching;\r\n\t\t\t\t\r\n\t\t\t\toptions.clearOnFail !== false \r\n\t\t\t\t\t&& this.update(null);\r\n\r\n\t\t\t\tlet error = this.handleError(xhr);\r\n\t\t\t\tif(error){\r\n\r\n\t\t\t\t\treturn Promise.reject(error);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn Promise.reject(xhr);\r\n\t\t\t\t}\r\n\t\t\t});\t\r\n\t\treturn this._fetching;\r\n\t},\r\n\thandleError(){},\r\n\tupdate(hash, opts = {}){\r\n\t\tlet { silent } = opts;\r\n\t\tif (hash == null) {\r\n\r\n\t\t\tthis.clear(opts);\r\n\r\n\t\t} else {\r\n\t\t\tlet fullhash = _.extend({}, this.attributes, hash);\r\n\t\t\tlet unset = [];\r\n\t\t\tlet shouldUnset = !!opts.unset;\r\n\t\t\tlet setHash = _(fullhash).reduce((memo, value, key) => {\r\n\t\t\t\tif (key in hash) {\r\n\t\t\t\t\tmemo[key] = value;\r\n\t\t\t\t} else if (shouldUnset) {\r\n\t\t\t\t\tunset.push(key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmemo[key] = undefined;\r\n\t\t\t\t}\r\n\t\t\t\treturn memo;\r\n\t\t\t}, {});\r\n\r\n\t\t\tsetHash = this.parse(setHash);\r\n\t\t\tthis.set(setHash, { silent });\r\n\t\t\t_(unset).each(key => this.unset(key, { silent }));\r\n\t\t}\r\n\r\n\t\tthis.reflectTokenChanges();\r\n\r\n\t},\r\n\r\n\treplaceBackboneAjax(){\t\t\r\n\t\tif(!this.hasToken())\r\n\t\t\tBackbone.ajax = nativeAjax;\r\n\t\telse\r\n\t\t\tBackbone.ajax = (...args) => this.ajax(...args);\r\n\t},\r\n\tupdateAjaxHeaders(token){\r\n\t\ttoken || (token = this.getToken());\r\n\t\tlet headers = this.getAjaxHeaders();\r\n\t\tif (token) {\r\n\t\t\theaders.Authorization = 'Bearer ' + token;\r\n\t\t\theaders.Accept = 'application/json';\r\n\t\t} else {\r\n\t\t\tdelete headers.Authorization;\r\n\t\t}\r\n\t},\r\n\r\n\t//implement by your own\r\n\tstoreToken(){},\r\n\r\n\treflectTokenChanges(opts = {}){\r\n\t\tlet { silent, store = true } = opts;\r\n\t\tthis.updateAjaxHeaders();\r\n\t\tthis.replaceBackboneAjax();\r\n\t\tif (store)\r\n\t\t\tthis.storeToken();\r\n\t\tif (!silent)\r\n\t\t\tthis.trigger('changed');\r\n\t},\r\n\r\n\tajax(...args){\r\n\t\treturn this.refresh().then(\r\n\t\t\t() => tokenizedAjax.apply(this, args),\r\n\t\t\terror => Promise.reject(error)\r\n\t\t);\r\n\t},\t\r\n\trefresh(opts = {}){\t\t\r\n\r\n\t\t// if token is fresh enough and there is no force refresh\r\n\t\t// pass\r\n\t\tif (!this.isExpired() && !opts.force) {\r\n\t\t\treturn Promise.resolve();\r\n\t\t}\r\n\t\tlet options = this.getFlow('refresh');\r\n\t\toptions.data = this.getRefreshTokenData();\r\n\t\treturn this.fetch(options);\r\n\t},\r\n\tgetRefreshTokenData(){\r\n\t\treturn {\r\n\t\t\t'grant_type':'refresh_token',\r\n\t\t\t'refresh_token': this.getRefreshToken(),\r\n\t\t};\r\n\t},\r\n\r\n\tsetExpiration(arg){\r\n\r\n\t\tif (arg === null) {\r\n\t\t\tthis.expiresAt = null;\r\n\t\t}\r\n\r\n\t\tlet date;\r\n\t\tlet now = new Date();\r\n\r\n\t\tif (_.isDate(arg)) {\r\n\t\t\tdate = arg;\r\n\t\t} else if(_.isObject(arg)) {\r\n\t\t\tdate = new Date();\r\n\t\t\t\r\n\t\t\tlet { seconds, minutes, hours, days } = arg;\r\n\t\t\tdate.setDate(date.getDate() + (days || 0));\r\n\t\t\tdate.setHours(date.getHours() + (hours || 0));\r\n\t\t\tdate.setMinutes(date.getMinutes() + (minutes || 0));\r\n\t\t\tdate.setSeconds(date.getSeconds() + (seconds || 0));\r\n\t\t}\r\n\r\n\t\tif(!_.isDate(date) || isNaN(date.valueOf()) || date < now) {\r\n\t\t\tdate = new Date();\r\n\t\t\tdate.setSeconds(now.getSeconds() + 90);\r\n\t\t}\r\n\r\n\t\tthis.expiresAt = date;\r\n\t},\r\n\tgetExpiration(){\r\n\t\treturn this.expiresAt;\r\n\t},\r\n\tisExpired(){\r\n\t\tlet date = this.getExpiration();\r\n\t\tif(!_.isDate(date) || isNaN(date.valueOf()))\r\n\t\t\treturn true;\r\n\t\treturn date.valueOf() < Date.now() + (this.secondsOffset * 1000);\r\n\t},\r\n\tlogin(username, password){\r\n\r\n\t\tlet options = this.getFlow('password');\r\n\t\toptions.data = { grant_type:'password', username, password };\r\n\t\toptions.clearOnFail = false;\r\n\t\treturn this.fetch(options);\r\n\r\n\t},\r\n\r\n});\r\n\r\nToken.setNativeAjax = function(arg){\r\n\tlet old = nativeAjax;\r\n\tnativeAjax = arg;\r\n\treturn old;\r\n};\r\n\r\nexport default Token;\r\n","const _disallowedKeys = ['setItem', 'key', 'getItem', 'removeItem', 'clear'];\r\nconst allowedKey = key => _disallowedKeys.indexOf(key) < 0;\r\n\r\nconst fake = {\r\n\tsetItem(id, val) {\r\n\t\tif (!allowedKey(id)) return;\r\n\t\treturn this[id] = String(val);\r\n\t},\r\n\tgetItem(id) {\r\n\t\tif (!allowedKey(id)) return;\r\n\t\treturn this[id];\r\n\t},\r\n\tremoveItem(id) {\r\n\t\tif (!allowedKey(id)) return;\r\n\t\tdelete this[id];\r\n\t},\r\n\tclear() {\r\n\t\tlet keys = _(this).keys();\r\n\t\t_(keys).each(key => this.removeItem(key));\r\n\t}\r\n};\r\n\r\nexport default fake;\r\n","import fake from './fake';\r\n\r\nlet session = (typeof sessionStorage === 'undefined') \r\n\t? fake : sessionStorage;\r\n\r\nlet local = (typeof localStorage === 'undefined') \r\n\t? fake : localStorage;\r\n\r\nexport {\r\n\tsession,\r\n\tlocal\r\n};\r\n","import { session, local } from './store';\r\n\r\nconst getStore = (opts = {}) => opts.local === true ? local : session;\r\n\r\nconst SECONDS = 1000;\r\nconst MINUTES = SECONDS * 60;\r\nconst HOURS = MINUTES * 60;\r\nconst DAYS = HOURS * 24;\r\n\r\nvar store = {\r\n\r\n\t_normalizeValue(value) {\r\n\t\tvar normValue = value;\r\n\t\tif (_.isObject(value) && _.isFunction(value.toJSON))\r\n\t\t\tnormValue = value.toJSON();\r\n\t\tif (_.isDate(value) && !_.isNaN(value.valueOf()))\r\n\t\t\tnormValue = 'date(' + normValue + ')';\r\n\t\treturn normValue;\r\n\t},\r\n\r\n\t_createItem(value, expireAt) {\r\n\t\treturn { expireAt: expireAt, value: value };\r\n\t},\r\n\r\n\tjsonParse(key, value) {\r\n\t\tvar datePattern = /^date\\((\\d{4,4}-\\d{2,2}-\\d{2,2}([T\\s]\\d{2,2}:\\d{2,2}:\\d{2,2}(\\.\\d*)?Z?)?)\\)$/;\r\n\t\tif (_.isString(value) && datePattern.test(value)) {\r\n\t\t\tvar textDate = value.replace(datePattern, '$1');\r\n\t\t\treturn new Date(textDate);\r\n\t\t}\r\n\t\treturn value;\r\n\t},\r\n\t_jsonParse(key, value, context) {\r\n\t\tif (!key) return value;\r\n\t\treturn this.jsonParse(key, value, context);\r\n\t},\r\n\t_parse(raw) {\r\n\t\tlet _this = this;\r\n\t\tlet item = JSON.parse(raw, function (key, value) { return _this._jsonParse(key, value, this); });\r\n\t\tif ('expireAt' in item && 'value' in item)\r\n\t\t\treturn item;\r\n\t\telse\r\n\t\t\treturn this._createItem(item, 0);\r\n\t},\r\n\t_get(key, opts) {\r\n\t\tlet raw = getStore(opts).getItem(key);\r\n\t\tif (raw == null) return;\r\n\t\treturn this._parse(raw);\r\n\t},\r\n\tget(key, opts = {}) {\r\n\r\n\t\tlet { checkExpire = true } = opts;\r\n\r\n\t\tlet item = this._get(key, opts);\t\t\r\n\t\tif (item == null) return;\r\n\r\n\t\tlet expired = this._isExpired(item);\r\n\t\tif (!expired || !checkExpire) {\r\n\r\n\t\t\treturn item.value;\r\n\t\t}\r\n\t\telse if (expired) {\r\n\t\t\tthis.remove(key, opts);\r\n\t\t}\r\n\t},\r\n\tset(key, value, opts = {}) {\r\n\r\n\t\tlet expireAt = Date.now() + this.getExpireAt(opts);\r\n\t\tlet normValue = this._normalizeValue(value);\r\n\t\tlet item = this._createItem(normValue, expireAt);\r\n\t\tthis._set(key, item, opts);\r\n\t\t\r\n\t},\r\n\tremove(key, opts) {\r\n\t\tgetStore(opts).removeItem(key);\r\n\t},\r\n\texpire(key, opts) {\r\n\t\tlet item = this._get(key, opts);\r\n\t\tif (!item) return;\r\n\t\titem.expireAt = 0;\r\n\t\tthis._set(key, item, opts);\r\n\t},\r\n\tgetExpireAt ({ expireAt, seconds, minutes, hours, days }) {\r\n\t\tif (expireAt != null)\r\n\t\t\treturn expireAt;\r\n\r\n\t\tlet offset = 0;\r\n\r\n\t\t_.isNumber(seconds) && (offset += seconds * SECONDS);\r\n\t\t_.isNumber(minutes) && (offset += minutes * MINUTES);\r\n\t\t_.isNumber(hours) && (offset += hours * HOURS);\r\n\t\t_.isNumber(days) && (offset += days * DAYS);\r\n\r\n\t\toffset === 0 && (offset += 10 * MINUTES);\r\n\r\n\t\treturn offset;\r\n\t},\r\n\t_set(key, item, opts) {\r\n\t\tlet text = JSON.stringify(item);\r\n\t\tgetStore(opts).setItem(key, text);\r\n\t},\r\n\tisExpired(key, opts) {\r\n\t\tlet item = this._get(key, opts);\r\n\t\tif (item == null) return true;\r\n\t\treturn this._isExpired(item);\r\n\t},\r\n\t_isExpired(item) {\r\n\t\treturn item.expireAt < Date.now();\r\n\t},\r\n};\r\n\r\nexport default store;\r\n","import { isModel } from '../../vendors/helpers';\r\nexport default function traverse(fields, root)\r\n{\r\n\troot = root || '';\r\n\tif (this == null || typeof this != 'object') {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar hash = isModel(this) ? this.attributes : this;\r\n\r\n\tvar props = Object.getOwnPropertyNames(hash);\r\n\r\n\tfor (var x = 0; x < props.length; x++) {\r\n\t\tvar name = props[x];\r\n\t\tvar prop = this[name];\r\n\r\n\t\tif (prop == null || typeof prop != 'object' || (prop instanceof Date || prop instanceof Array)) {\r\n\r\n\t\t\tfields[root + name] = prop;\r\n\t\t}\r\n\t\telse if (typeof prop == 'object') {\r\n\r\n\t\t\ttraverse.call(prop, fields, root + name + '.');\r\n\t\t}\r\n\t}\r\n\t\t\r\n}\r\n","import traverse from './traverse';\r\n\r\nexport default function flattenObject(obj) {\r\n\tif (obj == null || !_.isObject(obj)) return;\r\n\tvar res = {};\r\n\ttraverse.call(obj, res);\r\n\treturn res;\r\n}","import camelCase from '../camel-case';\r\nfunction transformStringArray(arr, opts = {}){\r\n\tlet { ignoreCase = true, toCamelCase = false } = opts;\r\n\treturn _(arr).map(value => {\r\n\t\tif (ignoreCase) \r\n\t\t\treturn value.toLowerCase();\r\n\t\telse if (toCamelCase)\r\n\t\t\treturn camelCase(value);\r\n\t\telse\r\n\t\t\treturn value;\r\n\t});\r\n}\r\nexport default function hasFlag(value, flag, opts = {}){\r\n\tif (value == null || flag == null) return false;\r\n\tif(typeof value != typeof flag)\r\n\t\tthrow new Error('value and flag must be of same type. allowed types: string, number');\r\n\r\n\r\n\tif(_.isNumber(value) && _.isNumber(flag)) {\r\n\t\tlet has = value & flag;\r\n\t\treturn opts.all === true ? has === flag : has > 0;\r\n\t}\r\n\r\n\tif(_.isString(value) && _.isString(flag)) {\r\n\t\tif(value === '' || flag === '') return false;\r\n\t\tlet values = transformStringArray(value.split(/\\s*,\\s*/), opts);\r\n\t\tlet flags = transformStringArray(flag.split(/\\s*,\\s*/), opts);\r\n\t\tlet intersection = _.intersection(values, flags);\r\n\t\t\r\n\t\tif(intersection.length == 0) return false;\r\n\r\n\t\tif(intersection.length == flags.length) return true;\r\n\r\n\t\treturn opts.all != true;\r\n\r\n\t}\r\n\r\n}\r\n","import getProperty from '../get-by-path/get-property';\r\nimport { isModel } from '../../vendors/helpers';\r\nfunction setProperty(context, name, value) {\r\n\tif (isModel(context)) {\r\n\t\tcontext.set(name, value, { silent: true });\r\n\t}\r\n\telse {\r\n\t\tcontext[name] = value;\r\n\t}\r\n\r\n\treturn getProperty(context, name);\r\n}\r\n\r\nexport default setProperty;\r\n","export default function ensureSetByPathArguments(context, path)\r\n{\r\n\tlet errors = [];\r\n\tif (context == null || !_.isObject(context)) {\r\n\t\terrors.push(new Error('Context is not an object'));\r\n\t}\r\n\tif (!_.isString(path) || path === '') {\r\n\t\terrors.push(new Error('Path is not a string'));\r\n\t}\r\n\tif (errors.length) {\r\n\t\treturn errors;\r\n\t}\r\n}\r\n","import getProperty from '../get-by-path/get-property';\r\nimport setProperty from './set-property';\r\nimport ensureArguments from './ensure-arguments';\r\nimport { isModel } from '../../vendors/helpers';\r\nexport default function setByPathArr(context, propertyName, pathArray, value, options) {\r\n\r\n\tlet argumentsErrors = ensureArguments(context, propertyName);\r\n\tif (argumentsErrors) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet modelContext;\r\n\tif (isModel(context)) {\r\n\t\tmodelContext = {\r\n\t\t\tmodel: context,\r\n\t\t\tproperty: propertyName,\r\n\t\t\tpathChunks: [].slice.call(pathArray)\r\n\t\t};\r\n\t}\r\n\r\n\t//set value if this is a last chunk of path\r\n\tif (!pathArray.length) {\r\n\r\n\t\tmodelContext && options.models.push(modelContext);\r\n\r\n\t\treturn setProperty(context, propertyName, value, options);\r\n\r\n\t} else {\r\n\r\n\t\tvar prop = getProperty(context, propertyName);\r\n\r\n\t\tif (!_.isObject(prop) && !options.force) {\r\n\t\t\treturn;\r\n\t\t} else if (!_.isObject(prop) && options.force) {\r\n\t\t\tprop = setProperty(context, propertyName, {}, options);\r\n\t\t} \r\n\r\n\t\tmodelContext && options.models.push(modelContext);\r\n\r\n\t\tvar nextName = pathArray.shift();\t\r\n\t\treturn setByPathArr(prop, nextName, pathArray, value, options);\r\n\r\n\t}\r\n}\r\n","export default function normalizeSetByPathOptions(opts = {}, ext)\r\n{\r\n\r\n\tlet options = _.extend({}, opts, ext, {\r\n\t\tsilent: opts.silent === true,\r\n\t\tforce: opts.force !== false,\r\n\t\t//passPath: [],\r\n\t\tmodels: []\r\n\t});\r\n\r\n\treturn options;\r\n}\r\n","export default function triggerModelEventsOnSetByPath(value, options = {})\r\n{\r\n\tif (options.silent || !options.models.length) {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\t_(options.models).each(context => {\r\n\t\tlet rest = context.pathChunks.join(':');\r\n\t\tif (rest) {\r\n\t\t\tcontext.model.trigger(`change:${context.property}:${rest}`, context.model, value);\r\n\t\t}\r\n\t\tcontext.model.trigger(`change:${context.property}`, context.model, value);\r\n\t\tcontext.model.trigger('change', context.model);\r\n\t});\r\n\r\n\t// //triggering change event on all met models\r\n\t// let originPath = options.pathArray.join(':');\r\n\t// while (options.models.length) {\r\n\t// \tlet modelContext = options.models.pop();\r\n\t// \tlet propertyEventName = modelContext.path == ''\r\n\t// \t\t? originPath\r\n\t// \t\t: originPath.substring(modelContext.path.length + 1);\r\n\r\n\t// \tif (propertyEventName) {\r\n\t// \t\tmodelContext.model.trigger('change:' + propertyEventName, value);\r\n\t// \t}\r\n\t// \tmodelContext.model.trigger('change', modelContext.model);\r\n\t// }\r\n}\r\n","import setByPathArray from './set-by-path-array';\r\nimport normalizeOptions from './normalize-options';\r\nimport triggerModelChangeEvents from './trigger-model-change-events';\r\nimport ensureArguments from './ensure-arguments';\r\nexport default function setByPath(context, path, value, opts = {}) {\r\n\r\n\tlet argumentsErrors = ensureArguments(context, path);\r\n\tif (argumentsErrors) {\r\n\t\treturn value;\r\n\t}\r\n\r\n\tlet pathArray = path.split('.');\t\r\n\tlet options = normalizeOptions(opts, { path, pathArray: [].slice.call(pathArray) });\r\n\r\n\tlet propertyName = pathArray.shift();\r\n\r\n\tlet result = setByPathArray(context, propertyName, pathArray, value, options);\r\n\r\n\tif (result === undefined && value !== undefined) {\r\n\t\treturn value;\r\n\t}\r\n\r\n\ttriggerModelChangeEvents(value, options);\r\n\r\n\treturn value;\r\n\r\n\t// if (_.isObject(path) && !_.isArray(path)) {\r\n\t// \tvalue = path.value;\r\n\t// \toptions.force = path.force !== false;\r\n\t// \toptions.silent = path.silent === true;\r\n\t// \tpath = path.path;\r\n\t// }\r\n\r\n\t// var prop = pathArray.shift();\r\n\r\n\t// if (isModel(context)) {\r\n\t// \toptions.models.push({\r\n\t// \t\tpath: '',\r\n\t// \t\tproperty: prop,\r\n\t// \t\tmodel: context\r\n\t// \t});\r\n\t// }\r\n\r\n}\r\n\r\n\r\n","import setByPath from '../set-by-path';\r\n\r\nexport default function unFlat(obj) {\r\n\r\n\tif (obj == null || !_.isObject(obj)) return;\r\n\tvar res = {};\r\n\tfor (var e in obj) {\r\n\t\tsetByPath(res, e, obj[e]);\r\n\t}\r\n\treturn res;\r\n}\r\n\r\n"],"names":["MnObject","Mn","Object","triggerMethod","_triggerMethod","ctors","Model","Collection","View","Router","tryGetFromMn","_","each","isFunction","ClassName","push","isKnownCtor","arg","isFn","result","knownCtors","some","ctor","prototype","betterResult","obj","key","opts","context","args","checkAlso","force","defaultValue","default","isString","value","apply","isObject","alsoOptions","omit","getOption","also","_opts","options","extend","deep","Mixin","Base","defaultGetArguments","defaults","values","keys","split","option","undefined","createMixinFromObject","mixedObj","clone","mixedCtor","constructor","mx","arguments","normalizeArguments","raw","wrap","wrapObjectWithConstructor","merge","mergeObjects","mixins","size","unshift","withMethod","Mixed","class","length","reduce","Memo","Ctor","mixed","isClass","isModel","isModelClass","isCollection","isCollectionClass","isView","isViewClass","triggerMethodOn","mix","_ctor","defaultOptions","b","Error","camelCase","text","first","splitter","replace","match","prefix","toUpperCase","toLowerCase","Process","name","process","concurrent","concurrencyCheck","run","isPromisable","Promise","then","asArray","isArray","race","promises","valueToPromise","resolve","reject","_initDefaults","_initCancelation","_mergeOptions","cid","uniqueId","errors","cancelPromise","cancel","previous","getProcessFromContext","promise","updateProcessInContext","_createLifeCyclePromise","_notCanceled","_begin","_beforeStart","_canBeStarted","_waitOtherPromises","triggerComplete","catch","triggerError","error","jsError","getJsError","_cancelationRace","_getHookResultAsPromise","contextMethod","invokeOnContext","all","hookName","procMethod","procHook","cntxHook","triggerOnContext","onComplete","triggerEnd","onError","filter","f","getContextProcessKey","eventName","trigger","event","methodName","method","register","defaultStartableOptions","contextState","keyValue","storeState","ensureState","processingName","processedName","restoreState","shouldThrow","other","status","defaultStartOptions","defaultStopOptions","_initializeStartable","startable","start","stop","isNotIddle","isStarted","_initializeChildrenable","mergeOptions","parent","root","_childrenInitialized","children","_children","_initializeChild","child","Child","invoked","call","buildChildOptions","buildChild","items","exclude","map","item","index","_childFilter","childFilter","indexOf","slice","reverse","_getChildren","includeSelf","getChildren","chain","getAllChildren","flatten","getNestedResult","schema","nested","getPropertySchema","model","getDisplayConfig","getPropertyDisplayConfig","display","getProperty","get","gettingByPath","getByPathArray","propertyName","pathArray","prop","nextName","shift","getByPath","path","originalGet","transform","alternative","ifEmpty","label","defaultCssConfig","_setupCssClassModifiers","className","_getCssClassString","$el","removeAttr","attr","optsModifiers","propsModifiers","modifiers","concat","_getCssClassModifiers","getCssClassModifiers","classes","cls","ready","uniq","join","trim","_cssClassModifiersInitialized","cfg","getCssClassConfig","events","getCssClassEvents","on","refreshCssClass","modelChange","listenTo","_getCssClassConfig","refresh","beforeRender","_getCssClassEvents","defaultSelector","defaultUpdateDom","selector","element","$","addClass","append","buildRegionFunc","view","hash","autoCreateRegion","updateDom","el","regionEl","region","getRegion","testEl","find","definition","pick","addRegion","normalizeNestedViewContextRegion","regionName","replaceElement","show","partial","buildRegion","_nestedViews","initializeNestedViews","_nestedViewsInitialized","showAllNestedViews","nesteds","addNestedView","normalizeRegion","contexts","getNestedViewContext","_normalizeNestedContext","_createNestedContext","isRendered","showNestedView","getNestedViewRegion","buildNestedView","passedView","template","buildNestedViewOptions","base","collection","init","previousCollection","destroy","_removeCollection","initModels","_setCollectionListeners","store","_store","filtered","byModel","isFiltered","isSorted","stopListening","_removeItems","models","_clearCollectionStore","_modelsInitialized","_onCollectionUpdate","_onCollectionReset","_onCollectionSort","listenToOnce","_onCollectionFirstFetch","enableCollection","_rebuildModels","sort","getFilter","_getModelContext","create","_storeContext","_sortItems","comparator","getComparator","col","changes","added","removed","merged","data","_filterItems","_addItems","attach","_updateIndexes","processAndRender","_items","_filtered","add","remove","_getItems","_dataComparator","previousModels","$container","skip","take","Infinity","isNumber","a","dataComparator","preventRender","dataFilter","customs","customContext","_normalizeAddCustomContext","custom","_isDestroyed","build","_injectEmptyView","getCustoms","newitems","_extractCustomView","splice","rebuild","Backbone","isInPage","paginator","from","to","renderView","_isRendered","supportsRenderLifecycle","render","destroyView","disableDetachEvents","_disableDetachEvents","supportsDestroyLifecycle","shouldTriggerDetach","_isAttached","silent","forceSort","forceFilter","_removeEmptyViewInstance","resultDetach","detach","_setItems","getPaginator","_injectCustoms","total","skiped","taked","lastResult","setTimeout","iterator","shouldUpdateIndex","isNew","markNew","pass","res","iteratee","_a","_b","_removeItem","id","createView","removeCustomViews","triggerViewMethod","_destroyChildViews","_detachChildViews","_attachChildViews","_destroyChildView","_detachChildView","views","monitorViewEvents","Dom","detachContents","shouldDisableEvents","detachEl","shouldTriggerAttach","elBuffer","createBuffer","_ensureContextHasView","appendContents","_$contents","_$el","_createModelChildView","_getChildViewClass","_getChildViewOptions","modelView","modelViewOptions","EmptyViewMixin","_emptyViewInstance","emptyView","_getEmptyViewClas","emptyViewOptions","MergeOptions","ViewManager","_ensureOptions","setCollection","Events","borrow","common","BaseView","_initializeViewManager","noop","_fallbackOptions","_viewManager","managedCollection","childView","childViewOptions","getTemplate","_reInitRegions","_renderTemplate","bindUIElements","setComparator","viewComparator","setFilter","viewFilter","addCustomView","triggerControlEvent","control","getControlName","proxyControlEventToParent","getTriggerValue","getControlValue","convertValue","validate","_triggerControlEvent","type","previousTriggerName","getPreviousTriggerValueKey","JSON","stringify","_isValueAsPrevious","triggerValue","isValueAsPrevious","tryValidateControl","setPreviousTriggerValue","triggerControlInvalid","getParentControl","triggerChildControlEvent","_getOption","getInputType","inputView","valueType","isDate","_valueIsNumber","inputType","setInputAttributes","attributes","restrictionKeys","restrictions","key2","ifNull","isChar","ctrlKey","eventContext","prevent","isEnteredCharValid","keyCode","stopPropagation","preventDefault","triggerControlDone","originalEvent","clipboardData","getData","isValueValid","input","select","newvalue","setControlValue","target","toString","handleInputEvent","setInputEvents","passedEvents","eventsArray","eventHandlers","toNumber","parseFloat","isNaN","trueValues","falseValues","returnValue","isBoolean","valueOrAlternative","nullable","nullValue","alts","alt","convertToBoolean","strict","returnNullAs","returnEmptyAs","returnNullAndEmptyAs","returnAnyAs","returnOtherAs","isTrue","isFalse","convertString","toBoolean","ControlMixin","buildRestrictions","attrs","pickNumbers","pickStrings","pickBools","convert","prepareValueBeforeSet","triggerControlChange","len","getMaxLength","substring","num","min","max","getValueType","maxlength","char","parseInt","required","strValue","pattern","RegExp","test","pstoSetPair","pair","keyvalue","pstoSetKeyValue","decodeURIComponent","paramsToObject","emptyObject","pairs","router","update","routeArgumentsToObject","route","callback","isRouterHoldsActions","rawRoute","isRegExp","_routeToRegExp","callbackWrapper","bind","_processCallback","createActionContext","routeContext","fragment","rawArgs","_extractParameters","queryString","pop","qs","prepareActionQueryString","prepareActionArguments","routeType","queryStringParser","params","toPromise","getCallbackFunction","executeResult","exception","processCallback","actionContext","asPromise","triggerEvent","shouldTriggerEvent","execute","lastAttempt","handleError","handlers","_getHandleContext","applyHandler","handler","getHandler","setHandler","memo","getHandleContext","Deferred","BaseRouter","BbRouter","with","GetOptionMixin","routes","getInitRoutes","addRoutes","controller","approutes","_buildRouteContext","registerRouteContext","_storeCreatedContext","isRouteChaining","normalized","_normalizeRoutes","doNotReverse","registered","addRoute","massAdd","c","has","buildRouteContextFromArguments","buildRouteContext","history","routeContexts","restart","action","handle","paramStringToObject","optionalParam","namedParam","splatParam","escapeRegExp","optional","flags","cntx","page","getRoutesContexts","startPage","beforePageStart","afterPageStart","previousPage","getModel","compareAB","func","every","getView","single","initializeRouter","_buildRoutesContexts","_createRouter","_shouldRegisterAllRoutes","pages","registerPageRoutes","config","getRoutesConfig","_normalizeRoutesContextRoute","routesContext","order","relative","parentContext","getMainRouteContext","mainRouteContext","sortBy","main","BasePage","ChildrenableMixin","StartableMixin","RoutesMixin","initializeRoutes","initializeChildren","registerAllRoutes","getLabel","getParent","i","getHash","visible","getSiblings","getAllPages","parentCid","getMenuLabel","hidden","historyNavigate","navigate","historyLoadUrl","matchRoot","getFragment","executed","executeHandler","testHandler","findHandler","customTest","resultContext","loadUrl","entries","onRoute","onBackRoute","isActionContext","lastElement","gobackContext","lookFor","last","hasElements","normalizeOptions","url","go","navigateBack","nativeAjax","_nativeAjax","tokenizedAjax","headers","getAjaxHeaders","Token","ajaxHeaders","flows","initializeFlows","setExpiration","shouldRequestOnInitialize","getReady","hasToken","setFlow","endPoint","getToken","tokenAttribute","refreshTokenAttribute","_fetching","json","parsed","parse","xhr","clearOnFail","clear","fullhash","unset","shouldUnset","setHash","set","reflectTokenChanges","ajax","token","Authorization","Accept","updateAjaxHeaders","replaceBackboneAjax","storeToken","isExpired","getFlow","getRefreshTokenData","fetch","getRefreshToken","expiresAt","date","now","Date","seconds","minutes","hours","days","setDate","getDate","setHours","getHours","setMinutes","getMinutes","setSeconds","getSeconds","valueOf","getExpiration","secondsOffset","username","password","grant_type","setNativeAjax","old","_disallowedKeys","allowedKey","fake","val","String","removeItem","session","sessionStorage","local","localStorage","getStore","SECONDS","MINUTES","HOURS","DAYS","normValue","toJSON","expireAt","datePattern","textDate","jsonParse","_this","_jsonParse","_createItem","getItem","_parse","checkExpire","_get","expired","_isExpired","getExpireAt","_normalizeValue","_set","offset","setItem","traverse","fields","babelHelpers.typeof","props","getOwnPropertyNames","x","Array","flattenObject","transformStringArray","arr","ignoreCase","toCamelCase","hasFlag","flag","intersection","setProperty","ensureSetByPathArguments","setByPathArr","argumentsErrors","ensureArguments","modelContext","normalizeSetByPathOptions","ext","triggerModelEventsOnSetByPath","rest","pathChunks","property","setByPath","setByPathArray","unFlat","e"],"mappings":"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"}