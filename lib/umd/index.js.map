{"version":3,"file":"index.js","sources":["mn/object.js","utils/is-known-ctor/ctors.js","utils/is-known-ctor/index.js","utils/better-result/index.js","utils/get-option/index.js","mixins/common/get-option/index.js","utils/mix/options.js","utils/mix/create-mixin-from-object.js","utils/mix/normalize-arguments.js","utils/mix/with.js","utils/extend/index.js","utils/mix/index.js","mn/trigger-method-on.js","utils/camel-case/index.js","components/process/register.js","components/process/helpers.js","components/process/index.js","mixins/common/startable/index.js","mixins/common/childrenable/index.js","mixins/model/smart-get/get-nested-result.js","mixins/model/smart-get/get-property-schema.js","mixins/model/smart-get/get-display-config.js","bb/is-model.js","utils/get-by-path/get-property.js","utils/get-by-path/get-by-path-array.js","utils/get-by-path/index.js","mixins/model/smart-get/index.js","mixins/view/css-class-modifiers/index.js","mixins/view/nested-views/build-region.js","mixins/view/nested-views/normalize-region.js","bb/is-view.js","bb/is-view-class.js","mixins/view/nested-views/index.js","mixins/controls/control/trigger-control-event.js","mixins/controls/control/get-trigger-value.js","mixins/controls/control/index.js","mixins/controls/input/get-input-type.js","mixins/controls/input/set-attributes.js","mixins/controls/input/events/_get-option.js","mixins/controls/input/events/_is-char.js","mixins/controls/input/events/keydown.js","mixins/controls/input/events/keyup.js","mixins/controls/input/events/paste.js","mixins/controls/input/events/blur.js","mixins/controls/input/events/focus.js","mixins/controls/input/events/input.js","mixins/controls/input/events/index.js","mixins/controls/input/handle-event.js","mixins/controls/input/set-events.js","utils/convert-string/to-number.js","utils/to-bool/options.js","utils/to-bool/index.js","utils/convert-string/index.js","mixins/controls/input/index.js","utils/params-to-object/index.js","components/navigation/router/build-route-context.js","components/navigation/router/action-context.js","components/navigation/router/process-callback.js","components/navigation/route-error-handler/index.js","components/navigation/router/index.js","components/navigation/page/router.js","utils/compare-ab/get-model.js","utils/compare-ab/get-view.js","utils/compare-ab/index.js","utils/comparator/index.js","components/navigation/page/routes-mixin.js","components/navigation/page/index.js","components/navigation/history/index.js","components/navigation/history-watcher/index.js","components/navigation/navigator/index.js","utils/flat/traverse.js","utils/flat/index.js","utils/set-by-path/set-property.js","utils/set-by-path/ensure-arguments.js","utils/set-by-path/set-by-path-array.js","utils/set-by-path/normalize-options.js","utils/set-by-path/trigger-model-change-events.js","utils/set-by-path/index.js","utils/unflat/index.js"],"sourcesContent":["import Mn from 'backbone.marionette';\r\nconst MnObject = Mn.Object || Mn.MnObject;\r\nexport default MnObject;\r\n","import Model from '../../bb/model';\r\nimport Collection from '../../bb/collection';\r\nimport View from '../../bb/view';\r\nimport Router from '../../bb/router';\r\nimport MnObject from '../../mn/object';\r\nexport default [\r\n\tModel,\r\n\tCollection,\r\n\tView,\r\n\tRouter,\r\n\tMnObject\r\n];","import knownCtors from './ctors';\r\n\r\nfunction isKnownCtor(arg) {\r\n\tlet isFn = _.isFunction(arg);\r\n\tlet result = _(knownCtors).some((ctor) => arg === ctor || arg.prototype instanceof ctor);\r\n\treturn isFn && result;\r\n}\r\n\r\nexport default isKnownCtor;\r\n","import isKnownCtor from '../is-known-ctor';\r\nexport default function betterResult(obj, key, opts = {})\r\n{\r\n\tlet { context, args, checkAlso, force } = opts;\r\n\tlet defaultValue = opts.default;\r\n\r\n\tif(!_.isString(key) || key === '') return;\r\n\t\r\n\tlet value = (obj || {})[key];\r\n\r\n\tif (value != null && (!_.isFunction(value) || isKnownCtor(value)))\r\n\t\treturn value;\r\n\t\t\r\n\tlet result = force !== false && _.isFunction(value) ? value.apply(context || obj, args) : value;\r\n\r\n\tif (result == null && _.isObject(checkAlso)) {\r\n\t\tlet alsoOptions = _.omit(opts, 'checkAlso');\r\n\t\tresult = betterResult(checkAlso, key, alsoOptions);\r\n\t}\r\n\r\n\tif (result == null && defaultValue != null )\r\n\t\tresult = defaultValue;\r\n\r\n\treturn result;\r\n}\r\n","import result from '../better-result';\r\n\r\nexport default function getOption(context, key, opts) {\r\n\t// if (_.isFunction(context.getOption)) {\r\n\t// \treturn context.getOption(key, opts);\r\n\t// } else {\r\n\t// \topts.context = context;\r\n\t// \tlet fallback = _.isFunction(context.getProperty)\r\n\t// \t\t? context.getProperty\r\n\t// \t\t: key => context[key];\r\n\t// \treturn getProperty(context.options, key, opts, fallback);\r\n\t// }\r\n\r\n\tlet options = _.extend({}, opts, {\r\n\t\tcontext,\r\n\t});\r\n\tlet { deep } = options;\r\n\r\n\tlet value = result(context.options, key, options);\r\n\tif (value == null && deep !== false) {\r\n\t\tvalue = result(context, key, options);\r\n\t}\r\n\treturn value;\r\n\r\n\r\n}\r\n","import result from '../../../utils/better-result';\r\nimport getOption from '../../../utils/get-option';\r\n\r\nconst Mixin = (Base) => Base.extend({\r\n\r\n\t//property first approach\r\n\tgetProperty(key, opts){\r\n\t\t\r\n\t\tlet defaultGetArguments = result(this, '_getPropertyArguments', { args:[this], default:[this] });\r\n\t\tlet options = _.extend({\r\n\t\t\tdeep: Mixin.defaults.deep,\r\n\t\t\tforce: Mixin.defaults.force,\r\n\t\t\targs: defaultGetArguments\r\n\t\t}, opts, {\r\n\t\t\tcontext: this,\r\n\t\t});\r\n\t\tlet { deep } = options;\r\n\r\n\t\tlet value = result(this, key, options);\r\n\t\tif (value == null && deep !== false) {\r\n\t\t\tvalue = result(this.options, key, options);\r\n\t\t}\r\n\t\treturn value;\r\n\t},\r\n\r\n\t//options first approach\r\n\tgetOption(key, opts){\r\n\t\tlet defaultGetArguments = result(this, '_getOptionArguments', { args:[this], default:[this] });\r\n\t\tlet options = _.extend({\r\n\t\t\tdeep: Mixin.defaults.deep,\r\n\t\t\tforce: Mixin.defaults.force,\r\n\t\t\targs: defaultGetArguments\r\n\t\t}, opts);\r\n\r\n\t\treturn getOption(this, key, options);\r\n\t},\r\n\r\n\tmergeOptions(values = {}, keys = [], opts = {}){\r\n\t\t\r\n\t\tif(_.isString(keys))\r\n\t\t\tkeys = keys.split(/\\s*,\\s*/);\r\n\r\n\t\t_.each(keys, (key) => {\r\n\t\t\tconst option = result(values, key, _.extend({ force: false }, opts));\r\n\t\t\tif (option !== undefined) {\r\n\t\t\t\tthis[key] = option;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n}, {\r\n\tGetOptionMixin:true\r\n});\r\n\r\nMixin.defaults = {\r\n\tdeep: true,\r\n\tforce: true\r\n};\r\n\r\nexport default Mixin;\r\n","export default {\r\n\tmergeObjects: true,\r\n\twrapObjectWithConstructor: true,\r\n};\r\n","export default function createMixinFromObject(arg) {\r\n\tlet mixedObj = _.clone(arg);\r\n\tlet mixedCtor = _.isFunction(mixedObj.constructor) && mixedObj.constructor;\r\n\treturn Base => { \r\n\t\tif (_.isFunction(mixedCtor)) {\r\n\t\t\t//let providedCtor = ((mixed) => mixed)(obj.constructor);\r\n\t\t\tmixedObj.constructor = function mx(){\r\n\t\t\t\tBase.apply(this, arguments);\r\n\t\t\t\tmixedCtor.apply(this, arguments);\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn Base.extend(mixedObj);\r\n\t};\r\n}\r\n","\r\nimport createMixinFromObject from './create-mixin-from-object';\r\n\r\nexport default function normalizeArguments(args, opts = {}) {\r\n\tlet raw = {};\r\n\tlet wrap = opts.wrapObjectWithConstructor == true;\r\n\tlet merge = opts.mergeObjects == true;\r\n\tlet mixins = [];\r\n\t_(args).each(arg => {\r\n\t\t\r\n\t\t//if argument is function just put it to mixins array\r\n\t\t//and continue;\r\n\t\tif (_.isFunction(arg)) {\r\n\t\t\tmixins.push(arg);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//if argument is not an object just skip it\r\n\t\tif (!_.isObject(arg)) return;\r\n\r\n\t\t//if mergeObjects == false or wrapObjectWithConstructor == true \r\n\t\t//and there is a constructor function\r\n\t\t//converting to a mixin function\r\n\t\t//otherwise extend rawObject\r\n\t\tif (!merge || (wrap && _.isFunction(arg.constructor))) {\r\n\t\t\tmixins.push(createMixinFromObject(arg));\r\n\t\t} \r\n\t\telse {\r\n\t\t\t_.extend(raw, arg);\r\n\t\t}\r\n\t\r\n\t});\r\n\r\n\t//if rawObject is not empty\r\n\t//convert it to a mixin function\r\n\t//and put it to the begin of mixins array\r\n\tif (_.size(raw))\r\n\t\tmixins.unshift(createMixinFromObject(raw));\r\n\r\n\treturn mixins;\r\n}\r\n","\r\n\r\nimport normalizeArguments from './normalize-arguments';\r\n\r\nexport default function withMethod(...args) {\r\n\r\n\tlet mixins = normalizeArguments(args, this.options);\r\n\tlet Mixed = this.class;\r\n\tif (!mixins.length) return Mixed;\r\n\telse\r\n\t\treturn _.reduce(mixins, (Memo, Ctor) => { \r\n\t\t\tlet mixed = Ctor(Memo);\r\n\t\t\treturn mixed;\r\n\t\t}, Mixed);\r\n\r\n}\r\n","//import Mn from 'backbone.marionette';\r\nexport default Mn.extend;\r\n","import defaultOptions from './options';\r\nimport withMethod from './with';\r\n\r\nimport extend from '../extend';\r\n\r\n\r\n\r\nexport default function mix(_ctor, options) {\r\n\r\n\tlet opts = _.extend({}, defaultOptions, options);\r\n\r\n\tlet ctor;\r\n\r\n\tif (_.isFunction(_ctor)) {\r\n\t\tctor = _ctor;\r\n\t}\r\n\telse if (_.isObject(_ctor)) {\r\n\t\tlet b = _.isFunction(_ctor.constructor) && _ctor.constructor;\r\n\t\tctor = function mx() { b.apply(this, arguments); };\r\n\t\t_.extend(ctor.prototype, _.omit(_ctor,'constructor'));\r\n\r\n\t} else {\r\n\t\tthrow new Error('Mix argument should be a class or a plain object');\r\n\t}\r\n\r\n\tif (!_.isFunction(ctor.extend))\r\n\t\tctor.extend = extend;\r\n\r\n\treturn {\r\n\t\toptions: opts,\r\n\t\twith: withMethod,\r\n\t\tclass: ctor,\r\n\t};\r\n}\r\n","import Mn from 'backbone.marionette';\r\nexport default Mn.triggerMethodOn;","// camelCase('asd:qwe:zxc') -> asdQweZxc\r\n// camelCase('asd:qwe:zxc', true) -> AsdQweZxc\r\nexport default function camelCase(text, first) {\r\n\tif (!_.isString(text)) return text;\r\n\tvar splitter = first === true ? /(^|:)(\\w)/gi : /(:)(\\w)/gi;\r\n\ttext = text.replace(splitter, (match, prefix, text) => text.toUpperCase());\r\n\tif(!first)\r\n\t\ttext = text.replace(/(^)(\\w)/gi, (match, prefix, text) => text.toLowerCase());\r\n\treturn text;\r\n}","\r\nexport default function (Process, context, name, opts) {\r\n\r\n\tcontext[name] = function(...args){\r\n\t\t\r\n\t\tlet process = new Process(context, name, _.extend({}, opts));\r\n\t\tlet concurrent = process.concurrencyCheck();\r\n\r\n\t\tif (concurrent)\r\n\t\t\treturn concurrent;\r\n\t\telse\r\n\t\t\treturn process.run(...args);\r\n\r\n\t};\r\n\r\n}\r\n","export function isPromisable(arg){\r\n\treturn arg instanceof Promise || _.isFunction(arg && arg.then);\r\n}\r\n\r\nexport function asArray(arg) {\r\n\tif(_.isArray(arg))\r\n\t\treturn arg;\r\n\telse if(arg == null || arg === '')\r\n\t\treturn [];\r\n\telse\r\n\t\treturn [arg];\r\n}\r\n\r\nexport function race(...promises){\r\n\treturn Promise.race(promises);\r\n}\r\n\r\nexport function valueToPromise(arg){\r\n\tif(!isPromisable(arg)) {\r\n\t\tlet result = arg;\r\n\t\targ = arg == null || arg === '' ? Promise.resolve() : Promise.reject(result);\r\n\t}\r\n\treturn arg;\t\t\r\n}\r\n","import mix from '../../utils/mix';\r\nimport triggerMethodOn from '../../mn/trigger-method-on';\r\nimport camelCase from '../../utils/camel-case';\r\nimport result from '../../utils/better-result';\r\nimport register from './register';\r\n\r\nimport { isPromisable, race, asArray, valueToPromise } from './helpers';\r\n\r\nconst Process = mix({\r\n\tconstructor: function Process(context, name, opts){\r\n\t\tthis._initDefaults(name, context);\r\n\t\tthis._initCancelation();\r\n\t\tthis._mergeOptions(opts);\r\n\t},\r\n\r\n\r\n\t// initialize methods\r\n\r\n\t_initDefaults(name, context){\r\n\t\tif(name == null || name === '')\r\n\t\t\tthrow new Error('Process requires two arguments: name [string], context [object]. name missing');\r\n\t\t\r\n\t\tif(!_.isObject(context))\r\n\t\t\tthrow new Error('Process requires two arguments: name [string], context [object]. context is not an object');\r\n\r\n\t\tthis.cid = _.uniqueId('process');\r\n\t\tthis.name = name;\r\n\t\tthis.context = context;\r\n\t\tthis.errors = [];\r\n\t},\r\n\r\n\t_initCancelation(){\r\n\t\tthis.cancelPromise = new Promise((resolve, reject) => {\r\n\t\t\tthis.cancel = () => reject('cancel'); \r\n\t\t});\r\n\t},\r\n\t_mergeOptions(opts = {}){\r\n\t\tlet options = _.omit(opts, 'cid', 'name', 'context', 'cancelPromise', 'cancel', 'errors');\r\n\t\t_(options).each((value, key) => this[key] = value);\r\n\t},\r\n\r\n\t\r\n\tconcurrencyCheck(){\r\n\r\n\t\tlet previous = this.getProcessFromContext();\r\n\t\t//console.log(previous, this.context);\r\n\t\tif(!previous) return;\r\n\t\r\n\t\tlet concurrent = this.concurrent;\t\r\n\t\t\r\n\t\tif (concurrent === false) {\r\n\t\r\n\t\t\tthis.cancel();\r\n\t\r\n\t\t} else if (concurrent == 'first') {\r\n\t\r\n\t\t\treturn previous.promise;\r\n\t\r\n\t\t} else if (concurrent == 'last') {\r\n\t\r\n\t\t\tprevious.cancel();\r\n\t\r\n\t\t}\t\t\r\n\t},\r\n\r\n\r\n\t// life cycle methods\t\r\n\r\n\trun(...args){\r\n\t\tthis.updateProcessInContext(this);\r\n\t\tthis.args = args || [];\r\n\t\tthis.promise = this._createLifeCyclePromise();\r\n\t\treturn this.promise;\r\n\t},\r\n\r\n\r\n\t_createLifeCyclePromise(){\r\n\r\n\r\n\t\treturn this._notCanceled()\r\n\t\t\t.then(() => this._begin())\r\n\t\t\t.then(() => this._beforeStart())\r\n\t\t\t.then(() => this._canBeStarted())\r\n\t\t\t.then(() => this._waitOtherPromises())\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.triggerComplete();\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tthis.triggerError(error);\r\n\t\t\t\tlet jsError;\r\n\t\t\t\tif(error instanceof Error) {\r\n\t\t\t\t\tthrow error;\r\n\t\t\t\t} else if ((jsError = this.getJsError())) {\r\n\t\t\t\t\tthrow jsError;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn Promise.reject(this);\r\n\t\t\t\t}\r\n\t\t\t});\t\t\r\n\t},\r\n\r\n\r\n\r\n\r\n\t_notCanceled() {\r\n\t\treturn this._cancelationRace(Promise.resolve());\r\n\t},\r\n\t_begin(){\r\n\t\treturn this._getHookResultAsPromise('begin');\r\n\t},\r\n\t_beforeStart(){\r\n\t\treturn this._getHookResultAsPromise('before');\r\n\t},\r\n\t_canBeStarted(){\r\n\t\tlet contextMethod = 'can:not:' + this.name;\r\n\t\tlet promise = this.invokeOnContext(contextMethod);\r\n\t\tif(!isPromisable(promise)) {\r\n\t\t\tpromise = (promise == null || promise === '') \r\n\t\t\t\t? Promise.resolve()\r\n\t\t\t\t: Promise.reject(promise);\r\n\t\t}\r\n\t\treturn this._cancelationRace(promise);\r\n\t},\r\n\t_waitOtherPromises(){\r\n\t\tlet contextMethod = `get:${this.name}:promises`;\r\n\t\t\r\n\t\tlet promises = asArray(this.invokeOnContext(contextMethod));\r\n\r\n\t\treturn this._cancelationRace(Promise.all(promises));\r\n\t},\r\n\r\n\t_getHookResultAsPromise(hookName){\r\n\t\tlet procMethod = camelCase('on:' + hookName);\r\n\t\tlet procHook = _.isFunction(this[procMethod]) && this[procMethod](this.context, ...this.args) || undefined;\r\n\t\tlet result = valueToPromise(procHook).then(() => {\r\n\t\t\tlet cntxHook = this.triggerOnContext(hookName);\r\n\t\t\treturn valueToPromise(cntxHook);\r\n\t\t});\r\n\r\n\t\treturn this._cancelationRace(result);\r\n\r\n\t},\r\n\r\n\r\n\t// trigger methods\r\n\r\n\ttriggerComplete() { \r\n\r\n\t\tthis.updateProcessInContext(null);\r\n\r\n\t\tif (_.isFunction(this.onComplete))\r\n\t\t\tthis.onComplete(this.context, ...this.args);\r\n\r\n\t\tthis.triggerOnContext();\r\n\r\n\t\tthis.triggerEnd();\r\n\t\t\r\n\t\r\n\t},\r\n\ttriggerError(errors){\r\n\r\n\r\n\t\tthis.updateProcessInContext(null);\t\t\r\n\r\n\t\tif(!_.isArray(errors))\r\n\t\t\terrors = [errors];\r\n\r\n\t\tthis.errors.push(...errors);\r\n\r\n\t\t\r\n\t\tif (_.isFunction(this.onError))\r\n\t\t\tthis.onError(this.context, ...this.errors);\r\n\t\t\r\n\t\tthis.triggerOnContext('error', ...this.errors);\r\n\t\t\r\n\t\tthis.triggerEnd();\r\n\r\n\t\t\r\n\t},\r\n\ttriggerEnd(){\r\n\t\tthis.triggerOnContext('end');\r\n\t},\r\n\r\n\r\n\r\n\t// helpers methods\r\n\r\n\tgetJsError(context){\r\n\t\t!context && (context = this);\r\n\t\tif(context != this && (!_.isObject(context) || !_.isArray(context.errors)))\r\n\t\t\treturn;\r\n\r\n\t\treturn _(context.errors).filter(f => f instanceof Error)[0];\r\n\t},\t\r\n\r\n\t_cancelationRace(promise){\r\n\t\treturn race(this.cancelPromise, promise);\r\n\t},\r\n\r\n\r\n\tgetContextProcessKey(){\r\n\t\treturn camelCase(`_process:${this.name}:executing`);\r\n\t},\r\n\tgetProcessFromContext(){\r\n\t\tlet key = this.getContextProcessKey();\r\n\t\treturn this.context[key];\r\n\t},\r\n\tupdateProcessInContext(process){\r\n\t\tlet key = this.getContextProcessKey();\t\t\r\n\t\tthis.context[key] = process;\r\n\t},\r\n\r\n\r\n\r\n\ttriggerOnContext (eventName) {\r\n\t\r\n\t\tlet context = this.context; \r\n\t\tif(!_.isFunction(context.trigger))\r\n\t\t\treturn;\r\n\t\t\r\n\t\tlet event = (eventName ? eventName + ':' : '') + this.name;\r\n\t\t\r\n\t\treturn triggerMethodOn(context, event, this);\r\n\t\r\n\t},\r\n\r\n\tinvokeOnContext(methodName)\r\n\t{\r\n\t\tlet method = camelCase(methodName);\r\n\t\tlet context = this.context;\r\n\t\tlet args = this.args;\r\n\t\treturn result(context, method, { args });\r\n\r\n\t}\r\n\r\n}).class;\r\n\r\n\r\nProcess.register = function(context, name, opts) {\r\n\treturn register(this, context, name, opts);\r\n};\r\n\r\nexport default Process;\r\n","import Process from '../../../components/process';\r\n\r\n\r\nconst defaultStartableOptions  = {\r\n\tconcurrent: false,\r\n\r\n\t//good place to supply own state collecting logic\r\n\tstoreState(){\r\n\r\n\t\tthis.contextState = [{\r\n\t\t\tkey: 'startable.status',\r\n\t\t\tvalue: this.context['startable.status']\r\n\t\t}];\r\n\r\n\r\n\t\t/*\r\n\r\n\t\tfor example: take all simple values from context\r\n\r\n\t\tfor(var key in this.context){\r\n\t\t\tlet value = this.context[key];\r\n\t\t\tif (value == null || !_.isObject(value.valueOf()))\r\n\t\t\t\tthis.contextState.push({ key, value });\r\n\t\t}\r\n\r\n\t\t*/\r\n\r\n\t},\r\n\trestoreState(){\r\n\t\t_(this.contextState || []).each(keyValue => {\r\n\t\t\tthis.context[keyValue.key] = keyValue.value;\r\n\t\t});\r\n\t},\r\n\tonBegin(){\r\n\t\tthis.storeState();\r\n\t\tthis.ensureState();\r\n\t\tthis.context['startable.status'] = this.processingName;\r\n\t},\r\n\tonComplete(){\r\n\t\tthis.context['startable.status'] = this.processedName;\r\n\t},\t\r\n\tonError(){\r\n\t\tthis.restoreState();\r\n\t},\r\n\tensureState(shouldThrow = true){\r\n\t\tlet other = this.name == 'start' ? 'stop' : 'start';\r\n\t\tlet error = this.name == 'start' ? 'not:stopped' : 'not:started';\r\n\t\tlet status = this.context['startable.status'];\r\n\t\tswitch(status){\r\n\t\tcase 'stopping':\r\n\t\tcase 'starting':\r\n\t\t\tif(shouldThrow) throw new Error('not:iddle');\r\n\t\t\telse return 'not:iddle';\r\n\t\tcase 'iddle':\r\n\t\t\tif(this.name == 'start') return;\r\n\t\t\telse if(shouldThrow) throw new Error(error);\r\n\t\t\telse return error;\r\n\t\tcase other:\r\n\t\t\tif(shouldThrow) throw new Error(error);\r\n\t\t\telse return error;\t\t\t\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst defaultStartOptions  = {\r\n\tprocessingName: 'starting',\r\n\tprocessedName: 'started'\r\n};\r\nconst defaultStopOptions  = {\r\n\tprocessingName: 'stopping',\r\n\tprocessedName: 'stopped'\r\n};\r\n\r\nexport default Base => Base.extend({\r\n\tconstructor(){\r\n\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis._initializeStartable();\r\n\r\n\t},\r\n\t'startable.status': 'iddle',\r\n\t_initializeStartable(){\r\n\r\n\t\tlet startable = _.extend({}, defaultStartableOptions, this.getOption('startableOptions', {args:[this]}));\r\n\r\n\t\tlet start = _.extend({}, startable, defaultStartOptions, this.getOption('startOptions', {args:[this]}));\r\n\t\tlet stop = _.extend({}, startable, defaultStopOptions, this.getOption('stopOptions', {args:[this]}));\r\n\r\n\t\tProcess.register(this, 'start', start);\r\n\t\tProcess.register(this, 'stop', stop);\r\n\r\n\t},\r\n\r\n}, {\r\n\tStartable: true\r\n});\r\n","import isKnownCtor from '../../../utils/is-known-ctor';\r\n\r\nexport default Base => Base.extend({\r\n\r\n\tconstructor(opts){\r\n\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis._initializeChildrenable(opts);\r\n\r\n\t},\r\n\t_initializeChildrenable(opts){\r\n\t\tthis.mergeOptions(opts, ['parent', 'root']);\r\n\t\tif(this.parent == null && this.root == null)\r\n\t\t\tthis.root = this;\r\n\t},\r\n\r\n\t//call this method manualy for initialize children\r\n\tinitializeChildren(){\r\n\t\tif (this._childrenInitialized) return;\r\n\r\n\t\tlet children = this.getOption('children');\r\n\t\tthis._children = [];\r\n\t\t_(children).each(child => this._initializeChild(child));\r\n\r\n\t\tthis._childrenInitialized = true;\r\n\r\n\t},\r\n\t_initializeChild(arg){\r\n\t\tlet Child;\r\n\t\tlet options = {};\r\n\r\n\t\tif (isKnownCtor(arg))\r\n\t\t\tChild = arg;\r\n\t\telse if(_.isFunction(arg)){\r\n\t\t\t\r\n\t\t\tlet invoked = arg.call(this, this);\r\n\t\t\treturn this._initializeChild(invoked);\r\n\r\n\t\t} else if (_.isObject(arg)) {\r\n\t\t\tChild = arg.Child;\r\n\t\t\t_.extend(options, _.omit(arg, 'Child'));\r\n\t\t}\r\n\r\n\t\tif (!isKnownCtor(arg)) return;\r\n\r\n\t\t_.extend(options, this.getOption('childOptions'), { parent: this });\r\n\t\toptions = this.buildChildOptions(options);\r\n\t\t\r\n\t\tlet child = new Child(options);\r\n\t\tthis._children.push(child);\r\n\r\n\t},\r\n\r\n\tbuildChildOptions(options){\r\n\t\treturn options;\r\n\t},\r\n\r\n\tgetChildren(){\r\n\t\treturn this._children || [];\r\n\t},\r\n\tgetParent(){\r\n\t\treturn this.parent;\r\n\t}\r\n\r\n\r\n\r\n});\r\n","export default function getNestedResult(value, context, schema) {\r\n\treturn value != null \r\n\t\t&& _.isFunction(schema.nested) \r\n\t\t&& schema.nested(value, context);\r\n}","export default function getPropertySchema(model, key)\r\n{\r\n\tif (_.isFunction(model.getPropertySchema)) {\r\n\t\treturn model.getPropertySchema(key);\r\n\t} else {\r\n\t\treturn {};\r\n\t}\r\n}","export default function getDisplayConfig(key, model, schema){\r\n\tif (key == null) return {};\r\n\treturn (_.isFunction(model.getPropertyDisplayConfig) && model.getPropertyDisplayConfig(key))\r\n\t\t|| (schema && schema.display) || {};\r\n}","import Model from './model';\r\nexport default function isModel(arg){\r\n\treturn arg instanceof Model;\r\n}","import isModel from '../../bb/is-model';\r\nfunction getProperty(context, name)\r\n{\r\n\tif(context == null || !_.isObject(context) || name == null || name == '') return;\r\n\tif (isModel(context))\r\n\t\treturn context.get(name, { gettingByPath: true  });\r\n\telse\r\n\t\treturn context[name];\r\n}\r\nexport default getProperty;\t\r\n","\r\nimport getProperty from './get-property';\r\n\r\nfunction getByPathArray(context, propertyName, pathArray) {\r\n\t\r\n\tif (context == null || !_.isObject(context) || propertyName == null || propertyName == '')\r\n\t\treturn;\r\n\r\n\tvar prop = getProperty(context, propertyName);\r\n\r\n\tif (!pathArray.length || (pathArray.length && prop == null))\r\n\t\treturn prop;\r\n\r\n\tvar nextName = pathArray.shift();\r\n\r\n\treturn getByPathArray(prop, nextName, pathArray);\r\n\r\n}\r\n\r\nexport default getByPathArray;\r\n","import getByPathArray from './get-by-path-array';\r\n\r\nexport default function getByPath(obj, path) {\r\n\r\n\tif (obj == null || !_.isObject(obj) || path == null || path == '') return;\r\n\r\n\tvar pathArray = _.isString(path) ? path.split('.')\r\n\t\t: _.isArray(path) ? [].slice.call(path)\r\n\t\t\t: [path];\r\n\r\n\tvar prop = pathArray.shift();\r\n\r\n\treturn getByPathArray(obj, prop, pathArray);\r\n\r\n}\r\n","import Model from '../../../bb/model';\r\nimport getNestedResult from './get-nested-result';\r\nimport getPropertySchema from './get-property-schema';\r\nimport getDisplayConfig from './get-display-config';\r\nimport getByPath from '../../../utils/get-by-path';\r\nexport default Base => {\r\n\tconst originalGet = Model.prototype.get;\r\n\tconst Mixed = Base.extend({\r\n\t\tgetByPath(key){\r\n\t\t\tif(key.indexOf('.') > -1)\r\n\t\t\t\treturn getByPath(this, key);\r\n\t\t\telse\r\n\t\t\t\treturn originalGet.call(this, key);\r\n\t\t},\r\n\t\tget(key, opts = {}){\r\n\t\t\tif(key == null || key == '') return;\t\r\n\t\t\t\r\n\t\t\tlet value = 'value' in opts \r\n\t\t\t\t? opts.value\r\n\t\t\t\t: this.getByPath.call(this, key);\r\n\r\n\t\t\tif (!_.size(opts)) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\r\n\t\t\tlet prop = getPropertySchema(this, key);\r\n\t\t\tlet result = opts.nested && getNestedResult(value, this, prop);\r\n\t\t\tif (result != null) {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\r\n\t\t\tif(_.isFunction(opts.transform) && !opts.raw) {\r\n\t\t\t\tvalue = opts.transform.call(this, value, opts, this);\r\n\t\t\t}\r\n\r\n\t\t\tif(_.isFunction(prop.transform) && !opts.raw){\r\n\t\t\t\tvalue = prop.transform.call(this, value, opts, this);\r\n\t\t\t}\r\n\r\n\t\t\tif(opts.display === true){\r\n\r\n\t\t\t\tlet display = getDisplayConfig(key, this, prop);\r\n\r\n\t\t\t\tif(opts.alternative){\r\n\t\t\t\t\tvalue = _.isFunction(display.alternative) && display.alternative.call(this, value, _.extend({},opts,prop), this);\r\n\t\t\t\t}\r\n\t\t\t\telse if(_.isFunction(display.transform)) {\r\n\t\t\t\t\tvalue = display.transform.call(this, value, opts, this);\r\n\t\t\t\t}\r\n\t\t\t\tif(display.ifEmpty && (value == null || value === ''))\r\n\t\t\t\t\treturn display.ifEmpty;\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tdisplay(key, opts = {}){\r\n\t\t\t_.extend(opts, { display:true });\r\n\t\t\treturn this.get(key, opts);\r\n\t\t},\r\n\t\tpropertyName(key) {\r\n\t\t\tlet prop = getPropertySchema(this, key);\r\n\t\t\tlet display = getDisplayConfig(key, this, prop);\r\n\t\t\treturn display.label || key;\r\n\t\t}\r\n\t});\r\n\r\n\treturn Mixed;\r\n};\r\n","\r\nconst defaultCssConfig = {\r\n\tbeforeRender: true,\r\n\tmodelChange: true,\r\n\trefresh: true,\r\n};\r\n\r\nexport default (Base) => Base.extend({\r\n\tconstructor(){\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis._setupCssClassModifiers();\t\t\r\n\t},\r\n\r\n\trefreshCssClass(){\r\n\t\tlet className = this._getCssClassString();\r\n\t\tif(className == ''){\r\n\t\t\tthis.$el.removeAttr('class');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.$el.attr({\r\n\t\t\t\tclass: className\r\n\t\t\t});\r\n\t\t}\r\n\t},\t\r\n\r\n\t_getCssClassModifiers(){\r\n\t\tlet optsModifiers = this.getOption('cssClassModifiers',{deep:false, args:[this.model, this]});\r\n\t\tlet propsModifiers = this.getProperty('cssClassModifiers',{deep:false, args:[this.model, this]});\r\n\t\tlet modifiers = [this.getOption('className')].concat(optsModifiers || [], propsModifiers || []);\r\n\t\treturn modifiers;\r\n\t},\r\n\t//override this if you need other logic\r\n\tgetCssClassModifiers(){\r\n\t\treturn this._getCssClassModifiers();\r\n\t},\r\n\t_getCssClassString()\r\n\t{\r\n\t\tlet modifiers = this.getCssClassModifiers();\r\n\t\tlet classes = _(modifiers).map((cls) => {\r\n\t\t\treturn _.isString(cls) \r\n\t\t\t\t? cls \r\n\t\t\t\t: _.isFunction(cls) \r\n\t\t\t\t\t? cls.call(this, this.model, this) \r\n\t\t\t\t\t: null;\r\n\t\t});\r\n\t\tlet ready = _(classes).filter((f) => f != null && f != '');\r\n\t\tlet className = _.uniq(ready).join(' ');\r\n\t\treturn (className || '').trim();\r\n\t},\r\n\r\n\t_setupCssClassModifiers(){\r\n\r\n\t\tif(this._cssClassModifiersInitialized) return;\r\n\r\n\t\tlet cfg = this.getCssClassConfig();\r\n\t\tif(!cfg) return;\r\n\r\n\t\tlet events = this.getCssClassEvents(cfg);\r\n\t\t_(events).each((eventName) => this.on(eventName, this.refreshCssClass));\r\n\r\n\t\tif (cfg.modelChange && this.model) {\r\n\t\t\tthis.listenTo(this.model, 'change', this.refreshCssClass);\r\n\t\t}\r\n\r\n\t\tthis._cssClassModifiersInitialized = true;\r\n\t},\r\n\t\r\n\t_getCssClassConfig(){\r\n\t\tlet cfg = _.extend({}, defaultCssConfig, this.getOption('cssClassConfig'));\r\n\t\tif(!cfg || _.size(cfg) == 0) return;\r\n\t\treturn cfg;\r\n\t},\r\n\t//override this if you need other logic\r\n\tgetCssClassConfig(){\r\n\t\treturn this._getCssClassConfig();\r\n\t},\r\n\r\n\t_getCssClassEvents(cfg){\r\n\t\tlet events = [].concat(cfg.events || []);\r\n\t\tif(cfg.refresh) events.push('refresh');\r\n\t\tif(cfg.beforeRender) events.push('before:render');\r\n\t\tevents = _(events).uniq();\r\n\t\treturn events;\r\n\t},\r\n\t//override this if you need other logic\r\n\tgetCssClassEvents(cfg){\r\n\t\treturn this._getCssClassEvents(cfg);\r\n\t}\r\n});\r\n","\r\nconst defaultSelector = (name, prefix = '') => prefix + 'region-' + name;\r\n\r\nfunction defaultUpdateDom(name, $el)\r\n{\r\n\tlet selector = defaultSelector(name);\r\n\tlet element = $('<div>').addClass(selector);\r\n\t$el.append(element);\r\n\r\n\treturn '.' + selector;\r\n}\r\n\r\nexport default function buildRegionFunc(view, hash, context){\r\n\r\n\tlet { $el } = view;\t\r\n\tlet { autoCreateRegion } = context;\r\n\tlet { updateDom, name, el } = hash;\r\n\tlet regionEl;\r\n\t\r\n\tlet region = view.getRegion(name);\r\n\r\n\r\n\tif (el == null && autoCreateRegion !== false) {\r\n\r\n\t\tlet testEl = region && region.getOption('el',{ deep:false});\r\n\r\n\t\tif (!region || !testEl || !$el.find(testEl).length) {\r\n\r\n\t\t\tregionEl = defaultUpdateDom(name, $el);\r\n\r\n\t\t} \r\n\r\n\t} else if(_.isFunction(updateDom)) {\r\n\t\tupdateDom.call(view, $el, view);\r\n\r\n\t} \r\n\t\r\n\t\r\n\tif (!region) {\r\n\t\tlet definition = _.pick(hash, 'replaceElement', 'regionClass');\r\n\t\tdefinition.el = hash.el || regionEl;\r\n\t\tregion = view.addRegion(name, definition);\r\n\t}\r\n\r\n\r\n\treturn region;\r\n}\r\n","import buildRegion from './build-region';\r\n\r\nexport default function normalizeNestedViewContextRegion(context) {\r\n\r\n\tlet { region } = context;\r\n\tlet regionName = (_.isString(region) && region) || context.regionName || context.name;\r\n\r\n\tif (_.isString(region) || region == null) {\r\n\t\tregion = {};\r\n\t} else if (_.isFunction(region)) {\r\n\t\tregion = region.call(this, context, this);\r\n\t}\r\n\r\n\tif (_.isObject(region)) {\r\n\r\n\t\tif(!region.name)\r\n\t\t\tregion.name = regionName;\r\n\t\tlet replaceElement = this.getOption('replaceNestedElement');\r\n\t\tcontext.region = _.extend({ replaceElement }, region);\r\n\t\tcontext.show = _.partial(buildRegion, this, context.region, context);\r\n\t}\r\n\treturn context;\r\n}\r\n","import View from './view';\r\nexport default function isView(arg){\r\n\treturn arg instanceof View;\r\n}","import View from './view';\r\nimport isView from './is-view';\r\nexport default function isViewClass(arg) {\r\n\treturn _.isFunction(arg) && (arg == View || isView(arg.prototype));\r\n}\r\n","import result from '../../../utils/better-result';\r\nimport normalizeRegion from './normalize-region';\r\nimport isViewClass from '../../../bb/is-view-class';\r\nexport default Base => Base.extend({\r\n\tconstructor(){\r\n\t\tthis._nestedViews = {};\r\n\t\tBase.apply(this, arguments);\r\n\t\tthis.initializeNestedViews();\r\n\t},\r\n\ttemplate: false,\r\n\r\n\tshowAllNestedViewsOnRender: false,\r\n\tshowNestedViewOnAdd: false,\r\n\treplaceNestedElement: true,\r\n\r\n\tinitializeNestedViews(){\r\n\t\tif (this._nestedViewsInitialized) return;\r\n\r\n\t\tif(this.getOption('showAllNestedViewsOnRender')) {\r\n\t\t\tthis.on('render', () => this.showAllNestedViews());\r\n\t\t}\r\n\r\n\t\tlet nesteds = this.getOption('nestedViews', { args:[this.model, this]});\r\n\t\t_(nesteds).each((context, index) => {\r\n\r\n\t\t\tlet name = _.isString(index) ? index : (context.name || _.uniqueId('nested'));\r\n\t\t\tthis.addNestedView(name, context);\r\n\r\n\t\t});\r\n\r\n\t\tthis._nestedViewsInitialized = true;\r\n\t},\r\n\t_normalizeNestedContext(name, context){\r\n\r\n\t\tif (isViewClass(context)) {\r\n\t\t\tlet View = context;\r\n\t\t\tcontext = {\r\n\t\t\t\tname, View\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t//unwrap to plain object\r\n\t\tif (_.isFunction(context)) {\r\n\t\t\tcontext = context.call(this, this.model, this);\r\n\t\t}\r\n\r\n\t\t//fix name if its not provided\r\n\t\tif (context.name == null) {\r\n\t\t\tcontext.name = name || _.uniqueId('nested');\r\n\t\t}\r\n\r\n\t\t//convert region to valid function\r\n\t\tcontext = normalizeRegion.call(this, context);\t\t\r\n\r\n\r\n\t\treturn context;\r\n\t},\r\n\t_createNestedContext(context){\r\n\t\tlet contexts = this.getNestedViewContext();\r\n\t\tcontexts[context.name] = context;\r\n\t},\r\n\r\n\taddNestedView(name, context){\r\n\r\n\t\tif (!_.isString(name) || name === '') {\r\n\t\t\tthrow new Error('addNestedView: first argument should be a string');\r\n\t\t}\r\n\r\n\t\tcontext = this._normalizeNestedContext(name, context);\r\n\t\tthis._createNestedContext(context);\r\n\t\tif(this.getOption('showNestedViewOnAdd') && this.isRendered()){\r\n\t\t\tthis.showNestedView(context);\r\n\t\t}\t\t\r\n\t},\r\n\r\n\tshowNestedView(name){\r\n\t\tlet region = this.getNestedViewRegion(name);\r\n\t\tlet view = region && this.buildNestedView(name);\r\n\t\tif (view) {\r\n\t\t\tregion.show(view);\r\n\t\t}\r\n\t},\r\n\tshowAllNestedViews(){\r\n\t\tlet contexts = this.getNestedViewContext();\r\n\t\t_(contexts).each(context => this.showNestedView(context));\r\n\t},\r\n\tgetNestedViewContext(name){\r\n\t\tlet contexts = this._nestedViews;\r\n\t\tif (arguments.length == 0)\r\n\t\t\treturn contexts;\r\n\t\telse\r\n\t\t\treturn contexts[name];\r\n\t},\r\n\r\n\r\n\tbuildNestedView(name){\r\n\r\n\t\tlet context = _.isObject(name) ? name\r\n\t\t\t: _.isString(name) ? this.getNestedViewContext(name)\r\n\t\t\t\t: null;\r\n\r\n\t\tif(!context) return;\r\n\r\n\t\tif(_.isFunction(context.template))\r\n\t\t\treturn context.template;\r\n\t\telse {\r\n\t\t\tlet View = context.View;\r\n\t\t\tlet options = this.buildNestedViewOptions(result(context, 'options', { context: this, args: [this, this.model], default:{} }));\r\n\t\t\t\r\n\t\t\treturn new View(options);\r\n\t\t}\r\n\t},\r\n\tbuildNestedViewOptions(opts){\r\n\t\treturn opts;\r\n\t},\r\n\tgetNestedViewRegion(name){\r\n\t\tlet context = _.isObject(name) ? name\r\n\t\t\t: _.isString(name) ? this.getNestedViewContext(name)\r\n\t\t\t\t: null;\r\n\t\treturn context && _.result(context, 'show');\r\n\t}\r\n\t\r\n});\r\n","export default function triggerControlEvent(control, event, ...args){\r\n\r\n\t//let control = _control.getParentControl() || _control;\r\n\r\n\tlet name = control.getControlName();\r\n\tlet eventName = name + ':' + event;\r\n\tlet method = _.isFunction(control.triggerMethod) ? control.triggerMethod\r\n\t\t: _.isFunction(control.trigger) ? control.trigger\r\n\t\t\t: function(){};\r\n\tmethod.call(control, eventName, ...args);\r\n\t\r\n\r\n\tcontrol.proxyControlEventToParent(eventName, ...args);\r\n\r\n}\r\n","export default function getTriggerValue(control, args = []){\r\n\r\n\tlet value = args.length ? args[0] : control.getControlValue();\r\n\r\n\tif(_.isFunction(control.convertValue))\r\n\t\tvalue = control.convertValue(value);\r\n\t\t\r\n\treturn value;\r\n}\r\n","import triggerControlEvent from './trigger-control-event';\r\nimport getTriggerValue from './get-trigger-value';\r\nimport getOption from '../../../utils/get-option';\r\nimport camelCase from '../../../utils/camel-case';\r\n\r\nexport default Base => Base.extend({\t\r\n\r\n\tgetControlValue(){\r\n\t\treturn this.value;\r\n\t},\r\n\tsetControlValue(value){\r\n\t\tthis.value = value;\r\n\t},\r\n\r\n\tgetControlName(){\r\n\t\treturn getOption(this, 'controlName', { args:[this]}) || 'control';\r\n\t},\r\n\r\n\tgetParentControl(){\r\n\t\treturn getOption(this, 'proxyTo', { args:[this]});\r\n\t},\r\n\ttriggerChildControlEvent(eventName, ...args){\r\n\t\tlet events = getOption(this, 'childControlEvents', { args:[this]}) || {};\r\n\t\tif (_.isFunction(events[eventName])) {\r\n\t\t\tevents[eventName].apply(this, args);\r\n\t\t}\r\n\t},\r\n\r\n\ttryValidateControl(value){\r\n\t\tlet validate = getOption(this, 'validateControl', { force: false });\r\n\t\tif(_.isFunction(validate))\r\n\t\t\treturn validate.call(this, value, this);\r\n\t},\r\n\r\n\ttriggerControlChange(){\r\n\t\tthis._triggerControlEvent('change', arguments);\r\n\t},\r\n\ttriggerControlDone(){\r\n\t\tthis._triggerControlEvent('done', arguments);\r\n\t},\r\n\t_isValueAsPrevious(value, type){\r\n\t\tlet previousTriggerName = this.getPreviousTriggerValueKey(type);\r\n\t\tif (previousTriggerName in this) {\r\n\t\t\treturn JSON.stringify(this[previousTriggerName]) === JSON.stringify(value);\r\n\t\t}\r\n\t},\r\n\tisValueAsPrevious(value, type)\r\n\t{\r\n\t\treturn this._isValueAsPrevious(value, type);\r\n\t},\r\n\tsetPreviousTriggerValue(value, type){\r\n\t\tlet key = this.getPreviousTriggerValueKey(type);\r\n\t\tthis[key] = value;\r\n\t},\r\n\tgetPreviousTriggerValueKey(type){\r\n\t\treturn camelCase('_previous:' + type);\r\n\t},\r\n\t_triggerControlEvent(eventName, args) {\r\n\r\n\t\tlet triggerValue = getTriggerValue(this, args);\r\n\t\tif (this.isValueAsPrevious(triggerValue, eventName)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet errors = this.tryValidateControl(triggerValue);\r\n\t\tif (!errors) {\r\n\t\t\tthis.setPreviousTriggerValue(triggerValue, eventName);\t\t\t\r\n\t\t\ttriggerControlEvent(this, eventName, triggerValue);\r\n\t\t} else {\r\n\t\t\tthis.triggerControlInvalid(errors);\r\n\t\t}\r\n\t},\r\n\ttriggerControlInvalid(errors){\r\n\t\ttriggerControlEvent(this, 'invalid', errors);\r\n\t},\r\n\tproxyControlEventToParent(eventName, ...args){\r\n\t\tlet parent = this.getParentControl();\r\n\t\tif (parent && _.isFunction(parent.triggerChildControlEvent)) {\r\n\t\t\tparent.triggerChildControlEvent(eventName, ...args);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\r\n}, {\r\n\tControlMixin: true\r\n});\r\n","import getOption from '../../../utils/get-option';\r\nconst _getOption = (context, key, checkAlso) => getOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function getInputType(inputView, opts = {}){\r\n\t\r\n\tlet valueType = _getOption(inputView, 'valueType', opts);\r\n\tif (valueType == null) {\r\n\t\tlet value = inputView.getControlValue();\r\n\t\tif ( value == null) {\r\n\t\t\tvalueType = 'string';\r\n\t\t} else {\r\n\t\t\tif(_.isNumber(value))\r\n\t\t\t\tvalueType = 'number';\r\n\t\t\telse if(_.isDate(value))\r\n\t\t\t\tvalueType = 'datetime';\r\n\t\t\telse\r\n\t\t\t\tvalueType = 'string';\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tif (valueType == 'number') {\r\n\t\tinputView._valueIsNumber = true;\r\n\t}\r\n\r\n\tlet type = _getOption(inputView, 'inputType', opts);\r\n\r\n\tif (!type) {\r\n\t\tif (inputView._valueIsNumber) {\r\n\t\t\ttype = _getOption(inputView, 'inputNumberType', opts) || 'number';\r\n\t\t} else if (valueType == 'string') {\r\n\t\t\ttype = 'text';\r\n\t\t} else if (valueType == 'datetime') {\r\n\t\t\ttype = 'datetime';\r\n\t\t} else {\r\n\t\t\ttype = 'text';\r\n\t\t}\r\n\t}\r\n\tinputView.inputType = type;\r\n\tinputView.valueType = valueType;\r\n\treturn type;\r\n}\r\n","import getInputType from './get-input-type';\r\n\r\nimport getOption from '../../../utils/get-option';\r\n\r\nexport default function setInputAttributes(inputView, opts = {}) {\r\n\r\n\tlet attributes = getOption(inputView, 'attributes', { checkAlso: opts, args:[inputView] });\r\n\r\n\tlet restrictionKeys = {\r\n\t\t'maxLength':'maxlength', \r\n\t\t'minValue':'min', \r\n\t\t'maxValue':'max', \r\n\t\t'valuePattern':'pattern',\r\n\t\t'required':'required',\r\n\t\t'value':'value'\r\n\t};\r\n\tlet restrictions = {};\r\n\t_(restrictionKeys).each((key2, key) => {\r\n\t\tlet value = getOption(inputView, key, { checkAlso: opts, args:[inputView] });\r\n\t\tif (value != null)\r\n\t\t\trestrictions[key2] = value;\r\n\t});\r\n\r\n\tinputView.attributes = _.extend({\r\n\t\tvalue: inputView.value,\r\n\t\ttype: getInputType(inputView, opts),\r\n\t}, restrictions, attributes);\r\n\r\n}\r\n","import getOption from '../../../../utils/get-option';\r\nexport default (context, key, ifNull) => getOption(key, { args:[context], default: ifNull });\r\n\r\n","export default function isChar(event){\r\n\treturn event.key && event.key.length == 1 && !event.ctrlKey;\r\n}","import getOption from './_get-option';\r\nimport isChar from './_is-char';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\tlet prevent = false;\r\n\tlet stop = false;\r\n\r\n\tif (isChar(event)) {\r\n\t\tif (!context.isEnteredCharValid(event.key)) {\r\n\t\t\tprevent = true;\r\n\t\t}\r\n\t}\r\n\tif(event.keyCode == 13 && getOption(context, 'doneOnEnter', true)){\r\n\t\tprevent = true;\r\n\t\tstop = true;\r\n\t}\r\n\r\n\tstop && event.stopPropagation();\r\n\tprevent && event.preventDefault();\r\n}\r\n","import getOption from './_get-option';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\tif(event.keyCode == 13 && getOption(context, 'doneOnEnter', true)){\r\n\t\tcontext.triggerControlDone();\r\n\t\tevent.stopPropagation();\r\n\t\tevent.preventDefault();\r\n\t}\r\n}","export default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\tlet text = event.originalEvent.clipboardData.getData('text/plain');\r\n\tif (!text) return;\r\n\tif (!context.isValueValid(text)) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\t}\r\n}\r\n","import getOption from './_get-option';\r\nexport default function(eventContext) {\r\n\tlet { context } = eventContext;\r\n\tif (getOption(context, 'doneOnBlur', true)) {\r\n\t\tcontext.triggerControlDone();\r\n\t}\r\n}","import getOption from './_get-option';\r\nexport default function(eventContext) {\r\n\tlet { context, input } = eventContext;\r\n\tif (getOption(context, 'selectOnFocus', true)) {\r\n\t\tinput.select();\r\n\t}\r\n}\r\n","export default function(eventContext) {\r\n\r\n\tlet { context, input, event } = eventContext;\r\n\r\n\tlet newvalue = context.setControlValue(event.target.value);\r\n\tif (event.target.value != (newvalue || '').toString()) {\r\n\t\tinput.value = newvalue;\r\n\t}\r\n\t//context.triggerControlChange();\r\n}\r\n","import keydown from './keydown';\r\nimport keyup from './keyup';\r\nimport paste from './paste';\r\nimport blur from './blur';\r\nimport focus from './focus';\r\nimport input from './input';\r\n//import jsChange from './js-change';\r\nexport default {\r\n\tkeydown, \r\n\t//keypress,\r\n\tkeyup,\r\n\tpaste,\r\n\tblur,\r\n\tfocus,\r\n\tinput,\r\n\t//'js:change': jsChange\r\n};","import camelCase from '../../../utils/camel-case';\r\nimport events from './events';\r\nexport default function handleInputEvent(control, eventName, event) {\r\n\tlet options = _.extend({\r\n\t\tcontext: control,\r\n\t\tinput: control.el,\r\n\t\trestrictions: control.restrictions,\r\n\t\teventName,\r\n\t\tevent\r\n\t});\r\n\r\n\r\n\tlet method = camelCase(`on:dom:${eventName}`);\r\n\r\n\tif (_.isFunction(events[eventName])) {\r\n\t\tevents[eventName].call(control, options);\r\n\t} \r\n\t\r\n\tif (_.isFunction(control[method])) {\r\n\t\tcontrol[method](event, options);\r\n\t} \r\n}","import handleEvent from './handle-event';\r\nimport eventHandlers from './events';\r\nimport getOption from '../../../utils/get-option';\r\n\r\nconst _getOption = (context, key, checkAlso) => \r\n\tgetOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function setInputEvents(inputView, opts = {}) {\r\n\r\n\tlet passedEvents = _getOption(inputView, 'events', opts);\t\r\n\r\n\tlet eventsArray = _(eventHandlers).keys();\t\r\n\tlet events = _.reduce(eventsArray, (Memo, eventName) => {\r\n\t\tMemo[eventName] = function(event){ \r\n\t\t\thandleEvent(this, eventName, event); \r\n\t\t};\r\n\t\treturn Memo;\r\n\t}, {});\r\n\tinputView.events = _.extend(events, passedEvents);\r\n}\r\n","export default function toNumber(text){\r\n\tif(_.isNumber(text)) return text;\r\n\tif(!_.isString(text)) return;\r\n\t\r\n\tlet value = parseFloat(text, 10);\r\n\tif(isNaN(value))\r\n\t\tvalue = undefined;\r\n\t\t\r\n\treturn value;\r\n}\r\n","export default {\r\n\tnullable: true, \r\n\tstrict: false,\r\n\treturnNullAs: undefined, \r\n\treturnEmptyAs: undefined, \r\n\treturnNullAndEmptyAs: undefined,\r\n\treturnAnyAs: undefined, \r\n\treturnOtherAs: undefined\r\n};\r\n","import defaultOptions from './options';\r\n\r\nconst trueValues = ['true','1','-1','yes'];\r\nconst falseValues = ['false','0','no'];\r\n\r\nconst alternative = function(...args) {\r\n\tlet returnValue;\r\n\t_(args).some(arg => {\r\n\t\tif(_.isBoolean(arg)) {\r\n\t\t\treturnValue = arg;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t});\r\n\treturn returnValue;\r\n};\r\n\r\nconst valueOrAlternative = function(nullable, nullValue, value, ...alts){\r\n\tlet alt = alternative(...alts);\r\n\tif (alt != null)\r\n\t\treturn alt;\r\n\telse if (nullable)\r\n\t\treturn nullValue;\r\n\telse\r\n\t\treturn value;\r\n};\r\n\r\nconst convertToBoolean = function (arg, opts = {})\r\n{\r\n\r\n\tlet other;\r\n\tlet options = _.extend({}, defaultOptions, opts);\r\n\tlet { \r\n\t\tnullable, strict,\r\n\t\treturnNullAs, returnEmptyAs, returnNullAndEmptyAs,\r\n\t\treturnAnyAs, returnOtherAs\r\n\t} = options;\r\n\r\n\r\n\r\n\tif (arg == null) {\r\n\t\treturn valueOrAlternative(nullable, undefined, false, returnNullAs, returnNullAndEmptyAs);\r\n\t}\r\n\telse if (arg === '') {\r\n\t\treturn valueOrAlternative(nullable, undefined, false, returnEmptyAs, returnNullAndEmptyAs);\r\n\t} else if (_.isBoolean(arg)) {\r\n\t\treturn arg;\r\n\t}\r\n\t//  else if (_.isObject(arg)) {\r\n\t// }\r\n\t\r\n\tother = strict \r\n\t\t? (nullable ? undefined : false) \r\n\t\t: true;\r\n\t\t\r\n\r\n\tlet text = arg.toString().toLowerCase();\r\n\tlet isTrue = convertToBoolean.trueValues.indexOf(text) > -1;\r\n\tlet isFalse = convertToBoolean.falseValues.indexOf(text) > -1;\r\n\r\n\r\n\tif (_.isBoolean(returnAnyAs)) {\r\n\t\treturn returnAnyAs;\r\n\t} else if (_.isBoolean(returnOtherAs)) {\r\n\t\tother = returnOtherAs;\r\n\t}\r\n\t\r\n\treturn isTrue \r\n\t\t? true \r\n\t\t: isFalse \r\n\t\t\t? false \r\n\t\t\t: other;\r\n};\r\n\r\nconvertToBoolean.trueValues = trueValues;\r\nconvertToBoolean.falseValues = falseValues;\r\nexport default convertToBoolean;\r\n","import toNumber from './to-number';\r\nimport toBoolean from '../to-bool';\r\n\r\n\r\n//this is under development yet and can be change in any time\r\nexport default function convertString(text, type, opts) {\r\n\r\n\tswitch(type){\r\n\tcase 'number':\r\n\t\treturn toNumber(text, opts);\r\n\tcase 'boolean':\r\n\t\treturn toBoolean(text, opts);\r\n\tdefault:\r\n\t\treturn text;\r\n\t}\r\n\r\n\r\n}\r\n","import ControlMixin from '../control';\r\nimport setInputAttributes from './set-attributes';\r\nimport setInputEvents from './set-events';\r\nimport getOption from '../../../utils/get-option';\r\nimport convert from '../../../utils/convert-string';\r\n\r\nexport default Base => {\r\n\r\n\tlet Mixin = Base.ControlMixin ? Base : ControlMixin(Base);\r\n\r\n\treturn Mixin.extend({\r\n\t\tconstructor(opts){\r\n\t\t\t\r\n\t\t\tsetInputAttributes(this, opts);\r\n\t\t\tsetInputEvents(this, opts);\r\n\t\t\tMixin.apply(this, arguments);\r\n\r\n\t\t\tif (!_.isFunction(this.getOption)) {\r\n\t\t\t\tthis.getOption = _.partial(getOption, this, _, { args: [this]});\r\n\t\t\t}\r\n\r\n\t\t\tthis.buildRestrictions();\r\n\t\t\tlet value = this.getOption('value') || '';\t\t\t\r\n\t\t\tthis.el.value = value;\r\n\t\t\tthis.setControlValue(value);\r\n\t\t},\r\n\t\ttagName:'input',\r\n\t\ttemplate: false,\r\n\t\tbuildRestrictions(){\r\n\t\t\tlet attrs = _.result(this, 'attributes');\r\n\t\t\tlet pickNumbers = ['maxlength', 'min', 'max'];\r\n\t\t\tlet pickStrings = ['pattern'];\r\n\t\t\tlet pickBools = ['required'];\r\n\t\t\tlet restrictions = {};\r\n\t\t\t_(attrs).each((value, key) => {\r\n\t\t\t\tlet pick = false;\r\n\t\t\t\tkey = key.toLowerCase();\r\n\t\t\t\tif (pickNumbers.indexOf(key) > -1) {\r\n\t\t\t\t\tvalue = convert(value, 'number');\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickStrings.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickBools.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t\tvalue = convert(value, 'boolean', { returnNullAndEmptyAs: true, returnOtherAs: true });\r\n\t\t\t\t}\r\n\t\t\t\tpick && (restrictions[key] = value);\r\n\t\t\t});\r\n\t\t\tthis.restrictions = restrictions;\t\t\r\n\t\t},\r\n\t\tsetControlValue(value, opts = {})\r\n\t\t{\r\n\t\t\tthis.value = this.prepareValueBeforeSet(value);\r\n\t\t\tif(!opts.silent)\r\n\t\t\t\tthis.triggerControlChange();\r\n\t\t\treturn this.value;\r\n\t\t},\r\n\t\tprepareValueBeforeSet(value){\r\n\t\t\tif (value == null || value === '') return value;\r\n\t\t\t\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\tif (len > 0) {\r\n\t\t\t\tvalue = value.toString().substring(0, len);\r\n\t\t\t}\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tlet num = convert(value, 'number');\r\n\t\t\t\tif(isNaN(num))\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlet min = this.restrictions.min;\r\n\t\t\t\tlet max = this.restrictions.max;\r\n\t\t\t\t!isNaN(min) && num < min && (num = min);\r\n\t\t\t\t!isNaN(max) && num > max && (num = max);\r\n\t\t\t\treturn num;\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tgetValueType(){\r\n\t\t\treturn this.valueType;\r\n\t\t},\r\n\t\tconvertValue(value){\r\n\t\t\treturn convert(value, this.getValueType());\r\n\t\t},\t\t\r\n\t\tgetMaxLength()\r\n\t\t{\r\n\t\t\treturn this.restrictions.maxlength;\r\n\r\n\t\t},\r\n\t\tisLengthValid(){\r\n\t\t\tlet value = this.getControlValue();\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\treturn len == null || value.length < len;\r\n\t\t},\r\n\t\tisEnteredCharValid(char) {\r\n\t\t\tlet type = this.getValueType();\r\n\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn ['.','-'].indexOf(char) > -1 || !isNaN(parseInt(char, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tisValueValid(value){\r\n\t\t\tlet type = this.getValueType();\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn !isNaN(parseFloat(value, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tvalidateControlValue(value){\r\n\t\t\tif (value == null || value === '') {\r\n\t\t\t\tif(this.restrictions.required)\r\n\t\t\t\t\treturn 'required';\r\n\t\t\t\telse\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet strValue = value.toString();\r\n\t\t\tif (_.isNumber(this.restrictions.maxlength) && strValue.length > this.restrictions.maxlength)\r\n\t\t\t\treturn 'length:big';\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tif (!_.isNumber(value))\r\n\t\t\t\t\treturn 'not:number';\r\n\t\t\t\tif (_.isNumber(this.restrictions.min) && value < this.restrictions.min)\r\n\t\t\t\t\treturn 'less:than:min';\r\n\t\t\t\tif (_.isNumber(this.restrictions.max) && value > this.restrictions.max)\r\n\t\t\t\t\treturn 'greater:than:max';\r\n\t\t\t}\r\n\t\t\tif (this.restrictions.pattern) {\r\n\t\t\t\tlet pattern = RegExp(this.restrictions.pattern);\r\n\t\t\t\tif (pattern.test(strValue)) {\r\n\t\t\t\t\treturn 'pattern:mismatch';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n};\r\n","function pstoSetPair(context, pair){\r\n\tif(!_.isString(pair)) return;\r\n\tlet keyvalue = pair.split('=');\r\n\tlet key = keyvalue.shift();\r\n\tlet value = keyvalue.join('=');\r\n\tpstoSetKeyValue(context, key, value);\r\n}\r\n\r\nfunction pstoSetKeyValue(context, key, value){\r\n\t\t\r\n\tif (key == null) return;\r\n\tkey = decodeURIComponent(key);\r\n\tvalue != null && (value = decodeURIComponent(value));\r\n\r\n\tif(!(key in context))\r\n\t\treturn (context[key] = value);\r\n\r\n\t!_.isArray(context[key]) && (context[key] = [context[key]]);\r\n\r\n\tcontext[key].push(value);\r\n\r\n\treturn context[key];\r\n}\r\n\r\nexport default function paramsToObject(raw, opts = {emptyObject: true}){\r\n\tlet result = {};\r\n\tif(!_.isString(raw)) return opts.emptyObject ? result : raw;\r\n\r\n\tlet pairs = raw.split('&');\r\n\t_(pairs).each((pair) => pstoSetPair(result, pair));\r\n\t\r\n\treturn result;\r\n}\r\n","import result from '../../../utils/better-result';\r\n\r\nfunction get(router, opts = {}, key, update){\r\n\t\r\n\tlet value = result(opts, key, { context: router, args:[ router ] });\r\n\tif(value == null) {\r\n\t\tvalue = router.getOption(key, {args: [ router ]});\r\n\t\tif(update)\r\n\t\t\topts[key] = value;\r\n\t}\r\n\treturn value;\t\t\r\n}\r\n\r\n// converts route method arguments to plain object;\r\n// _normalizeRegisterRouteArguments\r\n// { route, rawRoute, callback, name }\r\nexport default function routeArgumentsToObject(router, route, name, callback, opts = {}){\r\n\r\n\tlet context = {};\r\n\r\n\tif(_.isObject(route)){\r\n\t\tcontext = route;\r\n\t\t//_.extend(context, route);\r\n\t\t//then second argument is probably options;\r\n\t\t_.extend(opts, name);\r\n\r\n\t} else if (_.isFunction(name)) {\r\n\t\t_.extend(context, { route, callback: name, name: _.uniqueId('routerAction') });\r\n\t} else {\r\n\t\t_.extend(context, { route, name, callback });\r\n\t}\r\n\r\n\tlet isRouterHoldsActions = get(router, opts, 'isRouterHoldsActions', true);\r\n\t//let isRouteChaining = get(router, opts, 'isRouteChaining', true);\r\n\r\n\t// !_(opts).has('isRouterHoldsActions') && (opts.isRouterHoldsActions = this.getOption('isRouterHoldsActions'));\r\n\t// !_(opts).has('isRouteChaining') && (opts.isRouteChaining = this.getOption('isRouteChaining'));\r\n\r\n\r\n\t// last chance to get callback from router instance by name\r\n\t// this behavior can be disabled through `isRouterHoldsActions` options\r\n\tif(!_.isFunction(context.callback) && isRouterHoldsActions && _.isFunction(router[context.name])) {\r\n\r\n\t\tcontext.callback = router[context.name];\r\n\r\n\t}\r\n\r\n\t//store original route\r\n\tcontext.rawRoute = context.route;\r\n\r\n\t!context.name && (context.name = _.uniqueId('routerAction'));\r\n\r\n\t//converts route to RegExp pattern\r\n\tif (!_.isRegExp(context.route)) context.route = router._routeToRegExp(context.route);\r\n\r\n\t// by default backbone router wraps every callback with own wrapper\r\n\t// which in turn call actual callback with correct arguments on route\r\n\t// this callback was inlined and can not be overrided, so now its possible\t\r\n\tcontext.callbackWrapper = _.bind(router._processCallback, router, context);\r\n\r\n\treturn context;\r\n}\r\n\r\n\r\n\r\n","export function createActionContext(router, routeContext, fragment, options = {}) {\r\n\r\n\tlet rawArgs = router._extractParameters(routeContext.route, fragment);\r\n\r\n\tlet result = _.extend({}, routeContext, { fragment, rawArgs }, options, { options });\r\n\r\n\tlet args = rawArgs.slice(0);\r\n\tlet queryString = args.pop();\r\n\r\n\t_.extend(result, { qs: prepareActionQueryString(router, queryString) });\r\n\t_.extend(result, { args: prepareActionArguments(routeContext.rawRoute, args) });\r\n\r\n\tif (result.routeType == null) {\r\n\t\tresult.routeType = 'route';\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction prepareActionQueryString(router, queryString){\r\n\tif(_.isString(queryString))\r\n\t\treturn router.queryStringParser(queryString);\r\n\telse\r\n\t\treturn {};\r\n}\r\n\r\nfunction prepareActionArguments(rawRoute, args){\r\n\r\n\tlet params = rawRoute.match(/:([^/|)]+)/g) || [];\r\n\t\r\n\tlet res = {};\r\n\t_(params).each((name, index) => {\r\n\t\tname = name.substring(1);\r\n\t\t\r\n\t\tif(args == null) return;\r\n\r\n\t\tif(name in res && _.isArray(res[name]))\r\n\t\t\tres[name].push(args[index]);\r\n\t\telse if(name in res && !_.isArray(res[name]))\r\n\t\t\tres[name] = [res[name]].concat(args[index]);\r\n\t\telse\r\n\t\t\tres[name] = args[index];\r\n\t});\r\n\treturn res;\r\n}\r\n","//import triggerMethodOn from '../../mn/trigger-method-on';\r\n\r\nfunction toPromise(arg, resolve = true){\r\n\tif (arg instanceof Promise || (arg && _.isFunction(arg.then)))\r\n\t\treturn arg;\r\n\telse if (arg instanceof Error)\r\n\t\treturn Promise.reject(arg);\r\n\telse\r\n\t\treturn resolve \r\n\t\t\t? Promise.resolve(arg) \r\n\t\t\t: Promise.reject(arg);\r\n}\r\nfunction getCallbackFunction(callback, executeResult)\r\n{\r\n\treturn (...args) => {\r\n\t\ttry {\r\n\t\t\texecuteResult.value = callback && callback(...args);\r\n\t\t} catch(exception) {\r\n\t\t\texecuteResult.value = exception;\r\n\t\t}\r\n\t\texecuteResult.promise = toPromise(executeResult.value);\r\n\t\treturn executeResult.value;\r\n\t};\r\n}\r\n\r\n\r\nexport function processCallback(router, actionContext, routeType){\t\r\n\t\r\n\tlet args = router.getOption('classicMode') \r\n\t\t? actionContext.rawArgs || [] \r\n\t\t: [ actionContext ];\r\n\r\n\tlet asPromise = router.getOption('callbackAsPromises');\r\n\tlet executeResult = {};\r\n\tlet callback = getCallbackFunction(actionContext.callback, executeResult, asPromise);\r\n\r\n\t//console.log('routeType:',routeType);\r\n\r\n\trouter.triggerEvent('before:' + routeType, actionContext);\r\n\r\n\tlet shouldTriggerEvent = router.execute(callback, args);\r\n\tif (shouldTriggerEvent !== false) {\r\n\t\trouter.triggerEvent(routeType, actionContext);\r\n\t}\r\n\r\n\texecuteResult.promise.then(\r\n\t\t(arg) => {\r\n\t\t\trouter.triggerEvent('after:'+routeType, actionContext);\r\n\t\t\treturn arg;\r\n\t\t},\r\n\t\t(error) => {\r\n\t\t\trouter.triggerEvent('error:' + routeType, error, actionContext);\r\n\t\t\trouter.handleError(error, actionContext);\r\n\t\t}\r\n\t);\r\n\r\n\treturn executeResult.value;\r\n}\r\n\r\n\r\n\r\n","\r\nexport default {\r\n\thandlers: {\r\n\t\t'js:error'(error){\r\n\t\t\tthrow error;\r\n\t\t},\r\n\t},\r\n\thandle(error, context, args){\r\n\r\n\t\tlet handlers = this._getHandleContext(error, context, args) || {};\r\n\t\treturn _(handlers).some((options, key) => this.applyHandler(key, options));\r\n\r\n\t},\r\n\tapplyHandler(key, options = {}){\r\n\r\n\t\tlet handler = this.getHandler(key, options);\r\n\t\tif (!handler) return;\r\n\t\tlet { context, args } = options;\r\n\t\treturn handler.apply(context, args);\r\n\r\n\t},\r\n\tgetHandler(key){\r\n\t\tif(_.isFunction(this.handlers[key]))\r\n\t\t\treturn this.handlers[key];\r\n\t},\r\n\tsetHandler(key, handler){\r\n\t\tif(!_.isString(key) || key === '')\r\n\t\t\tthrow new Error('setHandler first argument must be a non empty string');\r\n\r\n\t\tif (!_.isFunction(handler)) {\r\n\t\t\tdelete this.handlers[key];\r\n\t\t} else {\r\n\t\t\tthis.handlers[key] = handler;\r\n\t\t}\r\n\t},\r\n\tsetHandlers(hash){\r\n\t\tlet nullable = hash === null;\r\n\t\tlet items = nullable && this.handlers || hash;\r\n\t\tif(!_.isObject(items)) return;\r\n\t\t_(items).each((handler, key) => this.setHandler(key, nullable || handler));\r\n\t},\r\n\r\n\t// should return hash: { 'handler_key': { context: handler_context, args: handler_arguments}}\r\n\t_getHandleContext(error, context, args = []){\r\n\r\n\t\tif (_.isArray(error)) {\r\n\t\t\treturn _(error).reduce((memo, item) => _.extend(memo, this._getHandleContext(item, context, args)), {});\r\n\t\t}\r\n\r\n\t\tif(_.isFunction(this.getHandleContext)) {\r\n\t\t\tlet custom = this.getHandleContext(error, context, args);\r\n\t\t\tif(custom != null) return custom;\r\n\t\t}\r\n\r\n\t\tif (error instanceof Error) {\r\n\t\t\targs.unshift(error);\r\n\t\t\treturn { 'js:error': { context, args } };\r\n\t\t}\r\n\t\telse if(_.isString(error)) {\r\n\t\t\treturn { [error]: { context, args } };\r\n\t\t}\r\n\t\telse if(error instanceof $.Deferred().constructor){\r\n\t\t\targs.unshift(error);\r\n\t\t\treturn { 'jq:xhr': { context, args }};\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// provide your own arguments processor\r\n\t// should return hash: { 'handler_key': { context: handler_context, args: handler_arguments}}\r\n\tgetHandleContext: undefined,\r\n\r\n};\r\n","import mix from '../../../utils/mix';\r\nimport GetOptionMixin from '../../../mixins/common/get-option';\r\nimport paramStringToObject from '../../../utils/params-to-object';\r\nimport BbRouter from '../../../bb/router';\r\n//import triggerMethodOn from '../../mn/trigger-method-on';\r\nimport buildRouteContextFromArguments from './build-route-context';\r\n\r\nimport  { createActionContext } from './action-context';\r\nimport { processCallback } from './process-callback';\r\nimport errorHandler from '../route-error-handler';\r\n//import { historyNavigate } from '../../bb/history';\r\n\r\nconst BaseRouter = mix(BbRouter).with(GetOptionMixin);\r\nconst Router = BaseRouter.extend({\r\n\r\n\r\n\t// for migrating from Mn.AppRoute\r\n\t// set to true. it will populate routes from { controller, appRoutes } structure.\r\n\tisMarionetteStyle: false,\r\n\r\n\t// by default Backbone.Router tries to lookup callback in router instance by name `callback = this[name]` if there is no callback provided\r\n\t// its recomend to turn this feature to false\r\n\t// default value is true for Backbone.Router compatability\r\n\tisRouterHoldsActions : true,\r\n\r\n\t// by default Backbone.Router `route` method returns router itself instead of just created routeContext for chaining purposes.\r\n\t// you can change this behavior turning this feature to false\r\n\tisRouteChaining: true,\r\n\r\n\t//in classic mode actions receive argument array\r\n\t//if you need actionContext instead turn this option to false\r\n\tclassicMode: true,\r\n\r\n\tconstructor(options = {}){\r\n\t\t\r\n\t\tthis.options = _.extend({}, _.result(this, 'options'), options);\r\n\r\n\t\tBaseRouter.apply(this, arguments);\r\n\r\n\t\t//this.on('re:route:last', this._onReRouteLast);\r\n\t},\r\n\r\n\r\n\t/*\r\n\r\n\t\tinitialize methods\r\n\t\t\"when a router initialized\"\r\n\r\n\t*/\r\n\r\n\t//by default router expects that routes will result in { route, callback } hash\r\n\t//we are extending this to provide more flexibility\r\n\t// - overrided\r\n\t_bindRoutes: function() {\r\n\t\t\r\n\t\tlet routes = this.getInitRoutes();\r\n\t\tif(!_.size(routes)) return;\r\n\t\tthis.addRoutes(routes);\r\n\r\n\t},\r\n\tgetInitRoutes(){\r\n\t\tlet routes;\r\n\t\tif(this.getOption('isMarionetteStyle')) {\r\n\t\t\tlet controller = this.getOption('controller') || {};\r\n\t\t\tlet approutes = this.getOption('appRoutes') || {};\r\n\t\t\troutes = _(approutes).map((name, route) => ({ \r\n\t\t\t\troute, name, \r\n\t\t\t\tcallback: controller[name] \r\n\t\t\t}));\r\n\t\t}\r\n\t\telse {\r\n\t\t\troutes = this.getOption('routes');\r\n\t\t}\r\n\t\treturn routes;\r\n\t},\r\n\r\n\r\n\t/*\r\n\t\tmanipulating routes\r\n\t\tadding\r\n\t*/\r\n\r\n\t// refactored original route method\r\n\t// chain:true by default is for supporting default behavior\r\n\t// routerHoldsActions: true - backbone router tries to get callback from router itself if there is no callback provided. \r\n\t// this options allow to support this behavior, but its recomended not to hold action inside router instance\r\n\t// - overrided\r\n\troute(route, name, callback, opts = {}){\r\n\t\t\r\n\t\t//normalizing passed arguments and putting them into a context object\r\n\t\t//refactored from original route\r\n\t\t// let context = this._normalizeRegisterRouteArguments(route, name, callback, opts);\r\n\r\n\t\t// //extends context with result of `mergeWithRegisterRouteContext`\r\n\t\t// this._normalizeRegisterRouteContext(context);\r\n\r\n\t\t// //wrapping provided callback \r\n\t\t// this._normalizeRegisterRouteCallback(context);\r\n\r\n\t\tlet context = this._buildRouteContext(route, name, callback, opts);\r\n\r\n\t\t//refactored for providing possibility to override\r\n\t\t//at this point context should be almost ready\r\n\t\tthis.registerRouteContext(context);\r\n\r\n\t\tthis._storeCreatedContext(context, opts);\r\n\r\n\t\treturn opts.isRouteChaining === true \r\n\t\t\t? this \r\n\t\t\t: context;\r\n\r\n\t},\r\n\r\n\t// provide more semantic alias for route\r\n\taddRoute(route, name, callback, opts = {}){\r\n\t\tif(opts.isRouteChaining == null)\r\n\t\t\topts.isRouteChaining = this.getOption('isRouteChaining');\r\n\r\n\t\tlet context = this.route(route, name, callback, opts);\r\n\t\treturn context;\r\n\t},\r\n\r\n\t//process many routes at once\r\n\t//accepts object { name, routeContext | handler }\r\n\t// or array of routeContexts\r\n\taddRoutes(routes, opts = {}){\r\n\r\n\t\tif(opts.isRouteChaining == null)\r\n\t\t\topts.isRouteChaining = this.getOption('isRouteChaining');\r\n\r\n\t\tlet normalized = _(routes)\r\n\t\t\t.chain()\r\n\t\t\t.map((value, key) => this._normalizeRoutes(value, key))\r\n\t\t\t.filter(f => _.isObject(f))\r\n\t\t\t.value();\r\n\r\n\t\tif(opts.doNotReverse != true)\r\n\t\t\tnormalized.reverse();\r\n\r\n\t\tlet registered = _(normalized).map(\r\n\t\t\troute => route && \r\n\t\t\tthis.addRoute(route, _.extend({ massAdd:true }, opts))\r\n\t\t); \r\n\t\t\r\n\t\tif(opts.doNotReverse != true)\r\n\t\t\tregistered.reverse();\r\n\r\n\t\t_(registered).each((c) => this._storeCreatedContext(c));\r\n\t\t\r\n\t\treturn registered;\r\n\t},\r\n\r\n\t// internal method called by `addRoutes` to normalize provided data\r\n\t_normalizeRoutes(value, key){\r\n\t\t//let route, name, callback;\r\n\t\tlet context;\r\n\t\tif (_.isString(value)) {\r\n\t\t\tcontext = { \r\n\t\t\t\troute: key, \r\n\t\t\t\tname: value, \r\n\t\t\t};\r\n\t\t}\r\n\t\telse if(_.isFunction(value)){\r\n\t\t\tcontext = { route:key, callback:value };\r\n\t\t}else if(_.isObject(value)){\r\n\t\t\tcontext = _.clone(value);\r\n\t\t\tif(!_.has(context, 'route'))\r\n\t\t\t\tcontext.route = key;\r\n\t\t\telse if(_.has(context, 'route') && !_.has(context, 'name'))\r\n\t\t\t\tcontext.name = key;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn context;\r\n\t},\r\n\r\n\r\n\r\n\r\n\t_buildRouteContext(route, name, callback, opts) {\r\n\r\n\t\tlet context = buildRouteContextFromArguments(this, route, name, callback, opts);\r\n\r\n\t\treturn this.buildRouteContext(context);\r\n\t},\r\n\r\n\t//override this method if you need more information in route context\r\n\t// should return object wich will be merged with default context\r\n\t// be aware of providing reserved properties: route, name, callback\r\n\t// this will override context defaults\r\n\tbuildRouteContext: context => context,\r\n\r\n\r\n\t//finally, putting handler to the backbone.history.handlers\r\n\tregisterRouteContext(context){\r\n\t\tBackbone.history.route(context.route, context.callbackWrapper, context);\r\n\t},\r\n\r\n\t//store registered context for further use\r\n\t_storeCreatedContext(context, opts = {}){\r\n\t\tthis.routeContexts || (this.routeContexts = {});\r\n\t\tif(!opts.massAdd)\r\n\t\t\tthis.routeContexts[context.name] = context;\r\n\t\treturn context;\r\n\t},\r\n\r\n\r\n\r\n\t/*\r\n\t\r\n\t\tprocess route methods\t\t\r\n\t\t\"when route happens\"\r\n\r\n\t*/\r\n\r\n\t//inner route handler\r\n\t//preparing actionContext and calls public processCallback\r\n\t_processCallback (routeContext, fragment, options = {}) {\r\n\t\tlet actionContext = createActionContext(this, routeContext, fragment, options);\r\n\t\tlet result = this.processCallback(actionContext, actionContext.routeType, options);\r\n\t\treturn result;\r\n\t},\r\n\t\r\n\t//by default behave as original router\r\n\t//override this method to process action by your own\r\n\tprocessCallback(actionContext, routeType){\r\n\r\n\t\treturn processCallback(this, actionContext, routeType);\r\n\r\n\t},\r\n\r\n\thandleError(error, action){\t\t\r\n\t\terrorHandler.handle(error, this, [action]);\r\n\t},\r\n\r\n\t//just triggers appropriate events\r\n\t// triggerRouteEvents(context, event, name, ...args) {\r\n\t// \tif (event == 'route') {\r\n\t// \t\tthis.lastActionContext = context;\r\n\t// \t}\r\n\t// \tthis.trigger(`${event}:${name}`, ...args);\r\n\t// \tthis.trigger(event, name, ...args);\r\n\t// \tBackbone.history.trigger(event, this, name, ...args);\r\n\t// },\r\n\r\n\ttriggerEvent(event, context){\r\n\t\tthis.trigger(event, context);\r\n\t\tBackbone.history.trigger(event, context);\r\n\t},\r\n\r\n\r\n\r\n\r\n\t//converts string to object\r\n\t//default implementation, can be overriden by user\r\n\tqueryStringParser: paramStringToObject,\t\r\n\r\n\t// navigate(...args){\r\n\t// \thistoryNavigate(...args);\r\n\t// \treturn this;\r\n\t// },\r\n\r\n\t_routeToRegExp(route) {\r\n\r\n\t\tvar optionalParam = /\\((.*?)\\)/g;\r\n\t\tvar namedParam    = /(\\(\\?)?:\\w+/g;\r\n\t\tvar splatParam    = /\\*\\w+/g;\r\n\t\tvar escapeRegExp  = /[-{}[]+?.,\\\\\\^$|#\\s]/g;\r\n\r\n\t\troute = route.replace(escapeRegExp, '\\\\$&')\r\n\t\t\t.replace(optionalParam, '(?:$1)?')\r\n\t\t\t.replace(namedParam, function(match, optional) {\r\n\t\t\t\treturn optional ? match : '([^/?]+)';\r\n\t\t\t})\r\n\t\t\t.replace(splatParam, '([^?]*?)');\r\n\t\tlet flags = this.getOption('routeCaseInsensitive') ? 'i' : '';\r\n\t\treturn new RegExp('^' + route + '(?:\\\\?([\\\\s\\\\S]*))?$', flags);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t\tSome API methods\r\n\t*/\r\n\r\n\tgetContextByFragment(fragment)\t{\r\n\t\tif(!_.isString(fragment)) return;\r\n\t\t//let contexts = this.routeContexts;\r\n\t\t//console.log('Router contexts', contexts);\r\n\t\tlet result = _(this.routeContexts).find((cntx) => cntx.route.test(fragment));\r\n\t\treturn result;\r\n\t}\r\n\r\n\r\n});\r\n\r\nexport default Router;\r\n","import Process from '../../process';\r\nimport BaseRouter from '../router';\r\nimport errorHandler from '../route-error-handler';\r\n\r\nexport default BaseRouter.extend({\r\n\t\r\n\tclassicMode:false,\r\n\tisRouterHoldsActions : false,\r\n\tisRouteChaining: false,\t\r\n\tcallbackAsPromises: true,\r\n\trouteCaseInsensitive: true,\r\n\tregisterPageRoutes(page){\r\n\t\tlet contexts = page.getRoutesContexts({ reverse: true });\r\n\t\t_(contexts).each(context => {\r\n\t\t\tlet callback = (...args) => {\r\n\t\t\t\treturn page.start(...args);\r\n\t\t\t};\r\n\t\t\tthis.addRoute(context.route, context.name, callback);\r\n\t\t});\r\n\t},\r\n\thandleError(process, action){\r\n\t\tlet args, error;\r\n\r\n\t\tif(process instanceof Process) {\r\n\t\t\targs = [].slice.call(process.errors) ;\r\n\t\t\terror = args.shift();\r\n\t\t\targs.push(action);\r\n\t\t} else {\r\n\t\t\terror = process;\r\n\t\t\targs = [action];\r\n\t\t}\r\n\r\n\t\terrorHandler.handle(error, this, args);\r\n\r\n\t\t//BaseRouter.prototype.handleError(error, action);\r\n\t},\t\r\n});\r\n","import isModel from '../../bb/is-model';\r\nimport isView from '../../bb/is-view';\r\nexport default function getModel(arg){\r\n\treturn isModel(arg) ? arg\r\n\t\t: isView(arg) ? arg.model\r\n\t\t\t: undefined;\r\n}","import isView from '../../bb/is-view';\r\nexport default function getModel(arg){\r\n\treturn isView(arg) && arg;\r\n}","\r\nimport getModel from './get-model';\r\nimport getView from './get-view';\r\nexport default function compareAB(a, b, func){\r\n\tif(_.isArray(func)) {\r\n\r\n\t\tlet result = 0;\r\n\r\n\t\t_(func).every((f) => {\r\n\t\t\tresult = compareAB(a,b,f);\r\n\t\t\treturn result === 0;\r\n\t\t});\r\n\t\t\r\n\t\treturn result;\r\n\t} else {\r\n\t\tif (_.isFunction(func)) {\r\n\t\t\ta = func.call(a, getModel(a), getView(a)) ;\r\n\t\t\tb = func.call(b, getModel(b), getView(b));\r\n\t\t}\r\n\t\treturn a < b ? -1\r\n\t\t\t: a > b ? 1\r\n\t\t\t\t: 0;\r\n\t}\r\n}\r\n","import compareAB from '../compare-ab';\r\nexport default function comparator(...args){\r\n\tvar result = 0;\r\n\r\n\t//for simple case (arg1, arg2, compare)\r\n\tif (args.length <= 3 && !_.isArray(args[0])){\r\n\r\n\t\treturn compareAB.apply(null, args);\r\n\r\n\t} \r\n\t//for complex cases ([arg1, arg2, compare], [], .... [])\r\n\t//each arguments should be an array\r\n\telse {\r\n\r\n\t\t_(args).every((single) => {\r\n\r\n\t\t\tif(!_.isArray(single)) return true;\r\n\t\t\tresult = compareAB(...single);\r\n\t\t\treturn result === 0;\r\n\t\t});\r\n\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n","import BaseRouter from './router';\r\nimport comparator from '../../../utils/comparator';\r\n\r\nexport default {\r\n\tinitializeRoutes(){\r\n\t\tif (this.initializeRouter()) {\r\n\t\t\tthis._buildRoutes();\r\n\t\t}\r\n\t},\r\n\tinitializeRouter(){\t\t\r\n\t\tif(this.getOption('shouldCreateRouter') && !this.router)\r\n\t\t\tthis.router = this._createRouter();\r\n\r\n\t\treturn !!this.router;\r\n\t},\r\n\t_createRouter(){\r\n\t\tlet Router = this.getOption('Router') || BaseRouter;\r\n\t\tlet options = _.extend({}, this.getOption('routerOptions'));\r\n\t\treturn new Router(options);\r\n\t},\r\n\t_buildRoutes(){\r\n\t\tthis._buildRoutesContexts();\r\n\t\tthis.router.registerPageRoutes(this);\r\n\t},\r\n\t_buildRoutesContexts(){\r\n\t\tlet routes = this.getOption('routes', {args: [this]});\r\n\t\tif (routes == null) return;\r\n\t\tif(_.isString(routes))\r\n\t\t\troutes = [routes];\r\n\r\n\t\tlet result = [];\r\n\t\tlet config = this.getRoutesConfig();\r\n\t\t_(routes).each((route, index) => {\r\n\t\t\tlet context = this._normalizeRoutesContextRoute(route, index, config);\r\n\t\t\t_.isObject(context) && (result.push(context));\r\n\t\t});\r\n\t\tthis.routesContext = result;\r\n\t\treturn this.routesContext;\r\n\t},\r\n\t_normalizeRoutesContextRoute(arg, index, config = {}){\r\n\t\tif(arguments.length < 2){\r\n\t\t\tconfig = this.getRoutesConfig();\r\n\t\t}\r\n\t\tlet context = {};\r\n\t\tif(arg == null)\r\n\t\t\treturn;\r\n\t\tif (_.isString(arg)) {\r\n\t\t\t_.extend(context, {route: arg, rawRoute: arg });\r\n\t\t} else if(_.isFunction(arg)) {\r\n\t\t\targ = arg.call(this, this, index);\r\n\t\t\treturn this._normalizeRoutesContextRoute(arg, index);\r\n\t\t} else {\r\n\t\t\t_.extend(context, arg);\r\n\t\t}\r\n\t\tlet name = (_.isString(index) && index) || context.name || context.route || _.uniqueId('route');\r\n\t\tcontext.name = name;\r\n\r\n\t\tif(_.isNumber(index) && context.order == null)\r\n\t\t\tcontext.order = index;\r\n\r\n\t\tif (!context.rawRoute)\r\n\t\t\tcontext.rawRoute = context.route;\r\n\t\t\t\t\r\n\t\tif(config.relative && config.parentContext)\r\n\t\t\tcontext.route = config.parentContext.route + '/' + context.route;\r\n\r\n\t\treturn context;\r\n\t},\r\n\tgetRoutesConfig(){\r\n\t\tlet config = _.extend({ \r\n\t\t\trelative: this.getOption('relativeRoutes', {args: [this]}),\r\n\t\t\tparent: this.parent,\r\n\t\t\tparentContext: this.parent && _.isFunction(this.parent.getMainRouteContext) && this.parent.getMainRouteContext()\r\n\t\t}, this.getOption('routesConfig', {args: [this]}));\r\n\t\tconsole.log('-',this.cid, config);\r\n\t\treturn config;\r\n\t},\r\n\tgetRoutesContexts(opts = {}){\r\n\t\tlet { clone, reverse } = opts;\r\n\t\tlet result = this.routesContext || [];\r\n\t\tif (clone || reverse) result = [].slice.call(result);\r\n\t\tif (reverse) result.reverse();\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetMainRouteContext(){\r\n\t\t// let contexts = this.getRoutesContexts();\r\n\t\t// console.log(contexts);\r\n\t\tif(this.mainRouteContext) return this.mainRouteContext;\r\n\t\tthis.mainRouteContext = _(this.getRoutesContexts())\r\n\t\t\t.chain()\r\n\t\t\t.sortBy((a,b) => comparator([ [b,a, c => c.main], [a,b, c => c.order] ]))\r\n\t\t\t.take(1)\r\n\t\t\t.value()[0];\r\n\r\n\t\treturn this.mainRouteContext;\r\n\t}\r\n};\r\n","import MnObject from '../../../mn/object';\r\nimport mix from '../../../utils/mix';\r\nimport GetOptionMixin from '../../../mixins/common/get-option';\r\nimport StartableMixin from '../../../mixins/common/startable';\r\nimport ChildrenableMixin from '../../../mixins/common/childrenable';\r\nimport RoutesMixin from './routes-mixin';\r\n\r\nconst BasePage = mix(MnObject).with(GetOptionMixin, ChildrenableMixin, StartableMixin, RoutesMixin);\r\n\r\nexport default BasePage.extend({\r\n\tconstructor(opts = {}){\r\n\t\tBasePage.apply(this, arguments);\r\n\t\tthis.mergeOptions(opts, 'root, parent, router');\r\n\t\t\r\n\t\t//routes-mixin\r\n\t\tthis.initializeRoutes();\r\n\t\t//ChildrenableMixin\r\n\t\tthis.initializeChildren();\r\n\r\n\t},\r\n\tbuildChildOptions(options){\r\n\t\treturn _.extend({\r\n\t\t\troot: this.root,\r\n\t\t\tparent: this.parent,\r\n\t\t\trouter: this.router,\r\n\t\t}, options);\r\n\t},\r\n});\r\n\r\n","import history from '../../../bb/history';\r\nimport errorHandler from '../route-error-handler';\r\n\r\n// supports passing options to the callback\r\n// by using new version of loadUrl\r\nexport function historyNavigate(fragment, opts){\r\n\t\r\n\tlet options = opts === true ? { trigger: true }\r\n\t\t: _.isObject(opts) ? _.clone(opts)\r\n\t\t\t: {};\r\n\r\n\tlet { trigger } = options;\t\r\n\tdelete options.trigger;\r\n\r\n\thistory.navigate(fragment, options);\r\n\r\n\tif (trigger) {\r\n\t\treturn historyLoadUrl(fragment, opts);\r\n\t}\r\n\r\n}\r\n\r\n// original loadUrl does not pass options to the callback\r\n// and this one does\r\nexport function historyLoadUrl(fragment, opts = {}) {\r\n\r\n\t// If the root doesn't match, no routes can match either.\r\n\tif (!history.matchRoot()) return false;\r\n\tfragment = history.fragment = history.getFragment(fragment);\r\n\tlet executed = executeHandler(fragment, opts);\r\n\tif (!executed) {\r\n\t\terrorHandler.handle('not:found', opts.context, [fragment]);\r\n\t\t//history.trigger('handler:not:found', fragment, opts);\r\n\t}\r\n\treturn executed;\r\n}\r\n\r\n//TODO: think about constraints check\r\nfunction testHandler(handler, fragment){\r\n\treturn handler.route.test(fragment);\r\n}\r\n\r\nexport function findHandler(fragment, customTest){\r\n\tlet test = _.isFunction(customTest) ? customTest : testHandler;\r\n\tfragment = history.getFragment(fragment);\r\n\treturn _.filter(history.handlers || [], handler => test(handler, fragment))[0];\r\n}\r\n\r\nexport function executeHandler(fragment, opts = {}, resultContext = {}) {\r\n\tlet handler = findHandler(fragment, opts.testHandler);\r\n\thandler && (resultContext.value = handler.callback(fragment, opts));\r\n\treturn !!handler;\r\n}\r\n\r\nexport function start(options){\r\n\r\n\tif(history.loadUrl !== historyLoadUrl)\r\n\t\thistory.loadUrl = historyLoadUrl;\r\n\r\n\treturn history.start(options);\r\n}\r\n\r\nexport {\r\n\thistory\r\n};\r\n","import { history, historyNavigate }  from '../history';\r\nimport Events from '../../../bb/events';\r\n\r\n\r\nexport default _.extend({\r\n\twatch(){\r\n\t\tthis.entries = [];\r\n\t\tthis.listenTo(history, 'route', this.onRoute);\r\n\t\tthis.listenTo(history, 'backroute', this.onBackRoute);\r\n\t},\r\n\tisActionContext: cntx => _.isObject(cntx) && _.isString(cntx.fragment),\r\n\thasElements(){\r\n\t\treturn this.entries.length > 0;\r\n\t},\r\n\tonRoute(actionContext){\r\n\r\n\t\tif(!this.isActionContext(actionContext))\r\n\t\t\treturn;\r\n\r\n\t\tif (this.isActionContext(this.lastElement)) {\r\n\t\t\tthis.entries.push(this.lastElement);\r\n\t\t}\r\n\t\tthis.lastElement = actionContext;\r\n\r\n\t},\r\n\tonBackRoute(actionContext){\r\n\t\tif(!this.isActionContext(actionContext) || !this.isActionContext(actionContext.gobackContext))\r\n\t\t\treturn;\r\n\r\n\t\tlet lookFor = actionContext.gobackContext;\r\n\t\tlet index = this.entries.indexOf(lookFor);\r\n\t\tif (index >= 0) {\r\n\t\t\tthis.entries = this.entries.slice(0, index);\r\n\t\t\tthis.lastElement = lookFor;\r\n\t\t}\r\n\r\n\t},\r\n\tgoBack(){\r\n\t\tlet last = this.hasElements() && _(this.entries).last();\r\n\t\thistoryNavigate(last.fragment, { trigger: true, routeType: 'backroute', gobackContext: last });\r\n\t},\r\n}, Events);\r\n","import { historyNavigate, executeHandler } from '../history';\r\n\r\nfunction normalizeOptions(type = 'route', opts = {}){\r\n\tif(_.isObject(type)) {\r\n\t\topts = type;\r\n\t\ttype = 'route';\r\n\t} \r\n\treturn _.extend({ routeType: type, trigger: true }, opts);\r\n}\r\n\r\nexport function execute(url, opts){\r\n\treturn go(url, 'execute', opts);\r\n}\r\nexport function navigate(url, opts){\r\n\treturn go(url, 'route', opts);\r\n}\r\nexport function navigateBack(url, opts){\r\n\treturn go(url, 'backroute', opts);\r\n}\r\n\r\nexport function go(url, type, opts)\r\n{\r\n\tlet options = normalizeOptions(type, opts);\r\n\tswitch(options.routeType){\r\n\tdefault:\r\n\tcase 'route':\r\n\tcase 'backroute':\r\n\t\treturn historyNavigate(url, options);\r\n\tcase 'execute':\r\n\t\treturn executeHandler(url, options);\r\n\t}\r\n\r\n}\r\n","import isModel from '../../bb/is-model';\r\nexport default function traverse(fields, root)\r\n{\r\n\troot = root || '';\r\n\tif (this == null || typeof this != 'object') {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar hash = isModel(this) ? this.attributes : this;\r\n\r\n\tvar props = Object.getOwnPropertyNames(hash);\r\n\r\n\tfor (var x = 0; x < props.length; x++) {\r\n\t\tvar name = props[x];\r\n\t\tvar prop = this[name];\r\n\r\n\t\tif (prop == null || typeof prop != 'object' || (prop instanceof Date || prop instanceof Array)) {\r\n\r\n\t\t\tfields[root + name] = prop;\r\n\t\t}\r\n\t\telse if (typeof prop == 'object') {\r\n\r\n\t\t\ttraverse.call(prop, fields, root + name + '.');\r\n\t\t}\r\n\t}\r\n\t\t\r\n}","import traverse from './traverse';\r\n\r\nexport default function flattenObject(obj) {\r\n\tif (obj == null || !_.isObject(obj)) return;\r\n\tvar res = {};\r\n\ttraverse.call(obj, res);\r\n\treturn res;\r\n}","import getProperty from '../get-by-path/get-property';\r\nimport isModel from '../../bb/is-model';\r\nfunction setProperty(context, name, value) {\r\n\tif (isModel(context)) {\r\n\t\tcontext.set(name, value, { silent: true });\r\n\t}\r\n\telse {\r\n\t\tcontext[name] = value;\r\n\t}\r\n\r\n\treturn getProperty(context, name);\r\n}\r\n\r\nexport default setProperty;\r\n","export default function ensureSetByPathArguments(context, path)\r\n{\r\n\tlet errors = [];\r\n\tif (context == null || !_.isObject(context)) {\r\n\t\terrors.push(new Error('Context is not an object'));\r\n\t}\r\n\tif (!_.isString(path) || path === '') {\r\n\t\terrors.push(new Error('Path is not a string'));\r\n\t}\r\n\tif (errors.length) {\r\n\t\treturn errors;\r\n\t}\r\n}\r\n","import getProperty from '../get-by-path/get-property';\r\nimport setProperty from './set-property';\r\nimport ensureArguments from './ensure-arguments';\r\nimport isModel from '../../bb/is-model';\r\nexport default function setByPathArr(context, propertyName, pathArray, value, options) {\r\n\r\n\tlet argumentsErrors = ensureArguments(context, propertyName);\r\n\tif (argumentsErrors) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet modelContext;\r\n\tif (isModel(context)) {\r\n\t\tmodelContext = {\r\n\t\t\tmodel: context,\r\n\t\t\tproperty: propertyName,\r\n\t\t\tpathChunks: [].slice.call(pathArray)\r\n\t\t};\r\n\t}\r\n\r\n\t//set value if this is a last chunk of path\r\n\tif (!pathArray.length) {\r\n\r\n\t\tmodelContext && options.models.push(modelContext);\r\n\r\n\t\treturn setProperty(context, propertyName, value, options);\r\n\r\n\t} else {\r\n\r\n\t\tvar prop = getProperty(context, propertyName);\r\n\r\n\t\tif (!_.isObject(prop) && !options.force) {\r\n\t\t\treturn;\r\n\t\t} else if (!_.isObject(prop) && options.force) {\r\n\t\t\tprop = setProperty(context, propertyName, {}, options);\r\n\t\t} \r\n\r\n\t\tmodelContext && options.models.push(modelContext);\r\n\r\n\t\tvar nextName = pathArray.shift();\t\r\n\t\treturn setByPathArr(prop, nextName, pathArray, value, options);\r\n\r\n\t}\r\n}\r\n","export default function normalizeSetByPathOptions(opts = {}, ext)\r\n{\r\n\r\n\tlet options = _.extend({}, opts, ext, {\r\n\t\tsilent: opts.silent === true,\r\n\t\tforce: opts.force !== false,\r\n\t\t//passPath: [],\r\n\t\tmodels: []\r\n\t});\r\n\r\n\treturn options;\r\n}\r\n","export default function triggerModelEventsOnSetByPath(value, options = {})\r\n{\r\n\tif (options.silent || !options.models.length) {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\t_(options.models).each(context => {\r\n\t\tlet rest = context.pathChunks.join(':');\r\n\t\tif (rest) {\r\n\t\t\tcontext.model.trigger(`change:${context.property}:${rest}`, context.model, value);\r\n\t\t}\r\n\t\tcontext.model.trigger(`change:${context.property}`, context.model, value);\r\n\t\tcontext.model.trigger('change', context.model);\r\n\t});\r\n\r\n\t// //triggering change event on all met models\r\n\t// let originPath = options.pathArray.join(':');\r\n\t// while (options.models.length) {\r\n\t// \tlet modelContext = options.models.pop();\r\n\t// \tlet propertyEventName = modelContext.path == ''\r\n\t// \t\t? originPath\r\n\t// \t\t: originPath.substring(modelContext.path.length + 1);\r\n\r\n\t// \tif (propertyEventName) {\r\n\t// \t\tmodelContext.model.trigger('change:' + propertyEventName, value);\r\n\t// \t}\r\n\t// \tmodelContext.model.trigger('change', modelContext.model);\r\n\t// }\r\n}\r\n","import setByPathArray from './set-by-path-array';\r\nimport normalizeOptions from './normalize-options';\r\nimport triggerModelChangeEvents from './trigger-model-change-events';\r\nimport ensureArguments from './ensure-arguments';\r\nexport default function setByPath(context, path, value, opts = {}) {\r\n\r\n\tlet argumentsErrors = ensureArguments(context, path);\r\n\tif (argumentsErrors) {\r\n\t\treturn value;\r\n\t}\r\n\r\n\tlet pathArray = path.split('.');\t\r\n\tlet options = normalizeOptions(opts, { path, pathArray: [].slice.call(pathArray) });\r\n\r\n\tlet propertyName = pathArray.shift();\r\n\r\n\tlet result = setByPathArray(context, propertyName, pathArray, value, options);\r\n\r\n\tif (result === undefined && value !== undefined) {\r\n\t\treturn value;\r\n\t}\r\n\r\n\ttriggerModelChangeEvents(value, options);\r\n\r\n\treturn value;\r\n\r\n\t// if (_.isObject(path) && !_.isArray(path)) {\r\n\t// \tvalue = path.value;\r\n\t// \toptions.force = path.force !== false;\r\n\t// \toptions.silent = path.silent === true;\r\n\t// \tpath = path.path;\r\n\t// }\r\n\r\n\t// var prop = pathArray.shift();\r\n\r\n\t// if (isModel(context)) {\r\n\t// \toptions.models.push({\r\n\t// \t\tpath: '',\r\n\t// \t\tproperty: prop,\r\n\t// \t\tmodel: context\r\n\t// \t});\r\n\t// }\r\n\r\n}\r\n\r\n\r\n","import setByPath from '../set-by-path';\r\n\r\nexport default function unFlat(obj) {\r\n\r\n\tif (obj == null || !_.isObject(obj)) return;\r\n\tvar res = {};\r\n\tfor (var e in obj) {\r\n\t\tsetByPath(res, e, obj[e]);\r\n\t}\r\n\treturn res;\r\n}\r\n\r\n"],"names":["MnObject","Mn","Object","Model","Collection","View","Router","isKnownCtor","arg","isFn","_","isFunction","result","knownCtors","some","ctor","prototype","betterResult","obj","key","opts","context","args","checkAlso","force","defaultValue","default","isString","value","apply","isObject","alsoOptions","omit","getOption","options","extend","deep","Mixin","Base","defaultGetArguments","defaults","values","keys","split","each","option","undefined","createMixinFromObject","mixedObj","clone","mixedCtor","constructor","mx","arguments","normalizeArguments","raw","wrap","wrapObjectWithConstructor","merge","mergeObjects","mixins","push","size","unshift","withMethod","Mixed","class","length","reduce","Memo","Ctor","mixed","mix","_ctor","defaultOptions","b","Error","triggerMethodOn","camelCase","text","first","splitter","replace","match","prefix","toUpperCase","toLowerCase","Process","name","process","concurrent","concurrencyCheck","run","isPromisable","Promise","then","asArray","isArray","race","promises","valueToPromise","resolve","reject","_initDefaults","_initCancelation","_mergeOptions","cid","uniqueId","errors","cancelPromise","cancel","previous","getProcessFromContext","promise","updateProcessInContext","_createLifeCyclePromise","_notCanceled","_begin","_beforeStart","_canBeStarted","_waitOtherPromises","triggerComplete","catch","triggerError","error","jsError","getJsError","_cancelationRace","_getHookResultAsPromise","contextMethod","invokeOnContext","all","hookName","procMethod","procHook","cntxHook","triggerOnContext","onComplete","triggerEnd","onError","filter","f","getContextProcessKey","eventName","trigger","event","methodName","method","register","defaultStartableOptions","contextState","keyValue","storeState","ensureState","processingName","processedName","restoreState","shouldThrow","other","status","defaultStartOptions","defaultStopOptions","_initializeStartable","startable","start","stop","_initializeChildrenable","mergeOptions","parent","root","_childrenInitialized","children","_children","_initializeChild","child","Child","invoked","call","buildChildOptions","getNestedResult","schema","nested","getPropertySchema","model","getDisplayConfig","getPropertyDisplayConfig","display","isModel","getProperty","get","gettingByPath","getByPathArray","propertyName","pathArray","prop","nextName","shift","getByPath","path","slice","originalGet","indexOf","transform","alternative","ifEmpty","label","defaultCssConfig","_setupCssClassModifiers","className","_getCssClassString","$el","removeAttr","attr","optsModifiers","propsModifiers","modifiers","concat","_getCssClassModifiers","getCssClassModifiers","classes","map","cls","ready","uniq","join","trim","_cssClassModifiersInitialized","cfg","getCssClassConfig","events","getCssClassEvents","on","refreshCssClass","modelChange","listenTo","_getCssClassConfig","refresh","beforeRender","_getCssClassEvents","defaultSelector","defaultUpdateDom","selector","element","$","addClass","append","buildRegionFunc","view","hash","autoCreateRegion","updateDom","el","regionEl","region","getRegion","testEl","find","definition","pick","addRegion","normalizeNestedViewContextRegion","regionName","replaceElement","show","partial","buildRegion","isView","isViewClass","_nestedViews","initializeNestedViews","_nestedViewsInitialized","showAllNestedViews","nesteds","index","addNestedView","normalizeRegion","contexts","getNestedViewContext","_normalizeNestedContext","_createNestedContext","isRendered","showNestedView","getNestedViewRegion","buildNestedView","template","buildNestedViewOptions","triggerControlEvent","control","getControlName","triggerMethod","proxyControlEventToParent","getTriggerValue","getControlValue","convertValue","validate","_triggerControlEvent","type","previousTriggerName","getPreviousTriggerValueKey","JSON","stringify","_isValueAsPrevious","triggerValue","isValueAsPrevious","tryValidateControl","setPreviousTriggerValue","triggerControlInvalid","getParentControl","triggerChildControlEvent","_getOption","getInputType","inputView","valueType","isNumber","isDate","_valueIsNumber","inputType","setInputAttributes","attributes","restrictionKeys","restrictions","key2","ifNull","isChar","ctrlKey","eventContext","prevent","isEnteredCharValid","keyCode","stopPropagation","preventDefault","triggerControlDone","originalEvent","clipboardData","getData","isValueValid","input","select","newvalue","setControlValue","target","toString","handleInputEvent","setInputEvents","passedEvents","eventsArray","eventHandlers","toNumber","parseFloat","isNaN","trueValues","falseValues","returnValue","isBoolean","valueOrAlternative","nullable","nullValue","alts","alt","convertToBoolean","strict","returnNullAs","returnEmptyAs","returnNullAndEmptyAs","returnAnyAs","returnOtherAs","isTrue","isFalse","convertString","toBoolean","ControlMixin","buildRestrictions","attrs","pickNumbers","pickStrings","pickBools","convert","prepareValueBeforeSet","silent","triggerControlChange","len","getMaxLength","substring","num","min","max","getValueType","maxlength","char","parseInt","required","strValue","pattern","RegExp","test","pstoSetPair","pair","keyvalue","pstoSetKeyValue","decodeURIComponent","paramsToObject","emptyObject","pairs","router","update","routeArgumentsToObject","route","callback","isRouterHoldsActions","rawRoute","isRegExp","_routeToRegExp","callbackWrapper","bind","_processCallback","createActionContext","routeContext","fragment","rawArgs","_extractParameters","queryString","pop","qs","prepareActionQueryString","prepareActionArguments","routeType","queryStringParser","params","res","toPromise","getCallbackFunction","executeResult","exception","processCallback","actionContext","asPromise","triggerEvent","shouldTriggerEvent","execute","handleError","handlers","_getHandleContext","applyHandler","handler","getHandler","items","setHandler","memo","item","getHandleContext","custom","Deferred","BaseRouter","BbRouter","with","GetOptionMixin","routes","getInitRoutes","addRoutes","controller","approutes","_buildRouteContext","registerRouteContext","_storeCreatedContext","isRouteChaining","normalized","chain","_normalizeRoutes","doNotReverse","reverse","registered","addRoute","massAdd","c","has","buildRouteContextFromArguments","buildRouteContext","history","routeContexts","action","handle","paramStringToObject","optionalParam","namedParam","splatParam","escapeRegExp","optional","flags","cntx","page","getRoutesContexts","getModel","compareAB","a","func","every","getView","comparator","single","initializeRouter","_buildRoutes","_createRouter","_buildRoutesContexts","registerPageRoutes","config","getRoutesConfig","_normalizeRoutesContextRoute","routesContext","order","relative","parentContext","getMainRouteContext","log","mainRouteContext","sortBy","main","take","BasePage","ChildrenableMixin","StartableMixin","RoutesMixin","initializeRoutes","initializeChildren","historyNavigate","navigate","historyLoadUrl","matchRoot","getFragment","executed","executeHandler","testHandler","findHandler","customTest","resultContext","loadUrl","entries","onRoute","onBackRoute","isActionContext","lastElement","gobackContext","lookFor","last","hasElements","Events","normalizeOptions","url","go","navigateBack","traverse","fields","babelHelpers.typeof","props","getOwnPropertyNames","x","Date","Array","flattenObject","setProperty","set","ensureSetByPathArguments","setByPathArr","argumentsErrors","ensureArguments","modelContext","models","normalizeSetByPathOptions","ext","triggerModelEventsOnSetByPath","rest","pathChunks","property","setByPath","setByPathArray","unFlat","e"],"mappings":"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"}